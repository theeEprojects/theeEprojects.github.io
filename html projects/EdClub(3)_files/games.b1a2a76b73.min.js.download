/*! For license information please see games.b1a2a76b73.min.js.LICENSE */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{471:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(984);var r=f(a);var s=i(992);var n=f(s);var o=i(994);var l=f(o);var h=i(995);var d=f(h);var c=i(996);var u=f(c);function f(t){return t&&t.__esModule?t:{default:t}}e.default={BalloonValley:r.default,MonsterAttack:n.default,TempleBash:l.default,FloatingBubbles:d.default,AppleThieves:u.default}},955:function(t,e,i){var a=i(210);var r=v(a);var s=i(1);var n=v(s);var o=i(8);var l=v(o);var h=i(77);var d=v(h);var c=i(27);var u=v(c);var f=i(12);var m=v(f);var p=i(300);var g=v(p);var S=i(21);var y=v(S);function v(t){return t&&t.__esModule?t:{default:t}}var b=null;function P(t){return function(e,i){b=(0,u.default)(i.language);return n.default.createElement(d.default,{key:"game"+y.default.current_app_index,header:false,scroll:false,onMount:function a(){return t(e,i)}},n.default.createElement("div",{id:"game"}),n.default.createElement("div",{id:"vkeyboard-overlay"}),n.default.createElement(r.default,{name:"",profile:i,display:"game"}))}}function x(t,e){return Math.floor(Math.random()*(e-t+1))+t}function _(t){return t[Math.floor(Math.random()*t.length)]}function T(){return{width:(0,l.default)(window).width(),height:(0,l.default)(window).height()}}function C(){if(typeof window.IMAGE_CROSS_ORIGIN!="undefined"){return window.IMAGE_CROSS_ORIGIN}return"anonymous"}function w(){if(typeof window.IMAGE_CROSS_ORIGIN!="undefined"){return STATIC_URL}return"/m/"}var E={ASSETS:{CDN_SHARED:STATIC_URL+"exp/shared/"},overlay:null,gameState:null,_initialized:false,init:function t(e){this.gameState=e;this._initialized=true},_checkInitialized:function t(){if(!this._initialized){throw new Error("GameUtil not initialized. Please call GameUtil.init(gameState) first,")}else{return true}},mountVirtualKeyboard:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"bottom";var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var a=document.getElementById("vkeyboard-overlay");a.classList.add("kb-"+e);if(i)a.classList.add("kb-"+e+"-responsive");this.keyboard_plugin=new g.default.KeyboardPlugin(this.core,a,profile.keyboard,profile.show_keyboard,profile.show_hand,profile.keyboard_layout,profile.use_hand,false)},unmountVirtualKeyboard:function t(){var e=document.getElementById("vkeyboard-overlay");if(e)e.innerHTML=""},loadSharedAssets:function t(){this.load.image("dragon-stamp",E.ASSETS.CDN_SHARED+"img/dragon-stamp.png");this.load.image("game-win-pose",E.ASSETS.CDN_SHARED+"img/game-win-pose.png");this.load.image("game-lose-pose",E.ASSETS.CDN_SHARED+"img/game-lose-pose.png");this.load.image("give-up-button",E.ASSETS.CDN_SHARED+"img/give-up-button.png");this.load.image("overlay",E.ASSETS.CDN_SHARED+"img/overlay.png");this.load.image("speed-icon",E.ASSETS.CDN_SHARED+"img/speed_icon.png")},createGameWinningScreen:function t(){E._checkInitialized();var e=this.add.sprite(this.game.width/2,this.game.height/2,"dragon-stamp");e.anchor.setTo(.5);e.scale.setTo(.8);e.fixedToCamera=true;this.add.tween(e.scale).to({x:[1.2],y:[1.2]},2500,Phaser.Easing.Sinusoidal.Out,true,0,0);var i=this.add.sprite(this.game.width/2,this.game.height/2,"game-win-pose");i.anchor.setTo(.5);i.scale.setTo(.8);i.alpha=0;i.fixedToCamera=true;this.add.tween(i).to({alpha:[.8,1]},1e3,Phaser.Easing.Linear.None,true,0,0);this.add.tween(i.scale).to({x:[1.3],y:[1.3]},3e3,Phaser.Easing.Sinusoidal.Out,true,0,0).onComplete.add(function(){this.submitScores.call(this,true)}.bind(this),this)},createGameLosingScreen:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;E._checkInitialized();var i=this.add.sprite(this.game.width/2,this.game.height/2,"dragon-stamp");i.anchor.setTo(.5);i.scale.setTo(.8);i.fixedToCamera=true;this.add.tween(i.scale).to({x:[1.2],y:[1.2]},2500,Phaser.Easing.Sinusoidal.Out,true,0,0);var a=this.add.sprite(this.game.width/2,this.game.height/2,"game-lose-pose");a.anchor.setTo(.5);a.alpha=0;a.fixedToCamera=true;this.add.tween(a).to({alpha:[.8,1]},1e3,Phaser.Easing.Linear.None,true,0,0);this.add.tween(a.scale).to({x:[1.3],y:[1.3]},3e3,Phaser.Easing.Sinusoidal.Out,true,0,0);if(e){this.submitScores(false)}this.gameOverText=this.add.text(this.game.width/2,this.game.height/2-220,b.t("Hit SPACE to try again"),{fontSize:"30px",fill:"#fff",stroke:"rgba(103, 189, 221, 0.7)",strokeThickness:5,align:"center"});this.gameOverText.anchor.setTo(.5,.5);this.gameOverText.scale.setTo(0,0);this.add.tween(this.gameOverText.scale).to({x:[1.3,1,1.2,1],y:[1.3,1.2,1,1]},500,Phaser.Easing.Quadratic.InOut,true,0,0);this.gameOverText.fixedToCamera=true},createGiveUpButton:function t(e){E._checkInitialized();var i=this.add.text(0,0,b.t("Give Up"),{fontSize:"25px",fill:"#fff",align:"center"});i.anchor.setTo(.5);try{var a=this.add.sprite(this.game.width/2,this.game.height/2+240,"give-up-button");a.addChild(i);a.inputEnabled=true;a.input.useHandCursor=true;a.events.onInputDown.add(function(){E._gotoLastAttemptResultPage(e)},this);a.anchor.setTo(.5,.5);a.scale.setTo(0,0);this.add.tween(a.scale).to({x:[1.3,1,1.2,1],y:[1.3,1.2,1,1]},500,Phaser.Easing.Quadratic.InOut,true,0,0);a.fixedToCamera=true}catch(t){}},createStartingText:function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var a=this.game.width/2;var r=this.game.height/2;if(i){var s=this.overlay=this.add.sprite(a,r,"overlay");s.anchor.setTo(.5);s.scale.setTo(30);s.alpha=.2}var n=this.startingText=this.game.add.text(this.game.width/2,this.game.height/2,e,{fontSize:"40px",fill:"#fff",stroke:"rgba(103, 189, 221, 0.7)",strokeThickness:10,align:"center"});n.setShadow(1,1,"rgba(0, 0, 0, 0.2)",2,true,false);n.anchor.setTo(.5,.5);this.add.tween(n).to({alpha:[1,1,1,1,1,1,.3,1]},3e3,Phaser.Easing.Quadratic.In,true,0,false)},hideStartingText:function t(){if(!this.startingText){return}var e=this.startingText;if(this.overlay){this.overlay.alpha=0}this.add.tween(e.scale).to({x:[1,1.2,.5],y:[1,1.2,.5]},300,Phaser.Easing.Linear.None,true,0);this.add.tween(e).to({alpha:[1,0]},300,Phaser.Easing.Linear.None,true,0).onComplete.add(function(){e.destroy()})},createWPMCountObj:function t(e,i){var a=e?e:this.game.width-120;var r=i?i:this.game.height-70;if(m.default.isIOS){r-=50}var s=this.wpmCountObj=this.add.sprite(a,r,"speed-icon");s.anchor.setTo(.5,.5);s.scale.setTo(.7);s.fixedToCamera=true;var n=this.wpmText=this.add.text(50,-20,"0",{font:"40px Helvetica Neue",fontWeight:100,fill:"#fff",stroke:"#70bbcd",align:"center"});n.anchor.setTo(0,0);n.scale.x=1;n.scale.y=1;s.addChild(n)},_gotoLastAttemptResultPage:function t(e){if(e.url){y.default.goto_url(e.url)}else{y.default.exit_lesson()}}};var O=function t(){};O.prototype={init:function t(e,i){this.env=e;this._GAME_=i},preload:function t(){this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,b.t("Loading Game - Please Wait"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){this.updateLoader()}.bind(this));var e=true;var i=false;var a=undefined;try{for(var r=this._GAME_.failedPreloads[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;this.reloadAsset(n)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}},create:function t(){this.state.start("Game.MainState",true,false,this.env)},updateLoader:function t(){this.loadingText.text=b.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},reloadAsset:function t(e){if(!e.file.url)return;var i=e.file.url.replace(this._GAME_.ASSETS.CDN_CUSTOM,this._GAME_.ASSETS.NON_CDN_CUSTOM);switch(e.file.type){case"image":this.load.image(e.key,i);break;case"spritesheet":this.load.spritesheet(e.key,i,e.file.frameWidth,e.file.frameHeight,e.file.frameMax);break;case"textureatlas":this.load.atlasJSONHash(e.key,i,e.file.atlasURL);break;case"audio":this.load.audio(e.key,i);break;default:break}}};t.exports={wrapGameWithHeader:P,getRandomInt:x,getRandomOfList:_,getWindowDimensions:T,GameUtil:E,FallBackPreloadState:O,getCrossOrigin:C,getStaticUrl:w}},956:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});i(985);i(987);var a=i(989);var r=o(a);var s=i(991);var n=o(s);function o(t){return t&&t.__esModule?t:{default:t}}e.default=r.default},959:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});e.default=undefined;var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(t,a.key,a)}}return function(e,i,a){if(i)t(e.prototype,i);if(a)t(e,a);return e}}();var r=i(951);var s=g(r);var n=i(147);var o=g(n);var l=i(952);var h=g(l);var d=i(462);var c=g(d);var u=i(463);var f=g(u);var m=i(54);var p=g(m);function g(t){return t&&t.__esModule?t:{default:t}}function S(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}var y=function(){function t(e){S(this,t);this.words_pool=[];this.visible_words=[];this.active_words=[];this.completed_words=[];this.word_index=-1;this.loop_count=0;this.events=new p.default(["change","word_complete"]);this.keydown_buffer=[];this.core=e;this.words_pool=(0,s.default)(e.words);e.real_record_keydown_time=e.record_keydown_time;e.record_keydown_time=this.record_keydown_time.bind(this)}a(t,[{key:"record_keydown_time",value:function t(e,i){if(i==undefined){i=0;var a=new Date;if(this.core.last_keydown){i=a-this.core.last_keydown-this.core.last_pause_duration}this.core.last_keydown=a}if(e=="<-"){return}this.keydown_buffer.push([e,i]);var r=this.update_active_words();this.core.events.fire_event("keydown",{deadkey:this.core.dead_key_active,is_valid:r,chr:e,delay:i})}},{key:"update_active_words",value:function t(){var e=[];var i=true;var a=this.keydown_buffer.map(function(t){return t[0]}).join("");var r=this.active_words.length?this.active_words:this.visible_words;var s=true;var n=false;var o=undefined;try{for(var l=r[Symbol.iterator](),d;!(s=(d=l.next()).done);s=true){var u=d.value;var f=u.map(function(t){return t.chr}).join("");if(f==a){this.deactivate_word(u);this.flush_buffer_on_word(u,false);return i}else if((0,h.default)(f,a)){e.push(u)}}}catch(t){n=true;o=t}finally{try{if(!s&&l.return){l.return()}}finally{if(n){throw o}}}if(e.length==0&&this.keydown_buffer.length){this.keydown_buffer.pop();i=false;return i}var m=(0,c.default)(this.active_words,e);var p=true;var g=false;var S=undefined;try{for(var y=m[Symbol.iterator](),v;!(p=(v=y.next()).done);p=true){var b=v.value;this.deactivate_word(b)}}catch(t){g=true;S=t}finally{try{if(!p&&y.return){y.return()}}finally{if(g){throw S}}}var P=this.keydown_buffer.length;var x=true;var _=false;var T=undefined;try{for(var C=e[Symbol.iterator](),w;!(x=(w=C.next()).done);x=true){var b=w.value;for(var E=0;E<b.length;E++){b[E].temp_valid=E<P}}}catch(t){_=true;T=t}finally{try{if(!x&&C.return){C.return()}}finally{if(_){throw T}}}this.events.fire_event("change",{rejected_words:m,matches:e,focus:e.length?e[0]:null});this.active_words=e;return i}},{key:"deactivate_word",value:function t(e){var i=true;var a=false;var r=undefined;try{for(var s=e[Symbol.iterator](),n;!(i=(n=s.next()).done);i=true){var l=n.value;l.temp_valid=false}}catch(t){a=true;r=t}finally{try{if(!i&&s.return){s.return()}}finally{if(a){throw r}}}(0,o.default)(this.active_words,function(t){return t===e})}},{key:"flush_buffer_on_word",value:function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;this.core.jump_focus(e[0]);var a=true;var r=false;var s=undefined;try{for(var n=this.keydown_buffer[Symbol.iterator](),o;!(a=(o=n.next()).done);a=true){var l=o.value;this.core.real_record_keydown_time(l[0],l[1],false,false)}}catch(t){r=true;s=t}finally{try{if(!a&&n.return){n.return()}}finally{if(r){throw s}}}if(i){for(var h=0;h<this.keydown_buffer.length;h++){this.core.real_record_keydown_time("<-",0,false,false)}}else{this.word_completed(e)}this.keydown_buffer=[];if(this.active_words.length){var d=this.active_words.slice();var c=true;var u=false;var f=undefined;try{for(var m=d[Symbol.iterator](),p;!(c=(p=m.next()).done);c=true){var e=p.value;this.deactivate_word(e)}}catch(t){u=true;f=t}finally{try{if(!c&&m.return){m.return()}}finally{if(u){throw f}}}this.events.fire_event("change",{rejected_words:d,matches:this.active_words,focus:null})}}},{key:"word_completed",value:function t(e){(0,o.default)(this.visible_words,function(t){return t===e});this.completed_words.push(e);this.events.fire_event("word_complete",{word:e});if(this.visible_words.length==0&&this.words_pool.length==0)this.core.end_lesson()}},{key:"get_next_word",value:function t(){this.word_index++;if(this.word_index>=this.words_pool.length){this.word_index=0;this.loop_count++}return this.words_pool[this.word_index]}},{key:"is_word_already_visible",value:function t(e){var i=e.map(function(t){return t[0]}).join("");var a=true;var r=false;var s=undefined;try{for(var n=this.visible_words[Symbol.iterator](),o;!(a=(o=n.next()).done);a=true){var l=o.value;var d=e.map(function(t){return t[0]}).join("");if((0,h.default)(d,i))return true}}catch(t){r=true;s=t}finally{try{if(!a&&n.return){n.return()}}finally{if(r){throw s}}}return false}},{key:"activate_and_pull_word",value:function t(){var e=null;do{e=this.get_next_word()}while(e&&this.is_word_already_visible(e)&&this.loop_count<2);this.loop_count=0;if(!e){return}(0,o.default)(this.words_pool,function(t){return t===e});this.visible_words.push(e);return e}},{key:"word_no_longer_visible",value:function t(e){if((0,f.default)(this.active_words,e)>-1){this.deactivate_word(e)}if(this.active_words.length==0&&this.keydown_buffer.length){this.flush_buffer_on_word(e,true)}(0,o.default)(this.visible_words,function(t){return t===e});this.words_pool.push(e)}}]);return t}();e.default=y},984:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(299);var r=C(a);var s=i(955);var n=C(s);var o=i(300);var l=C(o);var h=i(956);var d=C(h);var c=i(8);var u=C(c);var f=i(31);var m=C(f);var p=i(465);var g=C(p);var S=i(65);var y=C(S);var v=i(12);var b=C(v);var P=i(27);var x=C(P);var _=i(21);var T=C(_);function C(t){return t&&t.__esModule?t:{default:t}}var w=null;var E={STANDARD_DIMENSIONS:{x:1024,y:768},DEV_MODE:false,DEMO_MODE:false,FULL_SCREEN:true,ASSETS:{CDN_CUSTOM:STATIC_URL+"exp/balloon_valley/",NON_CDN_CUSTOM:n.default.getStaticUrl()+"exp/balloon_valley/"},BG_EXTEND:10,PLAY_SFX:true,RANDOMIZE_AMOUNT:120,RANDOMIZE_BALLOONS:true,GIVEN_LIVES:3,INVALID_ALLOWED:3,BALLOONS_TO_PRECREATE:12,SHOW_BALLOON_CURSOR:true,failedPreloads:[]};E.BootState=function(){};E.BootState.prototype={init:function t(e){w=(0,x.default)(profile.language);this.env=e;this.scale.scaleMode=d.default.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;E.DEMO_MODE=this.env.demo||false},preload:function t(){this.load.crossOrigin=n.default.getCrossOrigin();this.load.image("preloadBar",n.default.GameUtil.ASSETS.CDN_SHARED+"img/progress.png")},create:function t(){this.game.stage.backgroundColor="#2f86bc";this.state.start("Game.PreloadState",true,false,this.env)}};E.PreloadState=function(){};E.PreloadState.prototype={init:function t(e){n.default.GameUtil.init(this);this.env=e;this.load.crossOrigin=n.default.getCrossOrigin()},updateLoader:function t(){this.loadingText.text=w.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},preload:function t(){this.preloadBar=this.add.sprite(this.game.world.centerX-this.cache.getImage("preloadBar").width/2,this.game.world.centerY,"preloadBar");this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,w.t("Loading Game (0 %)"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){this.updateLoader()}.bind(this));this.load.onFileError.add(function(t,e){E.failedPreloads.push({key:t,file:e})}.bind(this));this.load.setPreloadSprite(this.preloadBar);n.default.GameUtil.loadSharedAssets.call(this);this.load.image("bg",E.ASSETS.CDN_CUSTOM+"img/sky-gradient.png");this.load.image("cloud-small",E.ASSETS.CDN_CUSTOM+"img/cloud_small.png");this.load.image("cloud-big",E.ASSETS.CDN_CUSTOM+"img/cloud_big.png");this.load.image("cliff-left",E.ASSETS.CDN_CUSTOM+"img/cliff_left.png");this.load.image("cliff-right",E.ASSETS.CDN_CUSTOM+"img/cliff_right.png");this.load.image("valley",E.ASSETS.CDN_CUSTOM+"img/valley.png");this.load.image("bg-mountain",E.ASSETS.CDN_CUSTOM+"img/bg_mountain.png");this.load.atlas("balloon-fragments",E.ASSETS.CDN_CUSTOM+"img/balloon-fragments.png",E.ASSETS.NON_CDN_CUSTOM+"img/balloon-fragments.json");this.load.atlas("colors",E.ASSETS.CDN_CUSTOM+"img/colorsSD.png",E.ASSETS.NON_CDN_CUSTOM+"img/colorsSD.json");this.load.atlasJSONHash("ninja",E.ASSETS.CDN_CUSTOM+"img/ninja.png",E.ASSETS.NON_CDN_CUSTOM+"img/ninja.json");this.load.spritesheet("ninja-life",E.ASSETS.CDN_CUSTOM+"img/ninja-life-small.png",38,41,1);this.load.spritesheet("balloon-yellow",E.ASSETS.CDN_CUSTOM+"img/simple_balloon_yellow.png",103,174,1);this.load.spritesheet("balloon-red",E.ASSETS.CDN_CUSTOM+"img/simple_balloon_red.png",103,174,1);this.load.spritesheet("balloon-purple",E.ASSETS.CDN_CUSTOM+"img/simple_balloon_purple.png",103,174,1);this.load.spritesheet("balloon-blue",E.ASSETS.CDN_CUSTOM+"img/simple_balloon_blue.png",103,174,1);this.load.spritesheet("caps-arrow",E.ASSETS.CDN_CUSTOM+"img/caps-arrow.png",18,20,1);this.load.spritesheet("balloon-count",E.ASSETS.CDN_CUSTOM+"img/balloon-count-icon.png",40,62,1);this.load.spritesheet("balloon-glow",E.ASSETS.CDN_CUSTOM+"img/balloon_glow.png",149,149,1);this.load.spritesheet("balloon-ray",E.ASSETS.CDN_CUSTOM+"img/balloon_ray.png",149,149,1);this.load.spritesheet("balloon-cursor",E.ASSETS.CDN_CUSTOM+"img/balloon-cursor.png",316,21,1);this.load.spritesheet("cloud-poof",E.ASSETS.CDN_CUSTOM+"img/cloud-poof.png",243,152,9);if(E.PLAY_SFX&&profile.keyboard_sfx){this.load.audio("impact2",E.ASSETS.CDN_CUSTOM+"audio/impact-02.mp3")}},create:function t(){if(!(0,m.default)(E.failedPreloads)){this.state.start("Game.FallBackPreloadState",true,false,this.env,E)}else{this.state.start("Game.MainState",true,false,this.env)}}};E.FallBackPreloadState=s.FallBackPreloadState;E.MainState=function(){this.manager=null;this.emitter=null;this.player=null;this.cloudPoof=null;this.cloudSmall=null;this.cloudBig=null;this.bg=null;this.bgMountain=null;this.cliffLeft=null;this.cliffRight=null;this.valley=null;this.currentBalloonCreationIndex=0;this.gameState={started:false,lost:false,paused:false,readyForKey:false};this.fadeObjectCache=[];this.killObjectCache=[];this.invalidCount=0;this.gamePace=null;this.realGamePace=null;this.gameWidth=null;this.dropSpeed=null;this.cloudSpeed=.1;this.activeBalloon=0;this.balloonSpacing=200;this.balloonStartPosition={x:300,y:100};this.playerBalloonOffset={x:0,y:78};this.balloonGlowOffset={x:0,y:-35};this.lifeIcons=[];this.balloonsRemaining=0;this.balloonCountText=null;this.balloonFlashingTween=null;this.cameraPos=new d.default.Point(0,0);this.cameraMoveSmoothness=.07;this.cameraCenterXOffset=250;this.balloons=[];this.balloonGlow={glow:null,ray:null};this.balloonCursor=null;this.previousBalloonStyle=null;this.balloonCountObj=null;this.doublejumps=0;this.capturedBalloonState={positionX:null,positionY:null};this.audioJSON={spritemap:{jump:{start:0,end:.14,loop:false},splat:{start:.15,end:.45,loop:false}}};this.soundEffects={};this.showVirtualKeyboard=false;if(E.DEV_MODE){window.game=this}};E.MainState.prototype={init:function t(e){n.default.GameUtil.init(this);this.env=e;this.typingText=this.env.typing.text.replace(/\s/g,"");this.showVirtualKeyboard=e.typing.allow_vkeyboard;var i=this.core=new r.default({lesson_id:e.id,text:this.typingText,on_error:"block",max_secs:e.typing.max_secs,deletable:false,i18n:w});if(E.PLAY_SFX){this.soundfx=new l.default.SoundFX(this.core,T.default.root,!profile.keyboard_sfx)}if(this.showVirtualKeyboard){n.default.GameUtil.mountVirtualKeyboard.call(this,"bottom",true)}i.events.on("end",function(t){t.game_lost=this.gameState.lost;this.end_stats=t}.bind(this));i.events.on("abort",function(){this.gameState.lost=true;this.lifeIcons=[];this.showGameOver(false);this.player.kill()}.bind(this));i.events.on("stats_update",function(t){if(t.wpm>250){return}}.bind(this));this.core.attach_capture();T.default.events.on("unload",function(){this.core.detach_capture()}.bind(this));this.balloonsRemaining=this.typingText.length;this.updateBalloonCount();this.gameWidth=(this.typingText.length+1)*this.balloonSpacing+this.balloonStartPosition.x;this.gamePace=e.typing.goal_wpm;this.realGamePace=this.gamePace*this.game.height/600;this.dropSpeed=.3*this.realGamePace},preload:function t(){},create:function t(){if(E.DEV_MODE){this.time.advancedTiming=true}this.manager=this.game.plugins.add(d.default.ParticleStorm);this.world.setBounds(0,0,this.gameWidth,this.game.height);this.bg=this.add.tileSprite(-E.BG_EXTEND,-E.BG_EXTEND,this.game.width+E.BG_EXTEND,this.game.height+E.BG_EXTEND,"bg");this.bg.scale.setTo(1,Math.ceil(this.game.height/this.cache.getImage("bg").height));this.bg.fixedToCamera=true;var e=this.cache.getImage("bg-mountain").height;this.bgMountain=this.add.tileSprite(0,this.game.height-e-this.game.height/6,this.gameWidth,e,"bg-mountain");this.cloudSmall=this.add.tileSprite(0,0,this.gameWidth,this.cache.getImage("cloud-small").height,"cloud-small");this.cloudSmall.tileScale.x=1;this.cloudSmall.tileScale.y=1;this.cloudSmall.alpha=.2;this.cloudBig=this.add.tileSprite(0,0,this.gameWidth,this.cache.getImage("cloud-big").height,"cloud-big");this.cloudBig.tileScale.x=1;this.cloudBig.tileScale.y=1;this.cloudBig.alpha=.4;var i=this.cache.getImage("cliff-left").height;this.cliffLeft=this.add.sprite(0,this.game.height-i,"cliff-left");var a=this.cache.getImage("cliff-right").height;var r=this.cache.getImage("cliff-right").width;this.cliffRight=this.add.sprite(this.gameWidth-r,this.game.height-a,"cliff-right");var s=this.cache.getImage("valley").height;this.valley=this.add.tileSprite(0,this.game.height-s,this.gameWidth,s,"valley");for(var o=0;o<Math.min(E.BALLOONS_TO_PRECREATE,this.typingText.length);o++){this.createBalloon(o+1,this.typingText[o])}this.currentBalloonCreationIndex=E.BALLOONS_TO_PRECREATE;this.createBalloonGlow(this.balloons[1]);if(E.SHOW_BALLOON_CURSOR){this.createBalloonCursor(this.balloons[1])}var l={x:60,y:this.game.height-this.cache.getImage("cliff-left").height};var h=this.add.sprite(l.x,l.y,"ninja");h._state={isOnStartPlatform:true,isOnEndPlatform:false,isJumping:false,isHanging:false};h.checkWorldBounds=true;h.events.onOutOfBounds.add(this.playerOut,this);this.player=h;h.scale.x=1;h.scale.y=1;h.anchor.setTo(.5,.1);this.cameraPos.setTo(h.x,h.y);var c=this.player.animations.add("jump",d.default.Animation.generateFrameNames("jump/",1,4,".png",2),30,true);var u=this.player.animations.add("jump-off",d.default.Animation.generateFrameNames("jump/",1,4,".png",2),30,true);var f=this.player.animations.add("stand",d.default.Animation.generateFrameNames("stand/",1,10,".png",2),30,true);var m=this.player.animations.add("falling",d.default.Animation.generateFrameNames("falling/",1,4,".png",2),30,true);c.onComplete.add(function(t,e){this.captureState();t.animations.stop();t.animations.play("falling",10,true)},this);u.onComplete.add(function(t,e){this.player._state.isJumping=false;this.player._state.isOnEndPlatform=true;this.destroyBalloon(this.activeBalloon);this.showYouWin()},this);this.core.events.on("keydown",function(t){if(t.deadkey)return;if(this.player._state.isOnEndPlatform||this.gameState.lost||!this.gameState.readyForKey){return}if(t.is_valid){if(!this.gameState.started){this.gameState.started=true}this.invalidCount=0;if(this.typingText.length>this.currentBalloonCreationIndex){this.createBalloon(this.currentBalloonCreationIndex+1,this.typingText[this.currentBalloonCreationIndex]);this.currentBalloonCreationIndex++}if(this.gamePausedText){this.gamePausedText.destroy()}this.player._state.isHanging=false;this.updateBalloonCount();this.jump()}else{if(this.gameState.started&&++this.invalidCount==E.INVALID_ALLOWED){this.burstBalloon();this.playerOut(false)}this.wrong()}}.bind(this));n.default.GameUtil.createStartingText.call(this,w.t("Type letter to begin"));this.player.animations.play("stand",10);this.focusNextBalloon();this.createLifeIcons();this.createBalloonCount();this.createLifeIconEffect();this.createBalloonPopEffect();this.gameState.readyForKey=true;if(E.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects.impact2=this.game.add.audio("impact2")}},update:function t(){var e=this.player;this.cloudBig.tilePosition.x-=this.cloudSpeed;this.balloonGlow.ray.angle-=.5;if(this.gameState.lost){var i=this.getActiveBalloon()}if(!e._state.isOnStartPlatform&&!e._state.isOnEndPlatform){if(!e._state.isJumping&&!e._state.isOnEndPlatform&&!e._state.isHanging&&this.gameState.readyForKey){e.position.y+=this.dropSpeed}if(!e._state.isJumping&&!e._state.isHanging&&this.gameState.readyForKey){var a=this.getActiveBalloon();a.position.y+=this.dropSpeed;if(this.game.height-e.position.y<this.game.height/4){this.flashBalloon(a)}}this.moveCamera();this.bgMountain.x=this.camera.x*.5;this.valley.x=this.camera.x*.2;this.cloudSmall.x=this.camera.x*.5;this.cloudBig.x=this.camera.x*.3}},shutdown:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}},render:function t(){if(E.DEV_MODE&&!this.gameState.lost){this.game.debug.text("FPS: "+this.time.fps,50,50,"#00ff00")}},restartGame:function t(){T.default.refresh()},playSound:function t(e){if(E.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects[e].play()}},createLifeIcons:function t(){var e=this.game.height-80;if(b.default.isIOS){e-=50}for(var i=0;i<E.GIVEN_LIVES;i++){var a=this.add.sprite(this.game.width-(i+1)*45-15,e,"ninja-life");a.scale.setTo(1,1);a.angle=20;a.fixedToCamera=true;this.lifeIcons.push(a);this.killObjectCache.push(a)}},createLifeIconEffect:function t(){var e={lifespan:500,image:"colors",blendMode:"ADD",frame:["blue","green","red","white","yellow"],scale:{min:.2,max:.3},vx:{min:-2,max:2},vy:{min:-2,max:2},alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("basic",e);this.emitter=this.manager.createEmitter(d.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},captureState:function t(){var e=this.balloons[this.activeBalloon];this.capturedBalloonState.positionX=e.position.x;this.capturedBalloonState.positionY=e.position.y},restoreState:function t(){this.core.attach_capture();var e=this.capturedBalloonState;var i=this.balloons[this.activeBalloon];if(!i){i=this.createBalloon(this.activeBalloon)}i.position.x=e.positionX;i.position.y=e.positionY;i.alpha=1;(0,g.default)(i.children,function(t){t.kill()});var a=this.player;a.alpha=1;a.position.x=e.positionX+this.playerBalloonOffset.x;a.position.y=e.positionY+this.playerBalloonOffset.y;a.animations.stop("falling");a.frame=4;this.gameState.readyForKey=true},updateBalloonCount:function t(){if(this.balloonCountText){this.balloonCountText.setText(--this.balloonsRemaining)}},playerOut:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(!e){this.player.alpha=0}this.core.pause();this.core.detach_capture();if(!this.gameState.readyForKey){return}this.gameState.readyForKey=false;this.camera.shake(.005,250,true,d.default.Camera.SHAKE_BOTH,true);var i=this.lifeIcons.pop();if(i){i.tint=0;i.alpha=.3;this.killObjectCache.push(i);this.emitter.emit("basic",i.position.x+10,i.position.y+25,{total:20})}if(this.lifeIcons.length==0){this.gameState.lost=true;this.core.end_lesson();this.showGameOver(true)}else{this.showOneLifeLost(e)}},showOneLifeLost:function t(e){if(e){this.cloudPoof=this.add.sprite(this.player.x-120,this.game.height*.87,"cloud-poof");this.cloudPoof.animations.add("poof");this.cloudPoof.animations.play("poof",30,false,true)}var i=this.balloons[this.activeBalloon];if(i){i.alpha=0}this.gamePausedText=this.game.add.text(this.game.width/2,this.game.height/2,w.t("Keep typing"),{fontSize:"45px",fill:"#ddd",stroke:"#52a4c5",strokeThickness:10,align:"center"});this.game.tweens.remove(this.balloonFlashingTween);this.gamePausedText.anchor.setTo(.5,.5);this.add.tween(this.gamePausedText).to({alpha:[1,1,1,1,.3,1]},1500,d.default.Easing.Quadratic.In,true,0,false);this.gamePausedText.fixedToCamera=true;this.player._state.isHanging=true;this.game.time.events.add(500,this.restoreState,this)},showGameOver:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.spacebar=this.game.input.keyboard.addKey(d.default.Keyboard.SPACEBAR);this.spacebar.onDown.add(function(){this.restartGame()},this);n.default.GameUtil.createGameLosingScreen.call(this,e);this.add.tween(this.bg).to({alpha:.8},500,d.default.Easing.Linear.None,true);this.add.tween(this.bgMountain).to({alpha:.5},500,d.default.Easing.Linear.None,true);this.add.tween(this.valley).to({alpha:.2},500,d.default.Easing.Linear.None,true);this.add.tween(this.cloudBig).to({alpha:.2},500,d.default.Easing.Linear.None,true);this.add.tween(this.cloudSmall).to({alpha:.2},500,d.default.Easing.Linear.None,true);this.balloonCountObj.kill();this.destroyBalloonEffects();this.balloonCursor.kill();this.game.tweens.remove(this.balloonFlashingTween);this.runPreEndingScreenTasks()},runPreEndingScreenTasks:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}var e=true;var i=false;var a=undefined;try{for(var r=this.fadeObjectCache[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var o=s.value;this.add.tween(o).to({alpha:.5},500,d.default.Easing.Linear.None,true,0,0)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}var l=true;var h=false;var c=undefined;try{for(var u=this.killObjectCache[Symbol.iterator](),f;!(l=(f=u.next()).done);l=true){var m=f.value;m.destroy()}}catch(t){h=true;c=t}finally{try{if(!l&&u.return){u.return()}}finally{if(h){throw c}}}},showYouWin:function t(){n.default.GameUtil.createGameWinningScreen.call(this);this.add.tween(this.player).to({alpha:0},500,d.default.Easing.Linear.None,true,0,0);this.balloonCountObj.kill();this.runPreEndingScreenTasks()},submitScores:function t(e){if(E.DEMO_MODE){return}api.postTypingResults(this.end_stats,function(t){if(e){T.default.goto_url(t)}else{n.default.GameUtil.createGiveUpButton.call(this,t)}}.bind(this))},pickBalloonStyle:function t(){var e=["balloon-yellow","balloon-blue","balloon-purple","balloon-red"];var i=e[Math.floor(Math.random()*e.length)];if(i==this.previousBalloonStyle){return this.pickBalloonStyle()}else{this.previousBalloonStyle=i;return i}},burstBalloon:function t(){this.playSound("impact2");var e=this.getActiveBalloon();if(e){this.runBalloonPopEffect(e)}},createBalloonPopEffect:function t(){var e={lifespan:400,image:"balloon-fragments",blendMode:"NORMAL",frame:["piece01","piece02","piece03","piece04","piece05"],scale:{min:.1,max:.3},vx:{min:-15,max:15},vy:{min:-5,max:15},gravity:250,alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("balloon-pop",e);this.emitter2=this.manager.createEmitter(d.default.ParticleStorm.SPRITE_BATCH);this.emitter2.addToWorld()},runBalloonPopEffect:function t(e){this.emitter2.emit("balloon-pop",e.position.x,e.position.y,{total:20})},getActiveBalloon:function t(){return this.activeBalloon==0?null:this.balloons[this.activeBalloon]},getNextBalloon:function t(){if(this.activeBalloon+1>this.typingText.length){return null}else{return this.balloons[this.activeBalloon+1]}},getBalloonPosition:function t(e){return{x:this.balloons[e].position.x+this.playerBalloonOffset.x,y:this.balloons[e].position.y+this.playerBalloonOffset.y}},onLastBalloon:function t(){return this.activeBalloon+1>this.typingText.length},createBalloon:function t(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var a=this.calculateBalloonCoordinates(e);var r=this.add.sprite(a.x,a.y,this.pickBalloonStyle());this.balloons[e]=r;r.anchor.setTo(.5,.5);r._state={flashing:false};this.killObjectCache.push(r);if(i){this.addTextNodeToBalloon(r,i)}return r},createBalloonGlow:function t(e){var i=this.add.sprite(e.position.x+this.balloonGlowOffset.x,e.position.y+this.balloonGlowOffset.y,"balloon-glow");i.anchor.setTo(.5,.5);i.alpha=.5;var a=this.add.sprite(e.position.x+this.balloonGlowOffset.x,e.position.y+this.balloonGlowOffset.y,"balloon-ray");a.anchor.setTo(.5,.5);a.alpha=.5;this.balloonGlow.glow=i;this.balloonGlow.ray=a;e.bringToTop()},createBalloonCursor:function t(e){this.balloonCursor=this.add.sprite(e.position.x+this.balloonGlowOffset.x,e.position.y+this.balloonGlowOffset.y,"balloon-cursor");this.balloonCursor.alpha=.7;this.balloonCursor.anchor.setTo(.5,.5);this.balloonCursor.scale.setTo(.55,1);this.add.tween(this.balloonCursor).to({alpha:[.7,.4]},750,d.default.Easing.Linear.None,true,0,-1);this.add.tween(this.balloonCursor.scale).to({x:[.55,.53,.55]},750,d.default.Easing.Quadratic.Out,true,0,-1)},destroyBalloonEffects:function t(){this.balloonGlow.glow.destroy();this.balloonGlow.ray.destroy()},repositionBalloonGlow:function t(e){this.balloonGlow.glow.position.x=e.position.x+this.balloonGlowOffset.x;this.balloonGlow.glow.position.y=e.position.y+this.balloonGlowOffset.y;this.balloonGlow.ray.position.x=e.position.x+this.balloonGlowOffset.x;this.balloonGlow.ray.position.y=e.position.y+this.balloonGlowOffset.y;e.bringToTop()},repositionBalloonCursor:function t(e){if(this.balloonCursor){this.balloonCursor.position.x=e.position.x+this.balloonGlowOffset.x;this.balloonCursor.position.y=e.position.y+this.balloonGlowOffset.y}},calculateBalloonCoordinates:function t(e){var i=this.balloonStartPosition.x+(e-1)*this.balloonSpacing;var a=this.balloonStartPosition.y+(E.RANDOMIZE_BALLOONS?Math.random()*E.RANDOMIZE_AMOUNT:0);return{x:i,y:a}},createBalloonCount:function t(){var e=this.game.height-120;if(b.default.isIOS){e-=50}var i=this.add.sprite(this.game.width-145,e,"balloon-count");i.anchor.setTo(.5,.5);i.scale.setTo(1);i.fixedToCamera=true;this.balloonCountObj=i;this.addTextNodeToBalloonCount(i)},addTextNodeToBalloon:function t(e,i){if(b.default.isUpperCase(i)){var a=this.add.sprite(-40,-45,"caps-arrow");a.alpha=.7;e.addChild(a)}var r=this.add.text(0,-30,i,{font:"50px monospace",fill:"#fff",stroke:"#555",strokeThickness:1,align:"center"});r.anchor.setTo(.5,.5);r.scale.x=1;r.scale.y=1;e.addChild(r)},addTextNodeToBalloonCount:function t(e){var i=this.add.text(70,0,this.balloonsRemaining,{font:"50px Helvetica Neue",fontWeight:100,fill:"#fff",stroke:"#70bbcd",align:"center"});this.balloonCountText=i;i.anchor.setTo(.5,.5);i.scale.x=1;i.scale.y=1;e.addChild(i)},focusNextBalloon:function t(){var e=this.getNextBalloon();if(e){this.repositionBalloonGlow(e);if(E.SHOW_BALLOON_CURSOR){this.repositionBalloonCursor(e)}}},flashBalloon:function t(e){if(e._state.flashing){return}e.anchor.setTo(.5,.5);this.balloonFlashingTween=this.add.tween(e).to({alpha:[1,.5]},300,d.default.Easing.Linear.None,true,0,-1);e._state.flashing=true},jerkBalloonAndPlayer:function t(e){if(e){e.anchor.setTo(.5,.5);var i=this.add.tween(e.scale).to({x:[1,1.2,1],y:[1,1.2,1]},150,d.default.Easing.Linear.None,true);var a=this.player;var r=this.add.tween(a.scale).to({x:[1,1.2,1],y:[1,1.2,1]},150,d.default.Easing.Linear.None,true)}},destroyBalloon:function t(e){if(this.player._state.isOnStartPlatform||e==0){return}var i=this.balloons[e];i.anchor.setTo(.5,.5);this.balloons[e]=null;var a=this.add.tween(i).to({alpha:[1,0],y:[150]},300,d.default.Easing.Linear.None,true).onComplete.add(function(){i.destroy()});this.add.tween(i.scale).to({x:[1,.1],y:[1,.1]},200,d.default.Easing.Linear.None,true)},jump:function t(){var e=this.player;this.player._state.isJumping=true;e.animations.play("jump",30,false);var i=this.getBalloonPosition(this.activeBalloon+1);var a=this.getNextBalloon();(0,y.default)(a.children,function(t){this.add.tween(t).to({alpha:[1,0]},200,d.default.Easing.Linear.None,true)}.bind(this));if(e._state.isOnStartPlatform){n.default.GameUtil.hideStartingText.call(this)}var r=e._state.isOnStartPlatform?{x:e.position.x+85,y:e.position.y}:this.getBalloonPosition(this.activeBalloon);var s={x:i.x-r.x,y:i.y-r.y};this.add.tween(e).to({x:[r.x,r.x+s.x/2,i.x],y:[r.y,100+s.y/2,i.y]},150,d.default.Easing.Quadratic.Out,true).interpolation(function(t,e){return d.default.Math.bezierInterpolation(t,e)}).onComplete.add(function(){if(this.balloonsRemaining){var t=this.getBalloonPosition(this.activeBalloon);this.player.position.x=t.x;this.player.position.y=t.y;this.player._state.isJumping=false}}.bind(this));(function(t){this.game.time.events.add(140,function(){this.destroyBalloon(t)}.bind(this),this)}).bind(this)(this.activeBalloon);this.activeBalloon++;this.focusNextBalloon();if(this.player._state.isOnStartPlatform){this.player._state.isOnStartPlatform=false}if(this.onLastBalloon()){this.destroyBalloonEffects();this.balloonCursor.kill();var o=this;this.game.time.events.add(300,this.jumpOff,this)}e.bringToTop()},jumpOff:function t(){var e=this.player;this.player._state.isJumping=true;e.animations.play("jump-off",30,false);var i=this.getEndPlatformPosition();var a={x:this.player.position.x,y:this.player.position.y};var r={x:i.x-a.x,y:i.y-a.y};this.add.tween(e).to({x:[a.x,a.x+r.x/2,i.x],y:[a.y,50,i.y]},200,d.default.Easing.Quadratic.Out,true).interpolation(function(t,e){return d.default.Math.bezierInterpolation(t,e)})},wrong:function t(){this.jerkBalloonAndPlayer(this.getActiveBalloon())},getEndPlatformPosition:function t(){return{x:this.gameWidth-200,y:this.game.height-this.cache.getImage("cliff-right").height+100}},moveCamera:function t(){this.cameraPos.x+=(this.player.x-this.cameraPos.x+this.cameraCenterXOffset)*this.cameraMoveSmoothness;this.camera.focusOnXY(this.cameraPos.x,this.cameraPos.y)}};function O(t){var e={width:E.STANDARD_DIMENSIONS.x,height:E.STANDARD_DIMENSIONS.y};if(E.FULL_SCREEN){e=n.default.getWindowDimensions();(0,u.default)(".game-normal").removeClass("game-normal").addClass("game-fullscreen")}var i=new d.default.Game(e.width,e.height,d.default.CANVAS,"game",null,false,true);i.state.add("Game.BootState",E.BootState);i.state.add("Game.PreloadState",E.PreloadState);i.state.add("Game.FallBackPreloadState",E.FallBackPreloadState);i.state.add("Game.MainState",E.MainState);i.state.start("Game.BootState",true,false,t);T.default.events.on("unload",function(){i.load.hasLoaded=true;i.load.reset(true,true);i.state.destroy();i.destroy()})}e.default=n.default.wrapGameWithHeader(O)},991:function(t,e,i){Phaser.ParticleStorm=function(t,e){Phaser.Plugin.call(this,t,e);this.emitters=[];this.dataList={};var i=PIXI.canUseNewCanvasBlendModes();this.blendModeMap={NORMAL:[0,"source-over"],ADD:[1,"lighter"],MULTIPLY:[2,i?"multiply":"source-over"],SCREEN:[3,i?"screen":"source-over"],OVERLAY:[4,i?"overlay":"source-over"],DARKEN:[5,i?"darken":"source-over"],LIGHTEN:[6,i?"lighten":"source-over"],COLOR_DODGE:[7,i?"color-dodge":"source-over"],COLOR_BURN:[8,i?"color-burn":"source-over"],HARD_LIGHT:[9,i?"hard-light":"source-over"],SOFT_LIGHT:[10,i?"soft-light":"source-over"],DIFFERENCE:[11,i?"difference":"source-over"],EXCLUSION:[12,i?"exclusion":"source-over"],HUE:[13,i?"hue":"source-over"],SATURATION:[14,i?"saturation":"source-over"],COLOR:[15,i?"color":"source-over"],LUMINOSITY:[16,i?"luminosity":"source-over"]};this.hsv=Phaser.Color.HSVColorWheel()};Phaser.ParticleStorm.prototype=Object.create(Phaser.Plugin.prototype);Phaser.ParticleStorm.prototype.constructor=Phaser.ParticleStorm;Phaser.ParticleStorm.SPRITE="sprite";Phaser.ParticleStorm.PIXEL="pixel";Phaser.ParticleStorm.RENDERTEXTURE="render texture";Phaser.ParticleStorm.SPRITE_BATCH="sprite batch";Phaser.ParticleStorm.BITMAP_DATA="bitmap data";Phaser.ParticleStorm.BASE={value:0,initial:0,delta:0,offset:0,control:null,calc:0};Phaser.ParticleStorm.BASE_1={value:1,initial:0,delta:0,offset:0,control:null,calc:1};Phaser.ParticleStorm.BASE_255={value:0,initial:0,delta:0,offset:0,min:0,max:255,control:null,calc:0};Phaser.ParticleStorm.BASE_359={value:0,initial:0,delta:0,offset:0,min:0,max:359,control:null,calc:0};Phaser.ParticleStorm.BASE_NULL={value:null,initial:0,delta:0,offset:0,control:null,calc:0};Phaser.ParticleStorm.BASE_EMIT={name:null,value:0,initial:0,control:null,at:null,inherit:true,offsetX:0,offsetY:0};Phaser.ParticleStorm.Controls={};Phaser.ParticleStorm.Zones={};Phaser.ParticleStorm.prototype.createEmitter=function(t,e,i){var a=new Phaser.ParticleStorm.Emitter(this,t,e,i);this.emitters.push(a);return a};Phaser.ParticleStorm.prototype.removeEmitter=function(t){for(var e=0;e<this.emitters.length;e++){if(this.emitters[e]===t){this.emitters.splice(e,1);return}}};Phaser.ParticleStorm.prototype.addData=function(t,e){if(t===undefined){return this}if(Array.isArray(t)){for(var i=0;i<t.length;i++){this.dataList[t[i]]=this.game.cache.getJSON(t[i])}}else{if(e!==undefined){this.dataList[t]=e}else{this.dataList[t]=this.game.cache.getJSON(t)}}return this};Phaser.ParticleStorm.prototype.getData=function(t){return this.dataList[t]};Phaser.ParticleStorm.prototype.clearData=function(t){if(t===undefined){this.dataList={}}else{if(Array.isArray(t)){for(var e=0;e<t.length;e++){delete this.dataList[t[e]]}}else{delete this.dataList[t]}}return this};Phaser.ParticleStorm.prototype.cloneData=function(t,e){if(t===undefined){return this}if(Array.isArray(t)){for(var i=0;i<t.length;i++){this.dataList[t[i]]=Phaser.Utils.extend(true,this.game.cache.getJSON(t[i]))}}else{if(e!==undefined){this.dataList[t]=Phaser.Utils.extend(true,e)}else{this.dataList[t]=Phaser.Utils.extend(true,this.game.cache.getJSON(t))}}return this};Phaser.ParticleStorm.prototype.createPointZone=function(t,e){return new Phaser.ParticleStorm.Zones.Point(this.game,t,e)};Phaser.ParticleStorm.prototype.createLineZone=function(t,e,i,a){return new Phaser.ParticleStorm.Zones.Line(this.game,t,e,i,a)};Phaser.ParticleStorm.prototype.createRectangleZone=function(t,e){return new Phaser.ParticleStorm.Zones.Rectangle(this.game,t,e)};Phaser.ParticleStorm.prototype.createCircleZone=function(t){return new Phaser.ParticleStorm.Zones.Circle(this.game,t)};Phaser.ParticleStorm.prototype.createEllipseZone=function(t,e){return new Phaser.ParticleStorm.Zones.Ellipse(this.game,t,e)};Phaser.ParticleStorm.prototype.createLinearSplineZone=function(t,e,i){return new Phaser.ParticleStorm.Zones.Spline(this.game,0,t,e,i)};Phaser.ParticleStorm.prototype.createBezierSplineZone=function(t,e,i){return new Phaser.ParticleStorm.Zones.Spline(this.game,1,t,e,i)};Phaser.ParticleStorm.prototype.createCatmullSplineZone=function(t,e,i){return new Phaser.ParticleStorm.Zones.Spline(this.game,2,t,e,i)};Phaser.ParticleStorm.prototype.createSplineZone=function(t,e,i,a){return new Phaser.ParticleStorm.Zones.Spline(this.game,t,e,i,a)};Phaser.ParticleStorm.prototype.createTextZone=function(t){return new Phaser.ParticleStorm.Zones.Text(this.game,t)};Phaser.ParticleStorm.prototype.createImageZone=function(t){return new Phaser.ParticleStorm.Zones.Image(this.game,t)};Phaser.ParticleStorm.prototype.update=function(){if(!this.active){return}for(var t=0;t<this.emitters.length;t++){if(this.emitters[t].enabled&&!this.emitters[t].manualUpdate){this.emitters[t].update()}}};Phaser.ParticleStorm.Emitter=function(t,e,i,a){this.game=t.game;this.parent=t;this.renderer=null;this.renderType=null;this.graph=Phaser.ParticleStorm.Graph;this.enabled=false;this.manualUpdate=false;this.scrollSpeed=new Phaser.Point;this.force=new Phaser.Point;this.onEmit=null;this.onComplete=null;this.onKill=null;this.particleClass=Phaser.ParticleStorm.Particle;this.timer=this.game.time.create(false);this.timerEvent=null;this.list=[];this.pool=[];this.batch=[];this.wells=[];this._rnd=new Phaser.Point;this._step=new Phaser.Point;this._pCount=0;this._delay={enabled:false,start:0,inc:0,visible:false};this.init(e,i,a)};Phaser.ParticleStorm.Emitter.prototype={init:function t(e,i,a){if(e===undefined){e=Phaser.ParticleStorm.SPRITE}var r=this.game.width;var s=this.game.height;switch(e){case Phaser.ParticleStorm.SPRITE:this.renderer=new Phaser.ParticleStorm.Renderer.Sprite(this);break;case Phaser.ParticleStorm.PIXEL:this.renderer=new Phaser.ParticleStorm.Renderer.Pixel(this,r,s);break;case Phaser.ParticleStorm.RENDERTEXTURE:this.renderer=new Phaser.ParticleStorm.Renderer.RenderTexture(this,r,s);break;case Phaser.ParticleStorm.SPRITE_BATCH:this.renderer=new Phaser.ParticleStorm.Renderer.SpriteBatch(this);break;case Phaser.ParticleStorm.BITMAP_DATA:this.renderer=new Phaser.ParticleStorm.Renderer.BitmapData(this,r,s);break;default:console.warn("ParticleManager.init - Invalid renderType given");return false}this.renderType=e;if(i){this.force.set(i.x,i.y)}if(a){this.scrollSpeed.set(a.x,a.y)}this.list=[];this.pool=[];this.wells=[];this.enabled=true},addToWorld:function t(e){if(e===undefined){e=this.game.world}return this.renderer.addToWorld(e)},createGravityWell:function t(e,i,a,r,s){var n=new Phaser.ParticleStorm.GravityWell(this,e,i,a,r,s);this.wells.push(n);return n},seed:function t(e){for(var i=0;i<e;i++){var a=new Phaser.ParticleStorm.Particle(this);this.pool.push(a)}return this},emitDelayed:function t(e,i,a,r,s){if(!this.enabled||!this.parent.dataList[i]||e<=0){return null}this.timerEvent=this.timer.add(e,this.emit,this,i,a,r,s);this.timer.start();return this.timerEvent},emit:function t(e,i,a,r){if(!this.enabled||!this.parent.dataList[e]){return null}this.batch=[];this._pCount=0;this._step.x=0;this._step.y=0;if(i===undefined){i=0}if(a===undefined){a=0}if(!r){return this.emitParticle(e,i,a,null)}var s=r.hasOwnProperty("total")?r.total:1;if(r.xStep>0){this._step.x=r.xStep}else{this._step.x=0}if(r.yStep>0){this._step.y=r.yStep}else{this._step.y=0}this._delay.enabled=false;if(r.delay){this._delay.enabled=true;if(typeof r.delay==="number"){this._delay.start=r.delay;this._delay.step=0;this._delay.visible=false}else{this._delay.start=r.delay.start?r.delay.start:0;this._delay.step=r.delay.step?r.delay.step:0;this._delay.visible=r.delay.visible?true:false}}if(r.zone){if(r.random===undefined&&r.full===undefined&&r.percent===undefined||r.random){r.zone.emit(this,e,i,a,s,r.setAlpha,r.setColor)}else if(r.percent===undefined&&(r.full!==undefined||!r.random)){r.zone.emitFull(this,e,i,a,r.step,r.spacing,r.setAlpha,r.setColor)}else if(r.percent!==undefined){var n=0;if(typeof r.percent==="number"){n=r.percent}else{if(r.percent.hasOwnProperty("min")){n=this.game.rnd.between(r.percent.min,r.percent.max)}else if(r.percent.callback){n=r.percent.callback.call(r.percent.context,this)}}r.zone.emitPercent(this,e,i,a,s,n)}}else{for(var o=0;o<s;o++){this.emitParticle(e,i,a,null)}}if(r.radiate){for(var l=0;l<this.batch.length;l++){this.batch[l].radiate(r.radiate.velocity,r.radiate.from,r.radiate.to)}}else if(r.radiateFrom){for(var l=0;l<this.batch.length;l++){this.batch[l].radiateFrom(r.radiateFrom.x,r.radiateFrom.y,r.radiateFrom.velocity)}}var h=r.hasOwnProperty("repeat")?r.repeat:0;if(h!==0){var d=r.hasOwnProperty("frequency")?r.frequency:250;delete r.repeat;if(h===-1){this.timerEvent=this.timer.loop(d,this.emit,this,e,i,a,r)}else if(h>0){this.timerEvent=this.timer.repeat(d,h,this.emit,this,e,i,a,r)}this.timer.start()}this._pCount=0;return this.batch},emitParticle:function t(e,i,a,r){var s=this.pool.pop();if(!s){s=new this.particleClass(this)}s.parent=r;if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}i+=this._step.x*this._pCount;a+=this._step.y*this._pCount;s.reset(this.renderer,i,a,this.parent.dataList[e]);if(s.alive){if(!r&&this._delay.enabled){s.delay+=this._delay.start+this._pCount*this._delay.step;s.delayVisible=this._delay.visible}this.list.push(s);this.batch.push(s);if(!r){this._pCount++}}else{s.kill();if(this.onKill){this.onKill.dispatch(this,s)}this.pool.push(s)}return s},update:function t(){var e=this.game.time.elapsed;this.renderer.preUpdate();for(var i=this.list.length-1;i>=0;i--){var a=this.list[i];if(!a.ignoreScrollSpeed){a.transform.x+=this.scrollSpeed.x;a.transform.y+=this.scrollSpeed.y}for(var r=0;r<this.wells.length;r++){if(this.wells[r].active){this.wells[r].step(a)}}if(!a.step(e,this.force)){a.kill();this.pool.push(a);this.list.splice(i,1)}}this.renderer.postUpdate();return this.list.length},updateFrequency:function t(e,i,a,r){if(e.at){var s=0;for(var n=0;n<e.at.length;n++){var o=e.at[n];if((o.time>a||o.time===0&&a===0)&&o.time<=r){if(o.value>0&&o.value<1){if(Math.random()<o.value){s+=1}}else{s+=o.value}}}return s}return this.graph.getParamArea(e,a,r)*i},forEach:function t(e,i){if(arguments.length<=2){for(var a=0;a<this.list.length;a++){e.call(i,this.list[a])}}else{var r=[null];for(var a=2;a<arguments.length;a++){r.push(arguments[a])}for(var a=0;a<this.list.length;a++){r[0]=this.list[a];e.apply(i,r)}}},forEachNew:function t(e,i){if(this.batch.length===0){return}if(arguments.length<=2){for(var a=0;a<this.batch.length;a++){e.call(i,this.batch[a])}}else{var r=[null];for(var a=2;a<arguments.length;a++){r.push(arguments[a])}for(var a=0;a<this.batch.length;a++){r[0]=this.batch[a];e.apply(i,r)}}},getParticle:function t(e){if(e===undefined){e=0}if(this.list[e]){return this.list[e]}else{return null}},debug:function t(e,i){var a=this.game.debug;if(a){a.start(e+4,i+16,"rgb(255, 255, 255)",132);a.context.fillStyle="rgba(0, 74, 128, 0.5)";a.context.fillRect(e,i,360,70);var r=this.force.x+"";var s=this.force.y+"";a.line("Force:",r.substr(0,8),s.substr(0,8));a.line("Scroll Speed:",this.scrollSpeed.x,this.scrollSpeed.y);a.line("Alive:","Dead:","Total:");a.line(this.alive,this.dead,this.total);a.stop()}},destroy:function t(){if(this.renderer.clear){this.renderer.clear()}this.renderer.destroy();this.renderer=null;for(var e=this.list.length-1;e>=0;e--){this.list[e].kill();this.list.splice(e,1)}this.list=[];this.pool=[];this.batch=[];this.wells=[]}};Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype,"paused",{get:function t(){return!this.enabled},set:function t(e){this.enabled=!e}});Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype,"total",{get:function t(){return this.alive+this.dead}});Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype,"alive",{get:function t(){return this.list.length}});Object.defineProperty(Phaser.ParticleStorm.Emitter.prototype,"dead",{get:function t(){return this.pool.length}});Phaser.ParticleStorm.Emitter.prototype.constructor=Phaser.ParticleStorm.Emitter;Phaser.ParticleStorm.Particle=function(t){this.emitter=t;this.renderer=null;this.graph=Phaser.ParticleStorm.Graph;this.transform=new Phaser.ParticleStorm.Controls.Transform(this);this.color=new Phaser.ParticleStorm.Controls.Color(this);this.texture=new Phaser.ParticleStorm.Controls.Texture(this);this.parent=null;this.lifespan=2e3;this.keepAlive=false;this.delay=0;this.delayVisible=false;this.life=0;this.sprite=null;this.visible=false;this.isComplete=false;this.ignoreForce=false;this.ignoreScrollSpeed=false;this.emit={};this._age=0;this._lastPercent=0;this._numToEmit=0};Phaser.ParticleStorm.Particle.prototype={reset:function t(e,i,a,r){this.renderer=e;this.transform.reset();this.color.reset();this.texture.reset();this.emit=Object.create(Phaser.ParticleStorm.BASE_EMIT);this.isComplete=false;this.keepAlive=false;this.delay=0;this.delayVisible=false;this.ignoreForce=false;this.ignoreScrollSpeed=false;this.alive=false;this.lifespan=2e3;this.life=0;this.visible=false;this._age=0;this._lastPercent=0;this._numToEmit=0;if(r!==undefined){this.create(i,a,r)}return this},create:function t(e,i,a){if(a.hasOwnProperty("lifespan")){this.lifespan=this.graph.getMinMax(a.lifespan)}this.keepAlive=a.keepAlive;if(a.hasOwnProperty("delay")){this.delay=this.graph.getMinMax(a.delay)}this.ignoreForce=a.ignoreForce;this.ignoreScrollSpeed=a.ignoreScrollSpeed;this.transform.init(e,i,a);this.color.init(a);this.texture.init(a);if(a.emit){this.emit=Object.create(a.emit)}this.visible=a.visible===false?false:true;this.alive=true;if(this.parent&&this.parent.emit&&this.parent.emit.inherit){this.alive=this.onInherit(this.parent)}if(this.alive){this.transform.step();this.color.step();var r=this.renderer.add(this);if(r){this.texture.step(a,r)}this.onEmit();if(this.emitter.onEmit){this.emitter.onEmit.dispatch(this.emitter,this)}this.renderer.update(this)}return this},step:function t(e,i){this._age+=e;if(this.delay){if(this._age<this.delay){this.renderer.update(this);return true}else{this.delay=0;this._age=0}}this._lastPercent=this.life;if(this.lifespan>0){this.life=Math.min(this._age/this.lifespan,1)}if(i&&!this.ignoreForce){this.transform.velocity.x.value+=i.x;this.transform.velocity.y.value+=i.y}this.transform.step();this.color.step();this.onUpdate();if(this.alive){this._numToEmit+=this.emitter.updateFrequency(this.emit,e,this._lastPercent,this.life);while(this._numToEmit>=1){this.emitChild()}this.renderer.update(this)}if(!this.isComplete&&this.life===1){this.isComplete=true;if(this.emitter.onComplete){this.emitter.onComplete.dispatch(this.emitter,this)}}return this.life<1||this.keepAlive},emitChild:function t(){var e=this.graph.getMinMax(this.emit.offsetX)|0;var i=this.graph.getMinMax(this.emit.offsetY)|0;if(this.emit.rect){var a=this.emit.rect;e=Math.random()*a.width+a.x;i=Math.random()*a.height+a.y}else if(this.emit.circle){var r=this.emit.circle;i=Math.random()*r*2-r;var s=Math.sqrt(r*r-i*i);e=Math.random()*s*2-s}var n=this.emit.name;if(typeof n!=="string"){n=this.getChildKey(this.emit.name)}if(n){var o=this.emitter.emitParticle(n,this.transform.x+e,this.transform.y+i,this);if(o&&this.emit.overwrite){this.applyOverwrite(this.emit.overwrite,o)}}this._numToEmit-=1},applyOverwrite:function t(e,i){return i},getChildKey:function t(e){if(Array.isArray(e)){return this.emitter.game.rnd.pick(e)}if(e.at!==undefined&&e.at.length>0){var i=e.at[0].value;for(var a=0;a<e.at.length;a++){if(e.at[a].time>this.life){break}i=e.at[a].value}return i}return null},radiate:function t(e,i,a){if(a===undefined&&i!==undefined){a=i}else{if(i===undefined){i=0}if(a===undefined){a=359}}var r=e;if(e.hasOwnProperty("min")){r=this.graph.getMinMax(e)}else if(Array.isArray(e)){r=parseFloat(this.emitter.game.rnd.pick(e),10)}var s=(Math.random()*(a-i)+i)*Math.PI/180;this.transform.velocity.x.value=Math.sin(s)*r;this.transform.velocity.y.value=-Math.cos(s)*r;return this},radiateFrom:function t(e,i,a){var r=a;if(a.hasOwnProperty("min")){r=this.graph.getMinMax(a)}else if(Array.isArray(a)){r=parseFloat(this.emitter.game.rnd.pick(a),10)}var s=this.transform.x-e;var n=this.transform.y-i;var o=Math.sqrt(s*s+n*n);this.transform.velocity.x.value=s*r/o;this.transform.velocity.y.value=n*r/o;return this},target:function t(e){var i=0;var a=0;var r=this.transform;if(e.x){i=e.x}if(e.y){a=e.y}if(e.zone){var s=e.zone.getRandom();i+=s.x;a+=s.y}var n=Math.atan2(a-r.y,i-r.x);var o=r.x-i;var l=r.y-a;var h=Math.sqrt(o*o+l*l)/(this.lifespan/1e3);var d=Math.cos(n)*h*r.time.physicsElapsed;var c=Math.sin(n)*h*r.time.physicsElapsed;if(e.speed){this.graph.fromControl({value:d*2,control:e.speed},r.velocity.x);this.graph.fromControl({value:c*2,control:e.speed},r.velocity.y)}else{r.velocity.x.value=d;r.velocity.y.value=c}return this},setLife:function t(e,i){this.lifespan=this.graph.getMinMax(e);this.life=0;this._age=0;this._lastPercent=0;this.isComplete=false;this.keepAlive=i;return this},kill:function t(){this.alive=false;this.renderer.kill(this);this.onKill()},onEmit:function t(){},onUpdate:function t(){},onInherit:function t(){return true},onKill:function t(){}};Object.defineProperty(Phaser.ParticleStorm.Particle.prototype,"lifePercent",{get:function t(){return Math.round(this.life*100)}});Object.defineProperty(Phaser.ParticleStorm.Particle.prototype,"frequency",{get:function t(){return this.emit.value},set:function t(e){this.emit.value=e}});Phaser.ParticleStorm.Particle.prototype.constructor=Phaser.ParticleStorm.Particle;Phaser.ParticleStorm.GravityWell=function(t,e,i,a,r,s){if(e===undefined){e=0}if(i===undefined){i=0}if(a===undefined){a=0}if(r===undefined){r=100}if(s===undefined){s=50}this.emitter=t;this.time=t.game.time;this.position=new Phaser.Point(e,i);this.active=true;this._gravity=s;this._power=0;this._epsilon=0;this.power=a;this.epsilon=r};Phaser.ParticleStorm.GravityWell.prototype={step:function t(e){var i=this.position.x-e.transform.x;var a=this.position.y-e.transform.y;var r=i*i+a*a;if(r===0){return}var s=Math.sqrt(r);if(r<this._epsilon){r=this._epsilon}var n=this._power*this.time.elapsed/(r*s);e.transform.velocity.x.value+=i*n;e.transform.velocity.y.value+=a*n}};Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype,"epsilon",{get:function t(){return Math.sqrt(this._epsilon)},set:function t(e){this._epsilon=e*e}});Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype,"power",{get:function t(){return this._power/this.gravity},set:function t(e){this._power=e*this.gravity}});Object.defineProperty(Phaser.ParticleStorm.GravityWell.prototype,"gravity",{get:function t(){return this._gravity},set:function t(e){var i=this.power;this._gravity=e;this.power=i}});Phaser.ParticleStorm.GravityWell.prototype.constructor=Phaser.ParticleStorm.GravityWell;Phaser.ParticleStorm.Graph={CONTROL_LINEAR:[{x:0,y:1},{x:1,y:0}],CONTROL_REVERSE:[{x:0,y:0},{x:1,y:1}],CONTROL_YOYO:[{x:0,y:0},{x:.5,y:1},{x:1,y:0}],getControlValue:function t(e,i){var a=0;var r=e[a];if(r.x===i){return r.y}while(r.x<=i){if(a>=e.length-1){return r.x}r=e[++a]}var s=e[a-1];return s.y+(i-s.x)*(r.y-s.y)/(r.x-s.x)},getControlValues:function t(e,i,a){var r=Phaser.ParticleStorm.Graph.getControlValue(e,i);var s=[{x:i,y:r}];if(i>=a){return s}for(var n=0;n<e.length;n++){if(e[n].x>i){if(e[n].x<a){s.push(e[n])}else{break}}}s.push({x:a,y:Phaser.ParticleStorm.Graph.getControlValue(e,a)});return s},getParamArea:function t(e,i,a){if(e.control){return e.value*Phaser.ParticleStorm.Graph.getControlArea(e.control,i,a)}return e.value},getControlArea:function t(e,i,a){var r=Phaser.ParticleStorm.Graph.getControlValues(e,i,a);if(i>=a){return r[0].y}var s=r.length>1?0:r.y;var n=r[0];for(var o=1;o<r.length;o++){var l=r[o];s+=.5*(l.x-n.x)*(n.y+l.y);n=l}return s},getMinMaxInitial:function t(e){if(e.initial!==undefined){return Phaser.ParticleStorm.Graph.getMinMax(e.initial)}else{return 0}},isNumeric:function t(e){return!isNaN(parseFloat(e))&&isFinite(e)},getMinMax:function t(e){if(e!==undefined&&e!==null&&e.min!==undefined&&e.max!==undefined){return e.min+Math.random()*(e.max-e.min)}return e},clone:function t(e,i){i.value=e.value;i.initial=e.initial;i.delta=e.delta;i.offset=e.offset;i.min=e.min;i.max=e.max;i.control=e.control;return i},fromControl:function t(e,i){if(e.value!==undefined){i.value=Phaser.ParticleStorm.Graph.getMinMax(e.value)}if(e.control){if(e.control==="linear"){i.control=Phaser.ParticleStorm.Graph.CONTROL_LINEAR}else if(e.control==="reverse"){i.control=Phaser.ParticleStorm.Graph.CONTROL_REVERSE}else if(e.control==="yoyo"){i.control=Phaser.ParticleStorm.Graph.CONTROL_YOYO}else{i.control=e.control}}},fromData:function t(e,i){if(e===undefined||e===null){return false}if(typeof e==="number"){i.value=e;return true}if(e.min!==undefined){i.value=Phaser.ParticleStorm.Graph.getMinMax(e)}else if(e.value!==undefined){i.value=Phaser.ParticleStorm.Graph.getMinMax(e.value)}if(e.initial!==undefined){i.initial=Phaser.ParticleStorm.Graph.getMinMax(e.initial)}if(e.delta!==undefined){i.delta=Phaser.ParticleStorm.Graph.getMinMax(e.delta)}if(e.offset!==undefined){i.offset=Phaser.ParticleStorm.Graph.getMinMax(e.offset)}if(e.control){if(e.control==="linear"){i.control=Phaser.ParticleStorm.Graph.CONTROL_LINEAR}else if(e.control==="reverse"){i.control=Phaser.ParticleStorm.Graph.CONTROL_REVERSE}else if(e.control==="yoyo"){i.control=Phaser.ParticleStorm.Graph.CONTROL_YOYO}else{i.control=e.control}}return true},getValue:function t(e,i){if(!e.control||i===undefined){return e.value}var a=e.control[0];if(a.x===i){return a.y}var r=e.control.length-1;var s=e.control[r];if(s.x===i){return s.y}r=0;while(a.x<=i){if(r>=e.control.length-1){return a.y}a=e.control[++r]}var n=e.control[r-1];return e.value*(n.y+(i-n.x)*(a.y-n.y)/(a.x-n.x))},getClampedValue:function t(e,i){return Phaser.Math.clamp(Math.floor(e.initial+this.getValue(e,i)),e.min,e.max)}};Phaser.ParticleStorm.Zones={};Phaser.ParticleStorm.Zones.Base=function(t){this.game=t;this.active=true;this.scale=new Phaser.Point(1,1);this.alphaThreshold=0;this._rnd=new Phaser.Point};Phaser.ParticleStorm.Zones.Base.prototype={getRandom:function t(){if(this.shape===Phaser.Point){this._rnd=this.shape}else{this.shape.random(this._rnd)}this._rnd.x*=this.scale.x;this._rnd.y*=this.scale.y;return this._rnd},emit:function t(e,i,a,r,s){if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}if(Array.isArray(r)){r=this.game.rnd.between(r[0],r[1])}var n=null;for(var o=0;o<s;o++){this.shape.random(this._rnd);n=e.emitParticle(i,a+this._rnd.x*this.scale.x,r+this._rnd.y*this.scale.y,null)}return n}};Phaser.ParticleStorm.Zones.Base.prototype.constructor=Phaser.ParticleStorm.Zones.Base;Phaser.ParticleStorm.Zones.Point=function(t,e,i){Phaser.ParticleStorm.Zones.Base.call(this,t);this.shape=new Phaser.Point(e,i)};Phaser.ParticleStorm.Zones.Point.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Point.prototype.constructor=Phaser.ParticleStorm.Zones.Point;Phaser.ParticleStorm.Zones.Rectangle=function(t,e,i){Phaser.ParticleStorm.Zones.Base.call(this,t);this.shape=new Phaser.Rectangle(0,0,e,i)};Phaser.ParticleStorm.Zones.Rectangle.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Rectangle.prototype.constructor=Phaser.ParticleStorm.Zones.Rectangle;Phaser.ParticleStorm.Zones.Circle=function(t,e){Phaser.ParticleStorm.Zones.Base.call(this,t);this.shape=new Phaser.Circle(0,0,e*2)};Phaser.ParticleStorm.Zones.Circle.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Circle.prototype.constructor=Phaser.ParticleStorm.Zones.Circle;Phaser.ParticleStorm.Zones.Ellipse=function(t,e,i){Phaser.ParticleStorm.Zones.Base.call(this,t);this.shape=new Phaser.Ellipse(0,0,e,i)};Phaser.ParticleStorm.Zones.Ellipse.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Ellipse.prototype.constructor=Phaser.ParticleStorm.Zones.Ellipse;Phaser.ParticleStorm.Zones.Line=function(t,e,i,a,r){Phaser.ParticleStorm.Zones.Base.call(this,t);this.shape=new Phaser.Line(e,i,a,r)};Phaser.ParticleStorm.Zones.Line.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Line.prototype.constructor=Phaser.ParticleStorm.Zones.Line;Phaser.ParticleStorm.Zones.Spline=function(t,e,i,a,r){if(e===undefined){e=0}if(i===undefined){i=1e3}if(a===undefined){a=true}Phaser.ParticleStorm.Zones.Base.call(this,t);this.math=this.game.math;this.points={x:[],y:[]};this.path=[];this.resolution=i;this.mode=e;this.closed=a;this.mult=0;this.update(r)};Phaser.ParticleStorm.Zones.Spline.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Spline.prototype.constructor=Phaser.ParticleStorm.Zones.Spline;Phaser.ParticleStorm.Zones.Spline.prototype.update=function(t){this.points={x:[],y:[]};this.path=[];for(var e=0;e<t.length;e++){this.points.x.push(t[e].x);this.points.y.push(t[e].y)}if(this.closed){this.points.x.push(t[0].x);this.points.y.push(t[0].y)}var i=0;var a=1/this.resolution;for(var e=0;e<=1;e+=a){if(this.mode===0){var r=this.math.linearInterpolation(this.points.x,e);var s=this.math.linearInterpolation(this.points.y,e)}else if(this.mode===1){var r=this.math.bezierInterpolation(this.points.x,e);var s=this.math.bezierInterpolation(this.points.y,e)}else if(this.mode===2){var r=this.math.catmullRomInterpolation(this.points.x,e);var s=this.math.catmullRomInterpolation(this.points.y,e)}var n={x:r,y:s,angle:0};if(i>0){n.angle=this.math.angleBetweenPoints(this.path[i-1],n)}this.path.push(n);i++}this.mult=this.path.length/100;return this};Phaser.ParticleStorm.Zones.Spline.prototype.getRandom=function(){return this.game.rnd.pick(this.path)};Phaser.ParticleStorm.Zones.Spline.prototype.emit=function(t,e,i,a,r){if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var s=null;var n=null;for(var o=0;o<r;o++){s=this.game.rnd.pick(this.path);n=t.emitParticle(e,i+s.x,a+s.y)}return n};Phaser.ParticleStorm.Zones.Spline.prototype.emitPercent=function(t,e,i,a,r,s){if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var n=null;s=Math.floor(s*this.mult);for(var o=0;o<r;o++){var l=this.path[s];if(l){n=t.emitParticle(e,i+l.x,a+l.y)}}return n};Phaser.ParticleStorm.Zones.Text=function(t,e){Phaser.ParticleStorm.Zones.Base.call(this,t);this.bmd=new Phaser.BitmapData(t,"ParticleStorm.Text");this.text=e;this.points=[];this.update(e)};Phaser.ParticleStorm.Zones.Text.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Text.prototype.constructor=Phaser.ParticleStorm.Zones.Text;Phaser.ParticleStorm.Zones.Text.prototype.update=function(t){if(t!==undefined){this.text=t}else{t=this.text}var e=t.x;var i=t.y;var a=t.scale.x;var r=t.scale.y;t.x=0;t.y=0;t.scale.set(1);this.points=[];this.bmd.load(t);this.bmd.processPixelRGB(this.addPixel,this);this.scale=new Phaser.Point(a,r);t.x=e;t.y=i;t.scale.set(a,r);return this};Phaser.ParticleStorm.Zones.Text.prototype.addPixel=function(t,e,i){if(t.a>this.alphaThreshold){this.points.push({x:e,y:i,color:{r:t.r,g:t.g,b:t.b,a:t.a/255}})}return false};Phaser.ParticleStorm.Zones.Text.prototype.getRandom=function(){var t=this.game.rnd.pick(this.points);t.x*=this.scale.x;t.y*=this.scale.y;return t};Phaser.ParticleStorm.Zones.Text.prototype.emit=function(t,e,i,a,r,s,n){if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var o=null;var l=null;for(var h=0;h<r;h++){o=this.game.rnd.pick(this.points);l=t.emitParticle(e,i+o.x*this.scale.x,a+o.y*this.scale.y);if(l){if(s&&o.color.a<1){l.color.alpha.value=o.color.a}if(n){l.color.setColor(o.color.r,o.color.g,o.color.b,o.color.a)}}}return l};Phaser.ParticleStorm.Zones.Text.prototype.emitFull=function(t,e,i,a,r,s,n,o){if(r===undefined){r=1}var l=1;var h=1;if(Array.isArray(s)){l=s[0];h=s[1]}else if(typeof s==="number"){l=s;h=s}if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var d=null;var c=null;for(var u=0;u<this.points.length;u+=r){d=this.points[u];var f=i+d.x*this.scale.x*(l/r);var m=a+d.y*this.scale.y*(h/r);c=t.emitParticle(e,f,m);if(c){if(n&&d.color.a<1){c.color.alpha.value=d.color.a}if(o){c.color.setColor(d.color.r,d.color.g,d.color.b,d.color.a)}}}return c};Phaser.ParticleStorm.Zones.Image=function(t,e){Phaser.ParticleStorm.Zones.Base.call(this,t);this.bmd=new Phaser.BitmapData(t,"ParticleStorm.Image");this.key=e;this.points=[];this.update(e)};Phaser.ParticleStorm.Zones.Image.prototype=Object.create(Phaser.ParticleStorm.Zones.Base.prototype);Phaser.ParticleStorm.Zones.Image.prototype.constructor=Phaser.ParticleStorm.Zones.Image;Phaser.ParticleStorm.Zones.Image.prototype.update=function(t){if(t===undefined){t=this.key}this.points=[];this.bmd.load(t);this.bmd.processPixelRGB(this.addPixel,this);return this};Phaser.ParticleStorm.Zones.Image.prototype.addPixel=function(t,e,i){if(t.a>this.alphaThreshold){this.points.push({x:e,y:i,color:{r:t.r,g:t.g,b:t.b,a:t.a/255}})}return false};Phaser.ParticleStorm.Zones.Image.prototype.getRandom=function(){var t=this.game.rnd.pick(this.points);t.x*=this.scale.x;t.y*=this.scale.y;return t};Phaser.ParticleStorm.Zones.Image.prototype.emit=function(t,e,i,a,r,s,n){if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var o=null;var l=null;for(var h=0;h<r;h++){o=this.game.rnd.pick(this.points);l=t.emitParticle(e,i+o.x*this.scale.x,a+o.y*this.scale.y);if(l){if(s&&o.color.a<1){l.color.alpha.value=o.color.a}if(n){l.color.setColor(o.color.r,o.color.g,o.color.b,o.color.a)}}}return l};Phaser.ParticleStorm.Zones.Image.prototype.emitFull=function(t,e,i,a,r,s,n,o){if(r===undefined){r=1}var l=1;var h=1;if(Array.isArray(s)){l=s[0];h=s[1]}else if(typeof s==="number"){l=s;h=s}if(Array.isArray(i)){i=this.game.rnd.between(i[0],i[1])}if(Array.isArray(a)){a=this.game.rnd.between(a[0],a[1])}var d=null;var c=null;for(var u=0;u<this.points.length;u+=r){d=this.points[u];var f=i+d.x*this.scale.x*(l/r);var m=a+d.y*this.scale.y*(h/r);c=t.emitParticle(e,f,m);if(c){if(n&&d.color.a<1){c.color.alpha.value=d.color.a}if(o){c.color.setColor(d.color.r,d.color.g,d.color.b,d.color.a)}}}return c};Phaser.ParticleStorm.Controls.Texture=function(t){this.particle=t;this.rnd=t.emitter.game.rnd;this.graph=Phaser.ParticleStorm.Graph;this.sendToBack=false;this.bringToTop=true;this.key=null;this.frame=undefined;this.frameName=undefined;this.scaleMode=Phaser.scaleModes.DEFAULT};Phaser.ParticleStorm.Controls.Texture.prototype={reset:function t(){this.sendToBack=false;this.bringToTop=true;this.key="__default";this.frame=undefined;this.frameName=undefined;this.scaleMode=Phaser.scaleModes.DEFAULT},init:function t(e){if(e.sendToBack){this.sendToBack=e.sendToBack}else if(e.bringToTop){this.bringToTop=e.bringToTop}if(e.image){if(Array.isArray(e.image)){this.key=this.rnd.pick(e.image)}else{this.key=e.image}}if(e.frame!==undefined){var i=e.frame;if(Array.isArray(e.frame)){i=this.rnd.pick(e.frame)}if(this.graph.isNumeric(i)){this.frame=i}else{this.frameName=i}}if(e.scaleMode){var a=e.scaleMode.toUpperCase();if(a==="LINEAR"){this.scaleMode=Phaser.scaleModes.LINEAR}else if(a==="NEAREST"){this.scaleMode=Phaser.scaleModes.NEAREST}}},step:function t(e,i){if(this.particle.emitter.renderType===Phaser.ParticleStorm.SPRITE&&e.animations!==undefined){var a=[];for(var r in e.animations){var s=e.animations[r];var n=null;var o=true;if(s.frames!==undefined){if(Array.isArray(s.frames)){n=s.frames}else{n=Phaser.Animation.generateFrameNames(s.frames.prefix,s.frames.start,s.frames.stop,s.frames.suffix,s.frames.zeroPad)}if(typeof n[0]==="string"){o=false}}var l=s.frameRate===undefined?60:s.frameRate;var h=s.loop===undefined?false:s.loop;i.animations.add(r,n,l,h,o);a.push(r)}if(a.length>0){if(e.play!==undefined){i.play(this.rnd.pick(a))}else{i.play(a[0])}}}if(this.sendToBack){i.sendToBack()}else if(this.bringToTop){i.bringToTop()}}};Phaser.ParticleStorm.Controls.Texture.prototype.constructor=Phaser.ParticleStorm.Controls.Texture;Phaser.ParticleStorm.Controls.Color=function(t){this.particle=t;this.graph=Phaser.ParticleStorm.Graph;this.red={};this.green={};this.blue={};this.alpha={};this.hsv={};this.hsvData=this.particle.emitter.parent.hsv;this.tint=0;this.isTinted=false;this.rgba="rgba(0, 0, 0, 1)";this.blendMode=this.particle.emitter.parent.blendModeMap.NORMAL};Phaser.ParticleStorm.Controls.Color.prototype={reset:function t(){this.red=Object.create(Phaser.ParticleStorm.BASE_255);this.green=Object.create(Phaser.ParticleStorm.BASE_255);this.blue=Object.create(Phaser.ParticleStorm.BASE_255);this.alpha=Object.create(Phaser.ParticleStorm.BASE_1);this.tint=16777215;this.isTinted=false;this.isHSV=false;this.hsv=Object.create(Phaser.ParticleStorm.BASE_359);this.rgba="rgba(0, 0, 0, 1)";this.blendMode=this.particle.emitter.parent.blendModeMap.NORMAL},init:function t(e){var i=false;if(e.hasOwnProperty("hsv")){if(typeof e.hsv==="number"){this.hsv.value=e.hsv}else{this.graph.fromData(e.hsv,this.hsv)}i=true;this.isHSV=true}else{if(e.hasOwnProperty("red")){if(typeof e.red==="number"){this.red.value=e.red}else{this.graph.fromData(e.red,this.red)}i=true}if(e.hasOwnProperty("green")){if(typeof e.green==="number"){this.green.value=e.green}else{this.graph.fromData(e.green,this.green)}i=true}if(e.hasOwnProperty("blue")){if(typeof e.blue==="number"){this.blue.value=e.blue}else{this.graph.fromData(e.blue,this.blue)}i=true}}if(e.hasOwnProperty("alpha")){if(typeof e.alpha==="number"){this.alpha.value=e.alpha}else{this.graph.fromData(e.alpha,this.alpha)}}this.red.value=Phaser.Math.clamp(this.red.value,0,255);this.green.value=Phaser.Math.clamp(this.green.value,0,255);this.blue.value=Phaser.Math.clamp(this.blue.value,0,255);this.alpha.value=Phaser.Math.clamp(this.alpha.value,0,1);this.hsv.value=Phaser.Math.clamp(this.hsv.value,0,359);if(this.particle.emitter.renderType!==Phaser.ParticleStorm.PIXEL){this.isTinted=i}if(e.blendMode){this.blendMode=this.particle.emitter.parent.blendModeMap[e.blendMode.toUpperCase()]}},step:function t(){var e=this.particle.life;if(this.isHSV){this.hsv.value+=this.hsv.delta;this.hsv.calc=Phaser.Math.clamp(Math.floor(this.hsv.initial+this.graph.getValue(this.hsv,e)),0,359);this.red.value=this.hsvData[this.hsv.calc].r;this.green.value=this.hsvData[this.hsv.calc].g;this.blue.value=this.hsvData[this.hsv.calc].b}else{this.red.value+=this.red.delta;this.green.value+=this.green.delta;this.blue.value+=this.blue.delta}this.red.calc=this.graph.getClampedValue(this.red,e);this.green.calc=this.graph.getClampedValue(this.green,e);this.blue.calc=this.graph.getClampedValue(this.blue,e);if(this.isTinted){this.tint=this.red.calc<<16|this.green.calc<<8|this.blue.calc}this.alpha.value+=this.alpha.delta;this.alpha.calc=Phaser.Math.clamp(this.alpha.initial+this.graph.getValue(this.alpha,e),0,1);this.rgba="rgba("+this.red.calc+","+this.green.calc+","+this.blue.calc+","+this.alpha.calc+")"},setColor:function t(e,i,a,r){this.red.value=e;this.green.value=i;this.blue.value=a;this.alpha.value=r;if(this.particle.emitter.renderType!==Phaser.ParticleStorm.PIXEL){this.isTinted=true}this.step()}};Phaser.ParticleStorm.Controls.Color.prototype.constructor=Phaser.ParticleStorm.Controls.Color;Phaser.ParticleStorm.Controls.Transform=function(t){this.particle=t;this.time=t.emitter.game.time;this.graph=Phaser.ParticleStorm.Graph;this.x=0;this.y=0;this.velocity={x:null,y:null,facing:null};this.acceleration={x:null,y:null,facing:null};this.scale={x:null,y:null};this.rotation={};this.anchor=new Phaser.Point};Phaser.ParticleStorm.Controls.Transform.prototype={reset:function t(){this.velocity.x=Object.create(Phaser.ParticleStorm.BASE);this.velocity.y=Object.create(Phaser.ParticleStorm.BASE);this.velocity.facing=Object.create(Phaser.ParticleStorm.BASE_NULL);this.acceleration.x=Object.create(Phaser.ParticleStorm.BASE);this.acceleration.y=Object.create(Phaser.ParticleStorm.BASE);this.acceleration.facing=Object.create(Phaser.ParticleStorm.BASE_NULL);this.scale.x=Object.create(Phaser.ParticleStorm.BASE_1);this.scale.y=Object.create(Phaser.ParticleStorm.BASE_1);this.rotation=Object.create(Phaser.ParticleStorm.BASE);this.anchor.set(.5)},init:function t(e,i,a){this.x=e;this.y=i;if(a.hasOwnProperty("anchor")){this.anchor.set(a.anchor)}else{if(a.hasOwnProperty("anchorX")){this.anchor.x=a.anchorX}if(a.hasOwnProperty("anchorY")){this.anchor.y=a.anchorY}}if(a.hasOwnProperty("velocity")){if(this.graph.isNumeric(a.velocity)){this.velocity.x.value=a.velocity;this.velocity.y.value=a.velocity}else if(a.velocity.hasOwnProperty("min")){this.velocity.x.value=this.graph.getMinMax(a.velocity);this.velocity.y.value=this.velocity.x.value}else if(a.velocity.radial){var r=this.graph.getMinMaxInitial(a.velocity);var s=a.velocity.radial.arcStart;var n=a.velocity.radial.arcEnd;if(s!==undefined&&n!==undefined){var o=(Math.random()*(n-s)+s)*Math.PI/180;var l=Math.sin(o);var h=-Math.cos(o);this.velocity.x.value=l*r;this.velocity.y.value=h*r}}else{this.velocity.x.initial=this.graph.getMinMaxInitial(a.velocity);this.velocity.y.initial=this.velocity.x.initial;this.velocity.x.value=this.graph.getMinMax(a.velocity.value);this.velocity.y.value=this.velocity.x.value}if(a.velocity.hasOwnProperty("delta")){this.velocity.x.delta=this.graph.getMinMax(a.velocity.delta);this.velocity.y.delta=this.velocity.x.delta}if(a.velocity.hasOwnProperty("control")){this.velocity.x.control=a.velocity.control;this.velocity.y.control=a.velocity.control}if(a.hasOwnProperty("vx")){this.graph.fromData(a.vx,this.velocity.x)}if(a.hasOwnProperty("vy")){this.graph.fromData(a.vy,this.velocity.y)}}else if(a.hasOwnProperty("target")){this.particle.target(a.target)}else{if(typeof a.vx==="number"){this.velocity.x.value=a.vx}else{this.graph.fromData(a.vx,this.velocity.x)}if(typeof a.vy==="number"){this.velocity.y.value=a.vy}else{this.graph.fromData(a.vy,this.velocity.y)}}if(typeof a.facingVelocity==="number"){this.velocity.facing.value=a.facingVelocity}else{this.graph.fromData(a.facingVelocity,this.velocity.facing)}if(typeof a.facingAcceleration==="number"){this.acceleration.facing.value=a.facingAcceleration}else{this.graph.fromData(a.facingAcceleration,this.acceleration.facing)}if(a.hasOwnProperty("acceleration")){this.graph.fromData(a.acceleration,this.acceleration.x);this.graph.fromData(a.acceleration,this.acceleration.y)}else{if(typeof a.ax==="number"){this.acceleration.x.value=a.ax}else{this.graph.fromData(a.ax,this.acceleration.x)}if(typeof a.ay==="number"){this.acceleration.y.value=a.ay}else{this.graph.fromData(a.ay,this.acceleration.y)}}if(a.hasOwnProperty("scale")){this.graph.fromData(a.scale,this.scale.x);this.graph.clone(this.scale.x,this.scale.y)}else{if(typeof a.scaleX==="number"){this.scale.x.value=a.scaleX}else{this.graph.fromData(a.scaleX,this.scale.x)}if(typeof a.scaleY==="number"){this.scale.y.value=a.scaleY}else{this.graph.fromData(a.scaleY,this.scale.y)}}if(typeof a.rotation==="number"){this.rotation.value=a.rotation}else{this.graph.fromData(a.rotation,this.rotation)}var d=this.particle.parent;if(d&&d.emit&&d.emit.inherit){this.inherit(d)}},inherit:function t(e){var t=e.emit.inherit;var i=false;if(typeof t==="boolean"){i=true}if(i||t.vx||t.velocity){this.graph.clone(e.transform.velocity.x,this.velocity.x)}if(i||t.vy||t.velocity){this.graph.clone(e.transform.velocity.y,this.velocity.y)}if(i||t.facingVelocity){this.graph.clone(e.transform.velocity.facing,this.velocity.facing)}if(i||t.scaleX||t.scale){this.graph.clone(e.transform.scale.x,this.scale.x)}if(i||t.scaleY||t.scale){this.graph.clone(e.transform.scale.y,this.scale.y)}if(i||t.rotation){this.graph.clone(e.transform.rotation,this.rotation)}if(t.angularVelocity){var a=(e.transform.rotation.initial+e.transform.rotation.value)*Math.PI/180;this.velocity.x.initial=Math.sin(a);this.velocity.y.initial=-Math.cos(a)}},step:function t(){var e=this.particle.life;this.scale.x.value+=this.scale.x.delta;this.scale.y.value+=this.scale.y.delta;this.rotation.value+=this.rotation.delta;this.rotation.calc=(this.rotation.initial+this.graph.getValue(this.rotation,e))*Math.PI/180;this.scale.x.calc=this.scale.x.initial+this.graph.getValue(this.scale.x,e);this.scale.y.calc=this.scale.y.initial+this.graph.getValue(this.scale.y,e);if(e===0){return}var i=0;var a=0;if(this.acceleration.facing.value!==null){this.acceleration.facing.value+=this.acceleration.facing.delta;i=this.rotation.calc+(90+this.acceleration.facing.offset)*Math.PI/180;a=this.acceleration.facing.initial+this.graph.getValue(this.acceleration.facing,e);this.velocity.x.value+=a*Math.sin(i);this.velocity.y.value+=a*-Math.cos(i)}this.acceleration.x.value+=this.acceleration.x.delta;this.acceleration.y.value+=this.acceleration.y.delta;this.velocity.x.value+=this.velocity.x.delta+this.acceleration.x.initial+this.graph.getValue(this.acceleration.x,e);this.velocity.y.value+=this.velocity.y.delta+this.acceleration.y.initial+this.graph.getValue(this.acceleration.y,e);if(this.velocity.facing.value!==null){this.velocity.facing.value+=this.velocity.facing.delta;i=this.rotation.calc+(90+this.velocity.facing.offset)*Math.PI/180;a=this.velocity.facing.initial+this.graph.getValue(this.velocity.facing,e);this.x+=a*Math.sin(i);this.y+=a*-Math.cos(i)}this.x+=this.velocity.x.initial+this.graph.getValue(this.velocity.x,e);this.y+=this.velocity.y.initial+this.graph.getValue(this.velocity.y,e)}};Phaser.ParticleStorm.Controls.Transform.prototype.constructor=Phaser.ParticleStorm.Controls.Transform;Phaser.ParticleStorm.Renderer={};Phaser.ParticleStorm.Renderer.Base=function(t){this.game=t.game;this.emitter=t;this.parent=t.parent;this.pixelSize=1};Phaser.ParticleStorm.Renderer.Base.prototype={addToWorld:function t(e){e.add(this.display);return this.display},preUpdate:function t(){},add:function t(){return null},update:function t(e){return e},postUpdate:function t(){},kill:function t(e){return e},destroy:function t(){this.game=null}};Phaser.ParticleStorm.Renderer.Base.prototype.constructor=Phaser.ParticleStorm.Renderer.Base;Phaser.ParticleStorm.Renderer.Sprite=function(t){Phaser.ParticleStorm.Renderer.Base.call(this,t);this.display=this.game.make.group(null,"particleStormSpriteRenderer")};Phaser.ParticleStorm.Renderer.Sprite.prototype=Object.create(Phaser.ParticleStorm.Renderer.Base.prototype);Phaser.ParticleStorm.Renderer.Sprite.prototype.constructor=Phaser.ParticleStorm.Renderer.Sprite;Phaser.ParticleStorm.Renderer.Sprite.prototype.add=function(t){var e=t.sprite;var i=t.texture.key;var a=t.texture.frame;if(a===undefined&&t.texture.frameName!==undefined){a=t.texture.frameName}if(e){e.reset(t.transform.x,t.transform.y);if(e.key!==i){e.loadTexture(i,a)}else{if(t.texture.frame!==undefined){e.frame=a}else if(t.texture.frameName!==undefined){e.frameName=a}}}else{e=this.display.create(t.transform.x,t.transform.y,i,a)}e.anchor.set(t.transform.anchor.x,t.transform.anchor.y);if(t.color.isTinted){e.tint=t.color.tint}e.blendMode=t.color.blendMode[0];e.texture.baseTexture.scaleMode=t.texture.scaleMode;e.visible=t.visible;t.sprite=e;return e};Phaser.ParticleStorm.Renderer.Sprite.prototype.update=function(t){var e=t.sprite;if(t.delay>0&&!t.delayVisible){e.visible=false;return}e.visible=t.visible;e.alpha=t.color.alpha.calc;e.rotation=t.transform.rotation.calc;if(t.color.isTinted){e.tint=t.color.tint}e.scale.setTo(t.transform.scale.x.calc,t.transform.scale.y.calc);e.x=t.transform.x;e.y=t.transform.y};Phaser.ParticleStorm.Renderer.Sprite.prototype.kill=function(t){if(t.sprite){t.sprite.kill()}};Phaser.ParticleStorm.Renderer.Sprite.prototype.destroy=function(){this.display.destroy(true);this.emitter=null;this.game=null};Phaser.ParticleStorm.Renderer.Pixel=function(t,e,i){Phaser.ParticleStorm.Renderer.Base.call(this,t);this.bmd=this.game.make.bitmapData(e,i);this.display=this.game.make.image(0,0,this.bmd);this.autoClear=true};Phaser.ParticleStorm.Renderer.Pixel.prototype=Object.create(Phaser.ParticleStorm.Renderer.Base.prototype);Phaser.ParticleStorm.Renderer.Pixel.prototype.constructor=Phaser.ParticleStorm.Renderer.Pixel;Phaser.ParticleStorm.Renderer.Pixel.prototype.resize=function(t,e){this.bmd.resize(t,e);return this};Phaser.ParticleStorm.Renderer.Pixel.prototype.clear=function(t){this.bmd.fill(0,0,0,t);this.bmd.update();return this};Phaser.ParticleStorm.Renderer.Pixel.prototype.preUpdate=function(){if(this.autoClear){this.bmd.clear();this.bmd.update()}};Phaser.ParticleStorm.Renderer.Pixel.prototype.update=function(t){if(t.delay>0&&!t.delayVisible){return}var e=Math.floor(t.transform.x);var i=Math.floor(t.transform.y);var a=t.color.red.calc;var r=t.color.green.calc;var s=t.color.blue.calc;var n=Math.floor(t.color.alpha.calc*255);if(this.pixelSize>2){this.bmd.rect(e,i,this.pixelSize,this.pixelSize,t.color.rgba)}else{this.bmd.setPixel32(e,i,a,r,s,n,false);if(this.pixelSize===2){this.bmd.setPixel32(e+1,i,a,r,s,n,false);this.bmd.setPixel32(e,i+1,a,r,s,n,false);this.bmd.setPixel32(e+1,i+1,a,r,s,n,false)}}};Phaser.ParticleStorm.Renderer.Pixel.prototype.postUpdate=function(){if(this.pixelSize<=2){this.bmd.context.putImageData(this.bmd.imageData,0,0)}this.bmd.dirty=true};Phaser.ParticleStorm.Renderer.Pixel.prototype.destroy=function(){this.game=null;this.display.destroy();this.bmd.destroy()};Phaser.ParticleStorm.Renderer.BitmapData=function(t,e,i){Phaser.ParticleStorm.Renderer.Base.call(this,t);this.bmd=this.game.make.bitmapData(e,i);this.display=this.game.make.image(0,0,this.bmd);this.roundPx=true;this.autoClear=true};Phaser.ParticleStorm.Renderer.BitmapData.prototype=Object.create(Phaser.ParticleStorm.Renderer.Base.prototype);Phaser.ParticleStorm.Renderer.BitmapData.prototype.constructor=Phaser.ParticleStorm.Renderer.BitmapData;Phaser.ParticleStorm.Renderer.BitmapData.prototype.resize=function(t,e){this.bmd.resize(t,e);return this};Phaser.ParticleStorm.Renderer.BitmapData.prototype.clear=function(t){this.bmd.fill(0,0,0,t);return this};Phaser.ParticleStorm.Renderer.BitmapData.prototype.preUpdate=function(){if(this.autoClear){this.bmd.clear()}};Phaser.ParticleStorm.Renderer.BitmapData.prototype.update=function(t){if(t.delay>0&&!t.delayVisible){return}var e=t.transform;this.bmd.copy(t.texture.key,0,0,null,null,e.x,e.y,null,null,e.rotation.calc,e.anchor.x,e.anchor.y,e.scale.x.calc,e.scale.y.calc,t.color.alpha.calc,t.color.blendMode[1],this.roundPx)};Phaser.ParticleStorm.Renderer.BitmapData.prototype.destroy=function(){this.game=null;this.display.destroy();this.bmd.destroy()};Phaser.ParticleStorm.Renderer.RenderTexture=function(t,e,i){Phaser.ParticleStorm.Renderer.Base.call(this,t);this.renderTexture=this.game.make.renderTexture(e,i);this.display=this.game.make.image(0,0,this.renderTexture);this.stamp=this.game.make.image(0,0);this.autoClear=true};Phaser.ParticleStorm.Renderer.RenderTexture.prototype=Object.create(Phaser.ParticleStorm.Renderer.Base.prototype);Phaser.ParticleStorm.Renderer.RenderTexture.prototype.constructor=Phaser.ParticleStorm.Renderer.RenderTexture;Phaser.ParticleStorm.Renderer.RenderTexture.prototype.clear=function(){this.renderTexture.clear()};Phaser.ParticleStorm.Renderer.RenderTexture.prototype.preUpdate=function(){if(this.autoClear){this.renderTexture.clear()}};Phaser.ParticleStorm.Renderer.RenderTexture.prototype.update=function(t){if(t.delay>0&&!t.delayVisible||!t.visible||t.color.alpha.calc===0){return}var e=t.texture.key;var i=t.texture.frame;if(i===undefined&&t.texture.frameName!==undefined){i=t.texture.frameName}if(this.stamp.key!==e){this.stamp.loadTexture(e,i)}else{if(t.texture.frame!==undefined){this.stamp.frame=i}else if(t.texture.frameName!==undefined){this.stamp.frameName=i}}this.stamp.anchor.set(t.transform.anchor.x,t.transform.anchor.y);this.stamp.alpha=t.color.alpha.calc;this.stamp.rotation=t.transform.rotation.calc;if(t.color.isTinted){this.stamp.tint=t.color.tint}this.stamp.blendMode=t.color.blendMode[0];this.stamp.texture.baseTexture.scaleMode=t.texture.scaleMode;this.stamp.scale.setTo(t.transform.scale.x.calc,t.transform.scale.y.calc);this.renderTexture.renderXY(this.stamp,t.transform.x,t.transform.y,false)};Phaser.ParticleStorm.Renderer.RenderTexture.prototype.destroy=function(){this.display.destroy();this.stamp.destroy();this.renderTexture.destroy();this.emitter=null;this.game=null};Phaser.ParticleStorm.Renderer.SpriteBatch=function(t){Phaser.ParticleStorm.Renderer.Base.call(this,t);this.display=this.game.make.spriteBatch()};Phaser.ParticleStorm.Renderer.SpriteBatch.prototype=Object.create(Phaser.ParticleStorm.Renderer.Base.prototype);Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.constructor=Phaser.ParticleStorm.Renderer.SpriteBatch;Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.add=function(t){var e=t.sprite;var i=t.texture.key;var a=t.texture.frame;if(a===undefined&&t.texture.frameName!==undefined){a=t.texture.frameName}if(e){e.reset(t.transform.x,t.transform.y);if(e.key!==i){e.loadTexture(i,a)}else{if(t.texture.frame!==undefined){e.frame=a}else if(t.texture.frameName!==undefined){e.frameName=a}}}else{e=this.game.make.sprite(t.transform.x,t.transform.y,i,a)}this.display.addChild(e);e.anchor.set(t.transform.anchor.x,t.transform.anchor.y);if(t.color.isTinted){e.tint=t.color.tint}e.blendMode=t.color.blendMode[0];e.texture.baseTexture.scaleMode=t.texture.scaleMode;e.visible=t.visible;t.sprite=e;return e};Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.update=function(t){var e=t.sprite;if(t.delay>0&&!t.delayVisible){e.visible=false;return}e.visible=t.visible;e.alpha=t.color.alpha.calc;e.rotation=t.transform.rotation.calc;if(t.color.isTinted){e.tint=t.color.tint}e.scale.setTo(t.transform.scale.x.calc,t.transform.scale.y.calc);e.x=t.transform.x;e.y=t.transform.y};Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.kill=function(t){if(t.sprite){t.sprite.kill()}};Phaser.ParticleStorm.Renderer.SpriteBatch.prototype.destroy=function(){this.display.destroy(true);this.emitter=null;this.game=null}},992:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(299);var r=_(a);var s=i(955);var n=_(s);var o=i(300);var l=_(o);var h=i(956);var d=_(h);var c=i(993);var u=_(c);var f=i(8);var m=_(f);var p=i(31);var g=_(p);var S=i(17);var y=_(S);var v=i(27);var b=_(v);var P=i(21);var x=_(P);function _(t){return t&&t.__esModule?t:{default:t}}var T=null;var C={STANDARD_DIMENSIONS:{x:1024,y:768},DEV_MODE:false,DEMO_MODE:false,FULL_SCREEN:true,ASSETS:{CDN_CUSTOM:STATIC_URL+"exp/monster_attack/",NON_CDN_CUSTOM:n.default.getStaticUrl()+"exp/monster_attack/"},BG_EXTEND:10,PLAY_SFX:true,SHAKE_CAMERA_FX:true,DISPLAY_SCORE:false,MAX_GAME_DELAY:15,WPM_UPPER_BOUND:70,failedPreloads:[]};C.BootState=function(){};C.BootState.prototype={init:function t(e){T=(0,b.default)(profile.language);this.env=e;this.scale.scaleMode=d.default.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;C.DEMO_MODE=this.env.demo||false},preload:function t(){this.load.crossOrigin=n.default.getCrossOrigin();this.load.image("preloadBar",n.default.GameUtil.ASSETS.CDN_SHARED+"img/progress.png")},create:function t(){this.game.stage.backgroundColor="#2f86bc";this.state.start("Game.PreloadState",true,false,this.env)}};C.PreloadState=function(){};C.PreloadState.prototype={init:function t(e){n.default.GameUtil.init(this);this.env=e;this.load.crossOrigin=n.default.getCrossOrigin()},updateLoader:function t(){this.loadingText.text=T.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},preload:function t(){this.preloadBar=this.add.sprite(this.game.world.centerX-this.cache.getImage("preloadBar").width/2,this.game.world.centerY,"preloadBar");this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,T.t("Loading Game (0 %)"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){this.updateLoader()}.bind(this));this.load.onFileError.add(function(t,e){C.failedPreloads.push({key:t,file:e})}.bind(this));this.load.setPreloadSprite(this.preloadBar);n.default.GameUtil.loadSharedAssets.call(this);this.load.image("bg",C.ASSETS.CDN_CUSTOM+"img/sky-gradient.png");this.load.image("bg-landscape",C.ASSETS.CDN_CUSTOM+"img/bg-landscape.png");this.load.image("bg-rock",C.ASSETS.CDN_CUSTOM+"img/bg-rock.png");this.load.image("clouds",C.ASSETS.CDN_CUSTOM+"img/clouds.png");this.load.image("fog",C.ASSETS.CDN_CUSTOM+"img/fog.png");this.load.image("mountains-left",C.ASSETS.CDN_CUSTOM+"img/mountains-left.png");this.load.image("mountains-middle",C.ASSETS.CDN_CUSTOM+"img/mountains-middle.png");this.load.image("mountains-right",C.ASSETS.CDN_CUSTOM+"img/mountains-right.png");this.load.atlasJSONHash("ninja",C.ASSETS.CDN_CUSTOM+"img/ninja.png",C.ASSETS.NON_CDN_CUSTOM+"img/ninja.json");this.load.atlasJSONHash("monster",C.ASSETS.CDN_CUSTOM+"img/monster.png",C.ASSETS.NON_CDN_CUSTOM+"img/monster.json");this.load.spritesheet("object-alectuary",C.ASSETS.CDN_CUSTOM+"img/object-alectuary.png",36,33,1);this.load.spritesheet("object-carrot",C.ASSETS.CDN_CUSTOM+"img/object-carrot.png",20,46,1);this.load.spritesheet("object-cone",C.ASSETS.CDN_CUSTOM+"img/object-cone.png",28,43,1);this.load.spritesheet("object-f-key",C.ASSETS.CDN_CUSTOM+"img/object-f-key.png",31,29,1);this.load.spritesheet("object-j-key",C.ASSETS.CDN_CUSTOM+"img/object-j-key.png",31,30,1);this.load.spritesheet("object-magicpot",C.ASSETS.CDN_CUSTOM+"img/object-magicpot.png",36,33,1);this.load.spritesheet("object-pepper",C.ASSETS.CDN_CUSTOM+"img/object-pepper.png",28,30,1);this.load.spritesheet("object-plunger",C.ASSETS.CDN_CUSTOM+"img/object-plunger.png",21,50,1);this.load.spritesheet("object-pumpkin",C.ASSETS.CDN_CUSTOM+"img/object-pumpkin.png",36,33,1);this.load.spritesheet("object-skull",C.ASSETS.CDN_CUSTOM+"img/object-skull.png",29,32,1);this.load.spritesheet("object-watermelon",C.ASSETS.CDN_CUSTOM+"img/object-watermelon.png",36,34,1);this.load.spritesheet("square",C.ASSETS.CDN_CUSTOM+"img/square.png",68,68,1);this.load.spritesheet("swoosh1",C.ASSETS.CDN_CUSTOM+"img/swoosh_01.png",46,79,1);this.load.spritesheet("swoosh2",C.ASSETS.CDN_CUSTOM+"img/swoosh_02.png",88,88,1);this.load.spritesheet("swoosh3",C.ASSETS.CDN_CUSTOM+"img/swoosh_03.png",41,86,1);this.load.spritesheet("swoosh4",C.ASSETS.CDN_CUSTOM+"img/swoosh_04.png",29,65,1);if(C.PLAY_SFX){}},create:function t(){if(!(0,g.default)(C.failedPreloads)){this.state.start("Game.FallBackPreloadState",true,false,this.env,C)}else{this.state.start("Game.MainState",true,false,this.env)}}};C.FallBackPreloadState=s.FallBackPreloadState;C.MainState=function(){this.ninja=null;this.monster=null;this.healthBar=null;this.bgSky=null;this.bg=null;this.swooshes=[];this.cloudSpeed=.5;this.defaultObjectAlpha=.8;this.ninjaStartPosition={x:null,y:null};this.monsterStartPosition={x:null,y:null};this.ninjaDefaultFrame=12;this.monsterDefaultFrame=15;this.currentWordObjs=[];this.currentWordCursor=0;this.currentSquare=null;this.latestProgressStat=0;this.gamePace=null;this.gameState={started:false,lost:false};this.fadeObjectCache=[];this.killObjectCache=[];this.startingText=null;this.gameOverText=null;this.params={ninjaMonsterTouchingDistance:40,ninjaMonsterAdvanceDistance:300,advanceAmount:5,ninjaMonsterWithdrawDistance:150,withdrawAmount:2,monsterPushBackRate:null,monsterAdvanceRate:null};this.currentObjectInHand=null;this.soundEffects={impact1:null,impact2:null};this.showVirtualKeyboard=false;this.gameTime=1;if(C.DEV_MODE){window.game=this}};C.MainState.prototype={init:function t(e){n.default.GameUtil.init(this);this.env=e;this.showVirtualKeyboard=e.typing.allow_vkeyboard;var i=this.core=new r.default({lesson_id:e.id,text:e.typing.text,on_error:"block",max_secs:e.typing.max_secs,deletable:false,i18n:T});if(C.PLAY_SFX&&profile.keyboard_sfx){this.soundfx=new l.default.SoundFX(this.core,x.default.root,!profile.keyboard_sfx)}if(this.showVirtualKeyboard){n.default.GameUtil.mountVirtualKeyboard.call(this,"bottom",false)}i.events.on("end",function(t){t.game_lost=this.gameState.lost;this.end_stats=t;if(!this.gameState.lost){this.youWin()}}.bind(this));i.events.on("abort",function(){this.gameState.lost=true;this.youLose(false)}.bind(this));i.events.on("word_changed",function(t){if(t.next_word.length>9)return this.core.skip_current_word();i.jump_focus(t.next_word[0]);this.showWord(t.next_word)}.bind(this));this.core.events.on("keydown",function(t){if(t.deadkey)return;if(!this.ninja._state.hasEntered){return}if(t.is_valid){this.refreshWord();if(!this.gameState.started){n.default.GameUtil.hideStartingText.call(this)}this.throwObject();this.currentObjectInHand=this.createRandomObject();this.killObjectCache.push(this.currentObjectInHand)}else{this.wrongKeyTypedEffect()}}.bind(this));this.ninjaStartPosition.x=this.game.width/2-150;this.ninjaStartPosition.y=this.game.height-280;this.monsterStartPosition.x=this.game.width/2+100;this.monsterStartPosition.y=this.game.height-280;this.game.time.events.loop(2*d.default.Timer.SECOND,this.updateGameTime,this);this.gamePace=Math.min(C.WPM_UPPER_BOUND,e.typing.goal_wpm);this.updateDifficultyParams()},preload:function t(){},create:function t(){if(C.DEV_MODE){this.time.advancedTiming=true}this.bg=this.add.tileSprite(-C.BG_EXTEND,-C.BG_EXTEND,this.game.width+C.BG_EXTEND,this.game.height+C.BG_EXTEND,"bg");this.fadeObjectCache.push(this.bg);this.bg.scale.setTo(1,Math.ceil(this.game.height/this.cache.getImage("bg").height));this.bg.fixedToCamera=true;this.mountainsLeft=this.add.sprite(0,this.game.height-50,"mountains-left");this.mountainsLeft.anchor.setTo(0,1);this.mountainsLeft.alpha=.8;this.mountainsLeft.fixedToCamera=true;this.fadeObjectCache.push(this.mountainsLeft);this.mountainsMiddle=this.add.sprite(this.game.width/2,this.game.height-100,"mountains-middle");this.mountainsMiddle.anchor.setTo(.5,1);this.mountainsMiddle.fixedToCamera=true;this.fadeObjectCache.push(this.mountainsMiddle);this.mountainsRight=this.add.sprite(this.game.width,this.game.height-100,"mountains-right");this.mountainsRight.anchor.setTo(1,1);this.mountainsRight.fixedToCamera=true;this.fadeObjectCache.push(this.mountainsRight);this.bgLandscape=this.add.sprite(this.game.width,this.game.height,"bg-landscape");this.bgLandscape.anchor.setTo(1,1);this.bgLandscape.fixedToCamera=true;this.fadeObjectCache.push(this.bgLandscape);this.clouds=this.add.tileSprite(0,this.game.height-this.cache.getImage("clouds").height,this.game.width,this.cache.getImage("clouds").height,"clouds");this.clouds.tileScale.x=1;this.clouds.tileScale.y=1;this.clouds.alpha=1;this.bgRock=this.add.sprite(this.game.width/2-70,this.game.height,"bg-rock");this.bgRock.anchor.setTo(.5,1);this.bgRock.fixedToCamera=true;this.fadeObjectCache.push(this.bgRock);var e=2;this.fog=this.add.tileSprite(0,this.game.height-this.cache.getImage("fog").height*e+100,this.game.width,this.cache.getImage("fog").height*e,"fog");this.fog.scale.setTo(e);this.fog.alpha=.7;this.ninja=this.add.sprite(this.ninjaStartPosition.x,this.ninjaStartPosition.y-300,"ninja");this.ninja.anchor.setTo(.5);this.ninja.scale.setTo(.75);this.ninja.alpha=0;this.ninja._state={monsterTouching:false,hasEntered:false};this.killObjectCache.push(this.ninja);this.ninja.frame=this.ninjaDefaultFrame;var i=this.ninja.animations.add("ninja-throw",d.default.Animation.generateFrameNames("throw/ninja_throw_",1,6,".png",2),30,true);i.onComplete.add(function(t,e){if(!this.gameState.started){this.gameState.started=true;this.createMonsterHealthBar()}this.ninja.frame=this.ninjaDefaultFrame;this.currentObjectInHand.alpha=this.defaultObjectAlpha},this);var a=this.ninja.animations.add("ninja-land",d.default.Animation.generateFrameNames("land/ninja-land_",1,12,".png",2),30,true);a.onComplete.add(function(){this.ninja.frame=this.ninjaDefaultFrame},this);this.monster=this.add.sprite(this.monsterStartPosition.x,this.monsterStartPosition.y,"monster");this.monster.anchor.setTo(.2,.8);this.monster.scale.setTo(.6);this.monster._state={isFalling:false};this.monster.frame=this.monsterDefaultFrame;var r=this.monster.animations.add("monster-hit",d.default.Animation.generateFrameNames("hit/",1,12,".png",2),30,true);r.onComplete.add(function(t,e){if(!this.monster._state.isFalling){this.monster.animations.play("monster-walking",20,true)}},this);var s=this.monster.animations.add("monster-walking",d.default.Animation.generateFrameNames("walking/",1,19,".png",2),20,true);var o=this.monster.animations.add("monster-falling",d.default.Animation.generateFrameNames("falling/",1,15,".png",2),20,true);o.onComplete.add(function(){this.game.time.events.add(250,this.monsterFall,this)},this);this.createSwooshLibrary();n.default.GameUtil.createWPMCountObj.call(this);core.events.on("stats_update",function(t){if(t.wpm>250){return}this.wpmText.text=t.wpm;this.latestProgressStat=Math.round(t.progress*100)}.bind(this));n.default.GameUtil.createStartingText.call(this,T.t("Type words as they appear"));this.game.time.events.add(500,this.ninjaEntrance,this);if(C.PLAY_SFX){}},update:function t(){this.clouds.tilePosition.x-=this.cloudSpeed;this.fog.tilePosition.x-=.5*this.cloudSpeed;if(this.gameState.lost){return}if(this.gameState.started&&!this.monster._state.isFalling){this.monster.position.x-=this.params.monsterAdvanceRate}var e=this.getMonsterDistanceToEdge();if(!this.monster._state.isFalling&&this.isMonsterOnEdge(e)){this.monster._state.isFalling=true;this.core.end_lesson();this.youWin()}if(!this.ninja._state.monsterTouching&&this.isMonsterTouchingNinja()){this.gameState.lost=true;this.core.end_lesson();this.core.detach_capture();this.ninja._state.monsterTouching=true;this.add.tween(this.currentObjectInHand).to({alpha:[0]},200,d.default.Easing.Quadratic.In,true);this.healthBar.kill();this.killObjectCache.push(this.monster);this.ninjaFall()}else{if(this.isMonsterFarEnoughToAdvance()&&!this.monster._state.isFalling){this.advanceNinja()}if(!this.isNinjaOnEdge()&&this.isMonsterTooClose()){this.withdrawNinja()}}if(this.gameState.started&&this.healthBar){this.updateHealthBar(e)}},shutdown:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}},render:function t(){if(C.DEV_MODE){this.game.debug.text("FPS: "+this.time.fps,50,50,"#00ff00")}},updateGameTime:function t(){if(this.gameState.started&&this.gameTime<C.MAX_GAME_DELAY){this.gameTime+=1;this.updateDifficultyParams()}},restartGame:function t(){x.default.refresh()},updateDifficultyParams:function t(){var e=this.gameTime/C.MAX_GAME_DELAY;this.params.monsterPushBackRate=350/this.gamePace*e;this.params.monsterAdvanceRate=this.gamePace/80*e},createMonsterHealthBar:function t(){var e=this.calculateHealthBarPosition();var i={x:e.x,y:e.y,width:100,height:10,bg:{color:"rgba(0, 0, 0, 0.1)"},bar:{color:"rgba(255, 255, 255, 0.7)"}};this.healthBar=new u.default(this.game,i)},calculateHealthBarPosition:function t(){return{x:this.monster.position.x+50,y:this.monster.position.y-170}},getHealthValue:function t(e){var i=e>200?100-Math.round(e/2.8):100-this.latestProgressStat;return i},updateHealthBar:function t(e){this.healthBar.setPercent(this.getHealthValue(e));var i=this.calculateHealthBarPosition();this.healthBar.setPosition(i.x,i.y)},wrongKeyTypedEffect:function t(){this.currentSquare.anchor.setTo(.5,.5);this.add.tween(this.currentSquare.scale).to({x:[1.3,1.6,1.3],y:[1.3,1.6,1.3]},100,d.default.Easing.Linear.None,true)},showWord:function t(e){if(this.currentWordObjs.length){this.removeWord()}this.currentWordObjs=[];var i=e.length;var a=90;var r=(this.game.width-a*(i-1))/2;for(var s in e){(function(t){var e=this.add.sprite(r,this.game.height/7,"square");r+=a;e.anchor.setTo(.5);e.scale.setTo(1.3);e.alpha=.6;this.addTextNodeToSquare(e,t.chr);this.currentWordObjs.push({square:e,char_obj:t});this.killObjectCache.push(e)}).bind(this)(e[s])}this.refreshWord()},addTextNodeToSquare:function t(e,i){var a=this.add.text(0,5,i,{font:"50px monospace",fill:"#111",align:"center"});a.anchor.setTo(.5,.5);a.scale.x=1;a.scale.y=1;e.addChild(a)},refreshWord:function t(){for(var e=0;e<this.currentWordObjs.length;e++){var i=this.currentWordObjs[e];var a=i.square;var r=i.char_obj;if(r.dirty){a.scale.setTo(1.1);a.alpha=.1}else{if(this.core.cur_char==r){this.currentSquare=a;a.scale.setTo(1.3);a.alpha=1}else{a.scale.setTo(1.1);a.alpha=.6}}}},removeWord:function t(){for(var e in this.currentWordObjs){if(this.currentWordObjs[e].square){this.currentWordObjs[e].square.destroy()}}},createSwooshLibrary:function t(){var e=null;var i=["swoosh1","swoosh2","swoosh3","swoosh4"];for(var a in i){e=this.add.sprite(0,0,i[a]);e.alpha=0;e.anchor.setTo(.5);this.swooshes.push(e)}},showSwoosh:function t(e,i){var a=[0,1];var r=1;var s={x:0,y:0};switch(i){default:case"hit":a=[0,1];s={x:0,y:0};r=1.5;break;case"back-wave":a=[2,3];s={x:60,y:0};r=1.2;break}var n=a[Math.floor(Math.random()*a.length)];var o=this.swooshes[n];o.position.x=e.x+s.x;o.position.y=e.y+s.y;o.scale.setTo(r);this.add.tween(o).to({alpha:[1,0]},150,d.default.Easing.Quadratic.Out,true)},createRandomObject:function t(){var e=[{name:"object-alectuary",offset:{x:-23,y:0,angle:0}},{name:"object-cone",offset:{x:-53,y:-25,angle:160}},{name:"object-carrot",offset:{x:-30,y:-20,angle:-20}},{name:"object-f-key",offset:{x:-38,y:-5,angle:0}},{name:"object-j-key",offset:{x:-38,y:-5,angle:0}},{name:"object-magicpot",offset:{x:-45,y:-8,angle:0}},{name:"object-pepper",offset:{x:-50,y:0,angle:80}},{name:"object-plunger",offset:{x:-45,y:-10,angle:160}},{name:"object-pumpkin",offset:{x:-42,y:-12,angle:0}},{name:"object-skull",offset:{x:-35,y:-20,angle:-30}},{name:"object-watermelon",offset:{x:-30,y:-15,angle:0}}];var i=e[Math.floor(Math.random()*e.length)];var a={x:this.ninja.position.x+i.offset.x,y:this.ninja.position.y+i.offset.y};var r=this.add.sprite(a.x,a.y,i.name);r.anchor.setTo(.8,.5);r.scale.setTo(1.3);r.alpha=0;r.angle=i.offset.angle;return r},throwObject:function t(){if(this.monster._state.isFalling){return}var e={x:this.ninja.position.x+0,y:this.ninja.position.y-10};var i={x:this.monster.position.x-0,y:this.monster.position.y-n.default.getRandomOfList([20,50,80])};var a=this.currentObjectInHand;a.alpha=this.defaultObjectAlpha;this.killObjectCache.push(a);this.ninja.animations.stop("ninja-throw");this.ninja.animations.play("ninja-throw",30,false);var r={x:[e.x,i.x],y:[e.y,i.y]};this.showSwoosh({x:e.x,y:e.y},"back-wave");this.add.tween(a).to({x:r.x,y:r.y,angle:[0,-360]},500*this.getDistanceCoefficient(),d.default.Easing.Linear.None,true).interpolation(function(t,e){return d.default.Math.bezierInterpolation(t,e)}).onComplete.add(function(){this.showSwoosh(i,"hit");this.monster.animations.stop("monster-hit");this.monster.animations.play("monster-hit",50,false);this.pushMonster();this.bounceOff(a)}.bind(this))},bounceOff:function t(e){var i={x:e.position.x,y:e.position.y};var a={x:e.position.x-200,y:this.game.height*1.5};var r={x:i.x-100,y:n.default.getRandomInt(100,200)};this.add.tween(e).to({x:[i.x,r.x,a.x],y:[i.y,r.y,a.y],angle:[0,180],alpha:[.8,.3]},800,d.default.Easing.Quadratic.Out,true).interpolation(function(t,e){return d.default.Math.bezierInterpolation(t,e)}).onComplete.add(function(){e.destroy()})},ninjaEntrance:function t(){this.ninja.animations.play("ninja-land",45,false);this.add.tween(this.ninja).to({alpha:[.7,1],y:[this.ninjaStartPosition.y-300,this.ninjaStartPosition.y]},200,d.default.Easing.Quadratic.In,true).interpolation(function(t,e){return d.default.Math.bezierInterpolation(t,e)}).onComplete.add(function(){this.currentObjectInHand=this.createRandomObject();this.currentObjectInHand.alpha=this.defaultObjectAlpha;this.ninja._state.hasEntered=true;this.core.attach_capture();x.default.events.on("unload",function(){this.core.detach_capture()}.bind(this));if(C.SHAKE_CAMERA_FX){this.camera.shake(.005,100,true,d.default.Camera.SHAKE_VERTICAL,true)}}.bind(this))},monsterFall:function t(){this.add.tween(this.monster).to({y:[this.monster.position.y,this.game.height+100],angle:[20,120]},500,d.default.Easing.Quadratic.In,true).onComplete.add(function(){n.default.GameUtil.createGameWinningScreen.call(this);this.ninja.alpha=0;this.currentObjectInHand.alpha=0}.bind(this))},ninjaFall:function t(){this.add.tween(this.ninja).to({y:[this.ninja.position.y,this.game.height+100],angle:[0,-360]},700,d.default.Easing.Linear.None,true).onComplete.add(function(){this.youLose(true)}.bind(this))},advanceNinja:function t(){this.ninja.position.x+=this.params.advanceAmount;this.currentObjectInHand.position.x+=this.params.advanceAmount},withdrawNinja:function t(){this.ninja.position.x-=this.params.withdrawAmount;this.currentObjectInHand.position.x-=this.params.withdrawAmount},pushMonster:function t(){var e=this.monster.position.x;var i=this.monster.position.x+this.params.monsterPushBackRate;if(C.SHAKE_CAMERA_FX){this.camera.shake(.001,100,true,d.default.Camera.SHAKE_BOTH,true)}this.add.tween(this.monster).to({x:[e,i,i-5]},100,d.default.Easing.Quadratic.Out,true)},getMonsterDistance:function t(){return Math.abs(this.monster.position.x-this.ninja.position.x)},isMonsterTouchingNinja:function t(){return this.getMonsterDistance()<=this.params.ninjaMonsterTouchingDistance},isMonsterFarEnoughToAdvance:function t(){return this.getMonsterDistance()>=this.params.ninjaMonsterAdvanceDistance},isMonsterTooClose:function t(){return this.getMonsterDistance()<=this.params.ninjaMonsterWithdrawDistance},getDistanceCoefficient:function t(){return this.getMonsterDistance()/800},getMonsterDistanceToEdge:function t(){var e=Math.round(this.monster.position.x-this.game.width/2);return e},isMonsterOnEdge:function t(e){var i=280;if(!e){return this.getMonsterDistanceToEdge()>i}else{return e>i}},isNinjaOnEdge:function t(){return Math.round(this.ninja.position.x-this.game.width/2)<-360},submitScores:function t(e){if(C.DEMO_MODE){return}y.default.postTypingResults(this.end_stats,function(t){if(e){x.default.goto_url(t)}else{n.default.GameUtil.createGiveUpButton.call(this,t)}}.bind(this))},killMonster:function t(){this.healthBar.kill();this.monster.animations.play("monster-falling",20,false)},runPreEndingScreenTasks:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}var e=true;var i=false;var a=undefined;try{for(var r=this.fadeObjectCache[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var o=s.value;this.add.tween(o).to({alpha:.5},500,d.default.Easing.Linear.None,true,0,0)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}var l=true;var h=false;var c=undefined;try{for(var u=this.killObjectCache[Symbol.iterator](),f;!(l=(f=u.next()).done);l=true){var m=f.value;m.destroy()}}catch(t){h=true;c=t}finally{try{if(!l&&u.return){u.return()}}finally{if(h){throw c}}}},youWin:function t(){this.monster._state.isFalling=true;this.killMonster();this.runPreEndingScreenTasks()},youLose:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.spacebar=this.game.input.keyboard.addKey(d.default.Keyboard.SPACEBAR);this.spacebar.onDown.add(function(){this.restartGame()},this);this.runPreEndingScreenTasks();this.monster.destroy();this.healthBar.kill();n.default.GameUtil.createGameLosingScreen.call(this,e)},playSound:function t(e){if(C.PLAY_SFX){}}};function w(t){var e={width:C.STANDARD_DIMENSIONS.x,height:C.STANDARD_DIMENSIONS.y};if(C.FULL_SCREEN){e=n.default.getWindowDimensions();(0,m.default)(".game-normal").removeClass("game-normal").addClass("game-fullscreen")}var i=new d.default.Game(e.width,e.height,d.default.CANVAS,"game",null,false,true);i.state.add("Game.BootState",C.BootState);i.state.add("Game.PreloadState",C.PreloadState);i.state.add("Game.FallBackPreloadState",C.FallBackPreloadState);i.state.add("Game.MainState",C.MainState);i.state.start("Game.BootState",true,false,t);x.default.events.on("unload",function(){i.load.hasLoaded=true;i.load.reset(true,true);i.state.destroy();i.destroy()})}e.default=n.default.wrapGameWithHeader(w)},993:function(t,e,i){var a=function t(e,i){this.game=e;this.setupConfiguration(i);this.setPosition(this.config.x,this.config.y);this.drawBackground();this.drawHealthBar();this.setFixedToCamera(this.config.isFixedToCamera)};a.prototype.constructor=a;a.prototype.setupConfiguration=function(t){this.config=this.mergeWithDefaultConfiguration(t);this.flipped=this.config.flipped};a.prototype.mergeWithDefaultConfiguration=function(t){var e={width:250,height:40,x:0,y:0,bg:{color:"#651828"},bar:{color:"#FEFF03"},animationDuration:200,flipped:false,isFixedToCamera:false};return r(e,t)};function r(t,e){for(var i in e){try{t[i]=e[i].constructor==Object?r(t[i],e[i]):e[i]}catch(a){t[i]=e[i]}}return t}a.prototype.drawBackground=function(){var t=this.game.add.bitmapData(this.config.width,this.config.height);t.ctx.fillStyle=this.config.bg.color;t.ctx.beginPath();t.ctx.rect(0,0,this.config.width,this.config.height);t.ctx.fill();this.bgSprite=this.game.add.sprite(this.x,this.y,t);this.bgSprite.anchor.set(.5);if(this.flipped){this.bgSprite.scale.x=-1}};a.prototype.drawHealthBar=function(){var t=this.game.add.bitmapData(this.config.width,this.config.height);t.ctx.fillStyle=this.config.bar.color;t.ctx.beginPath();t.ctx.rect(0,0,this.config.width,this.config.height);t.ctx.fill();this.barSprite=this.game.add.sprite(this.x-this.bgSprite.width/2,this.y,t);this.barSprite.anchor.y=.5;if(this.flipped){this.barSprite.scale.x=-1}};a.prototype.setPosition=function(t,e){this.x=t;this.y=e;if(this.bgSprite!==undefined&&this.barSprite!==undefined){this.bgSprite.position.x=t;this.bgSprite.position.y=e;this.barSprite.position.x=t-this.config.width/2;this.barSprite.position.y=e}};a.prototype.setPercent=function(t){if(t<0)t=0;if(t>100)t=100;var e=t*this.config.width/100;this.setWidth(e)};a.prototype.setWidth=function(t){if(this.flipped){t=-1*t}this.game.add.tween(this.barSprite).to({width:t},this.config.animationDuration,Phaser.Easing.Linear.None,true)};a.prototype.setFixedToCamera=function(t){this.bgSprite.fixedToCamera=t;this.barSprite.fixedToCamera=t};a.prototype.kill=function(){this.bgSprite.kill();this.barSprite.kill()};t.exports=a},994:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(299);var r=T(a);var s=i(955);var n=T(s);var o=i(300);var l=T(o);var h=i(956);var d=T(h);var c=i(8);var u=T(c);var f=i(31);var m=T(f);var p=i(461);var g=T(p);var S=i(12);var y=T(S);var v=i(298);var b=i(27);var P=T(b);var x=i(21);var _=T(x);function T(t){return t&&t.__esModule?t:{default:t}}var C=null;var w={STANDARD_DIMENSIONS:{x:1024,y:768},DEV_MODE:false,DEMO_MODE:false,FULL_SCREEN:true,ASSETS:{CDN_CUSTOM:STATIC_URL+"exp/temple_bash/",NON_CDN_CUSTOM:n.default.getStaticUrl()+"exp/temple_bash/"},BG_EXTEND:10,SHAKE_CAMERA_FX:true,PLAY_SFX:true,DISPLAY_SCORE:false,DIFFICULTY_LEVEL:"normal",GIVEN_LIVES:3,failedPreloads:[]};w.BootState=function(){};w.BootState.prototype={init:function t(e){C=(0,P.default)(profile.language);this.env=e;this.scale.scaleMode=d.default.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;w.DEMO_MODE=this.env.demo||false},preload:function t(){this.load.crossOrigin=n.default.getCrossOrigin();this.load.image("preloadBar",n.default.GameUtil.ASSETS.CDN_SHARED+"img/progress.png")},create:function t(){this.game.stage.backgroundColor="#2f86bc";this.state.start("Game.PreloadState",true,false,this.env)}};w.PreloadState=function(){};w.PreloadState.prototype={init:function t(e){n.default.GameUtil.init(this);this.env=e},updateLoader:function t(){this.loadingText.text=C.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},preload:function t(){var e=this;this.preloadBar=this.add.sprite(this.game.world.centerX-this.cache.getImage("preloadBar").width/2,this.game.world.centerY,"preloadBar");this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,C.t("Loading Game (0 %)"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){e.updateLoader()});this.load.onFileError.add(function(t,e){w.failedPreloads.push({key:t,file:e})});this.load.setPreloadSprite(this.preloadBar);n.default.GameUtil.loadSharedAssets.call(this);this.load.image("bg",w.ASSETS.CDN_CUSTOM+"img/sky-gradient.png");this.load.image("bg-mountain",w.ASSETS.CDN_CUSTOM+"img/bg-mountain.png");this.load.image("ground-left",w.ASSETS.CDN_CUSTOM+"img/ground-left.png");this.load.image("ground-right",w.ASSETS.CDN_CUSTOM+"img/ground-right.png");this.load.image("ground-gradient",w.ASSETS.CDN_CUSTOM+"img/ground-gradient.png");this.load.image("cloud1",w.ASSETS.CDN_CUSTOM+"img/cloud_01.png");this.load.image("cloud2",w.ASSETS.CDN_CUSTOM+"img/cloud_02.png");this.load.image("cloud3",w.ASSETS.CDN_CUSTOM+"img/cloud_03.png");this.load.image("balloon1",w.ASSETS.CDN_CUSTOM+"img/balloon_01.png");this.load.image("balloon2",w.ASSETS.CDN_CUSTOM+"img/balloon_02.png");this.load.image("balloon3",w.ASSETS.CDN_CUSTOM+"img/balloon_03.png");this.load.image("pot1",w.ASSETS.CDN_CUSTOM+"img/pot_01.png");this.load.image("pot2",w.ASSETS.CDN_CUSTOM+"img/pot_02.png");this.load.image("pot3",w.ASSETS.CDN_CUSTOM+"img/pot_03.png");this.load.image("pot4",w.ASSETS.CDN_CUSTOM+"img/pot_04.png");this.load.image("pot-top",w.ASSETS.CDN_CUSTOM+"img/pot-top.png");this.load.image("pot-shadows",w.ASSETS.CDN_CUSTOM+"img/pot-shadows.png");this.load.image("leaf1",w.ASSETS.CDN_CUSTOM+"img/leaf_01.png");this.load.image("leaf2",w.ASSETS.CDN_CUSTOM+"img/leaf_02.png");this.load.image("leaf3",w.ASSETS.CDN_CUSTOM+"img/leaf_03.png");this.load.image("leaf4",w.ASSETS.CDN_CUSTOM+"img/leaf_04.png");this.load.image("baby-bird-1",w.ASSETS.CDN_CUSTOM+"img/bird-baby_01.png");this.load.image("baby-bird-2",w.ASSETS.CDN_CUSTOM+"img/bird-baby_02.png");this.load.spritesheet("bird",w.ASSETS.CDN_CUSTOM+"img/bird.png",94,94,6);this.load.spritesheet("flag",w.ASSETS.CDN_CUSTOM+"img/flag.png",100,102,6);this.load.image("stone",w.ASSETS.CDN_CUSTOM+"img/stone.png");this.load.image("swoosh",w.ASSETS.CDN_CUSTOM+"img/swoosh.png");this.load.image("wrong",w.ASSETS.CDN_CUSTOM+"img/wrong.png");this.load.spritesheet("chars-count",w.ASSETS.CDN_CUSTOM+"img/chars-count-icon.png",45,54,1);this.load.image("ninja-life",w.ASSETS.CDN_CUSTOM+"img/ninja-life-small.png");this.load.atlas("colors",w.ASSETS.CDN_CUSTOM+"img/colorsSD.png",w.ASSETS.NON_CDN_CUSTOM+"img/colorsSD.json");this.load.spritesheet("caps-arrow",w.ASSETS.CDN_CUSTOM+"img/caps-arrow.png",18,20,1);this.load.atlas("balloon-fragments",w.ASSETS.CDN_CUSTOM+"img/balloon-fragments.png",w.ASSETS.NON_CDN_CUSTOM+"img/balloon-fragments.json");this.load.atlasJSONHash("ninja-hit",w.ASSETS.CDN_CUSTOM+"img/ninja-hit-optimized.png",w.ASSETS.NON_CDN_CUSTOM+"img/ninja-hit.json");this.load.atlasJSONHash("monster-sling",w.ASSETS.CDN_CUSTOM+"img/monster-sling-optimized.png",w.ASSETS.NON_CDN_CUSTOM+"img/monster-sling.json");this.load.image("string",w.ASSETS.CDN_CUSTOM+"img/string.png");if(w.PLAY_SFX&&profile.keyboard_sfx){this.load.audio("impact2",w.ASSETS.CDN_CUSTOM+"audio/impact-02.mp3")}},create:function t(){if(!(0,m.default)(w.failedPreloads)){this.state.start("Game.FallBackPreloadState",true,false,this.env,w)}else{this.state.start("Game.MainState",true,false,this.env)}}};w.FallBackPreloadState=s.FallBackPreloadState;w.MainState=function(){this.ninja=null;this.manager=null;this.emitter=null;this.gameState={started:false,lost:false};this.params={};this.clouds=[];this.cloudSpeedRatio=2;this.balloons=[];this.strings=[];this.currentStone=null;this.currentPosition=null;this.fadeObjectCache=[];this.killObjectCache=[];this.lifeIcons=[];this.lostLifeIcons=[];this.charsRemaining=0;this.charsCountText=null;this.currentLetters=[];this.currentArrow=null;this.currentTextIndex=0;if(w.DEV_MODE){window.game=this}this.soundEffects={};this.showVirtualKeyboard=false;this.spots=[{centerOffset:{x:-225,y:-120},active:false},{centerOffset:{x:-112,y:-120},active:false},{centerOffset:{x:0,y:-120},active:false},{centerOffset:{x:112,y:-120},active:false},{centerOffset:{x:225,y:-120},active:false}];this.viewOnlyMode=profile.is_basic&&window.is_tp};w.MainState.prototype={init:function t(e){var i=this;n.default.GameUtil.init(this);this.env=e;this.typingText=this.env.typing.text.replace(/\s/g,"");this.showVirtualKeyboard=e.typing.allow_vkeyboard;var a=this.core=new r.default({lesson_id:e.id,text:this.typingText,on_error:"block",max_secs:e.typing.max_secs,deletable:false,i18n:C});this.initGameDifficulty(e);if(this.showVirtualKeyboard){n.default.GameUtil.mountVirtualKeyboard.call(this,"top")}a.events.on("end",function(t){t.game_lost=i.gameState.lost;i.end_stats=t;if(i.gameState.lost){i.showGameOver()}else{i.showYouWin()}});a.events.on("abort",function(){i.gameState.lost=true;i.showGameOver(false)});a.events.on("keydown",function(t){if(t.deadkey)return;if(i.gameState.lost||!i.gameState.readyForKey){return}if(t.is_valid){if(i.currentPositionAttackTween){i.currentPositionAttackTween.stop()}if(!i.gameState.started){i.gameState.started=true;n.default.GameUtil.hideStartingText.call(i)}i.animateNinja();i.updateCharCount();i.showLetter(i.typingText[i.currentTextIndex++])}else{i.wrongEffect()}});a.events.on("stats_update",function(t){if(t.wpm>250){return}});if(!this.viewOnlyMode){this.core.attach_capture()}_.default.events.on("unload",function(){a.detach_capture()});this.charsRemaining=this.typingText.length;this.updateCharCount();if(w.PLAY_SFX&&profile.keyboard_sfx){this.soundfx=new l.default.SoundFX(this.core,_.default.root,!profile.keyboard_sfx)}},preload:function t(){},create:function t(){if(this.viewOnlyMode){(0,v.LaunchStudentPlansModal)(null,_.default.next_lesson,"temple_bash")}if(w.DEV_MODE){this.time.advancedTiming=true}this.manager=this.game.plugins.add(d.default.ParticleStorm);this.createBackgroundElements();this.createGroundElements();this.createLayers();this.createClouds(false,4);this.createBalloons();this.createNinja();this.createLittleMonsters();this.createPots();this.createFlag();this.createBirds();this.createLeaves();this.showLetter(this.typingText[this.currentTextIndex++]);this.createBalloonPopEffect();n.default.GameUtil.createStartingText.call(this,C.t("Type letter to begin"));this.createSwoosh();this.createWrong();this.createLifeIcons();this.createLifeIconEffect();this.createCharsCount();if(w.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects.impact2=this.game.add.audio("impact2")}this.gameState.readyForKey=true},update:function t(){this.updateClouds()},updateClouds:function t(){var e=this.game.width+270;for(var i in this.clouds){var a=this.clouds[i];if(a&&a.position){if(a.position.x>e){a.position.x=-270;a=this.randomizeCloud(a)}else{a.position.x+=a._speed*this.cloudSpeedRatio}}}},shutdown:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}},render:function t(){if(w.DEV_MODE&&!this.gameState.lost){this.game.debug.text("FPS: "+this.time.fps,50,50,"#00ff00")}},initGameDifficulty:function t(e){if(e.typing.goal_wpm<10){w.DIFFICULTY_LEVEL="supereasy"}else if(e.typing.goal_wpm<20){w.DIFFICULTY_LEVEL="easy"}else if(e.typing.goal_wpm<30){w.DIFFICULTY_LEVEL="normal"}else if(e.typing.goal_wpm<40){w.DIFFICULTY_LEVEL="hard"}else if(e.typing.goal_wpm<50){w.DIFFICULTY_LEVEL="difficult"}else{w.DIFFICULTY_LEVEL="insane"}},createBackgroundElements:function t(){var e=this.add.tileSprite(-w.BG_EXTEND,-w.BG_EXTEND,this.game.width+w.BG_EXTEND,this.game.height+w.BG_EXTEND,"bg");e.scale.setTo(1,Math.ceil(this.game.height/this.cache.getImage("bg").height));e.fixedToCamera=true},createGroundElements:function t(){var e=5;var i=this.cache.getImage("ground-gradient").height;var a=this.cache.getImage("bg-mountain").height;var r=this.cache.getImage("ground-right").height;var s=this.cache.getImage("ground-right").width;var n=this.cache.getImage("ground-left").height;this.add.sprite(0,this.game.height-a-i,"bg-mountain");this.add.tileSprite(0,this.game.height-i+e,this.game.width,i,"ground-gradient");this.add.sprite(0,this.game.height-n+e,"ground-left");this.add.sprite(this.game.width-s,this.game.height-r+e,"ground-right")},createSwoosh:function t(){var e=this.game.width/2;var i=this.game.height/2;var a=this.add.sprite(e,i,"swoosh");a.alpha=0;this.swoosh=a;this.killObjectCache.push(a)},createWrong:function t(){var e=this.game.width/2;var i=this.game.height/2;var a=this.add.sprite(e,i,"wrong");a.anchor.setTo(.5);a.alpha=0;this.wrong=a},returnToDefaultPosition:function t(){this.ninja.frame=0;this.ninja.position.x=this.ninjaDefaultPosition.x;this.ninja.position.y=this.ninjaDefaultPosition.y},animateNinja:function t(){this.ninja.animations.stop();var e=this.getCurrentActiveSpot();this.ninja.animations.play("ninja-hit-"+e,30,false)},hitStartTriggers:function t(){this.animateLeaf();this.shakeCamera();this.swooshEffect();this.bigBird.animations.play("flap",15,false,false)},swooshEffect:function t(){var e=this.getCurrentActiveSpot();var i=this.spots[e-1];var a=this.swoosh;var r=this.game.width/2+i.centerOffset.x-75;var s=this.game.height+i.centerOffset.y-140;a.position.x=r;a.position.y=s;this.add.tween(a).to({alpha:[0,.5,.9,0]},150,d.default.Easing.Quadratic.InOut,true)},wrongEffect:function t(){var e=this.getCurrentActiveSpot();var i=this.spots[e-1];var a=this.wrong;a.bringToTop();var r=this.game.width/2+i.centerOffset.x;var s=this.game.height+i.centerOffset.y;a.position.x=r;a.position.y=s;this.add.tween(a).to({alpha:[0,.7,.7,0]},250,d.default.Easing.Linear.None,true)},updateCharCount:function t(){if(this.charsCountText){this.charsCountText.setText(--this.charsRemaining)}},animateLeaf:function t(){var e=[0,-10,0,-5,0,-3,0];var i=[0,10,0,5,0,3,0];var a=400;this.add.tween(this.leaf1).to({angle:e},a,d.default.Easing.Linear.None,true);this.add.tween(this.leaf2).to({angle:e},a,d.default.Easing.Linear.None,true);this.add.tween(this.leaf3).to({angle:i},a,d.default.Easing.Linear.None,true);this.add.tween(this.leaf4).to({angle:e},a,d.default.Easing.Linear.None,true)},repositionLittleMonster:function t(e,i){var a=15;var r=10;this.currentPosition=e;this.monsterLeft.animations.stop(false,false);this.monsterCenter.animations.stop(false,false);this.monsterRight.animations.stop(false,false);this.monsterLeft.alpha=0;this.monsterLeft.angle=0;this.monsterCenter.alpha=0;this.monsterCenter.angle=0;this.monsterRight.alpha=0;this.monsterRight.angle=0;var s=this.game.width/2+i.centerOffset.x;var n=this.game.height+i.centerOffset.y+40;var o=null;var l=0;switch(e){default:case 1:o=this.monsterLeft;l=-r;break;case 2:o=this.monsterLeft;l=-a;break;case 3:o=this.monsterCenter;break;case 4:o=this.monsterRight;l=a;break;case 5:o=this.monsterRight;l=r;break}o.position.x=s;o.position.y=n;o.alpha=1;var h=this.add.tween(o).to({y:[n,n,n,n,n-90],angle:[0,0,0,0,0,0,l]},this.getCurrentDifficulty().monsterAppearSpeed,d.default.Easing.Quadratic.InOut,true,0);h.onComplete.add(function(t){switch(t._which){case"left":t.animations.play("monster-sling-left",30,false);break;case"right":t.animations.play("monster-sling-right",30,false);break;case"center":default:t.animations.play("monster-sling-center",30,false);break}});this.currentPositionAttackTween=h},getCurrentDifficulty:function t(){var e=1e3;switch(w.DIFFICULTY_LEVEL){case"supereasy":e=2e3;break;case"easy":e=1500;break;case"normal":default:e=1e3;break;case"hard":e=750;break;case"difficult":e=500;break;case"insane":e=300;break}return{monsterAppearSpeed:e}},createBalloonPopEffect:function t(){var e={lifespan:400,image:"balloon-fragments",blendMode:"NORMAL",frame:["piece01","piece02","piece03","piece04","piece05"],scale:{min:.2,max:.3},vx:{min:-15,max:15},vy:{min:-5,max:15},alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("balloon-pop",e);this.emitter=this.manager.createEmitter(d.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},runBalloonPopEffect:function t(e){this.emitter.emit("balloon-pop",e.position.x,e.position.y,{total:20})},shakeCamera:function t(){if(w.SHAKE_CAMERA_FX){this.camera.shake(.005,100,true,d.default.Camera.SHAKE_VERTICAL,true)}},activateSpot:function t(e){for(var i in this.spots){this.spots[i].active=false}this.spots[e-1].active=true},getCurrentActiveSpot:function t(){for(var e in this.spots){if(this.spots[e].active){return parseInt(e)+1}}return null},showLetter:function t(e){var i=this.currentLetters.shift();if(i){i.destroy();if(this.currentArrow){this.currentArrow.destroy()}}var a=n.default.getRandomInt(1,5);this.activateSpot(a);var r=this.spots[a-1];if(this.gameState.started){this.repositionLittleMonster(a,r)}if(y.default.isUpperCase(e)){var s=this.add.sprite(this.game.width/2+r.centerOffset.x-45,this.game.height+r.centerOffset.y-15,"caps-arrow");s.alpha=.7;this.currentArrow=s}var o=this.add.text(this.game.width/2+r.centerOffset.x,this.game.height+r.centerOffset.y,e,{font:"80px monospace",fill:"#fff",align:"center"});o.anchor.setTo(.5,.5);o.scale.x=1;o.scale.y=1;o.alpha=0;this.currentLetters.push(o);this.add.tween(o).to({alpha:[0,1]},100,d.default.Easing.Linear.None,true,0)},createCharsCount:function t(){var e=this.game.height-85;if(y.default.isIOS){e-=50}var i=this.add.sprite(this.game.width-170,e,"chars-count");i.anchor.setTo(.5,.5);i.scale.setTo(.7);i.fixedToCamera=true;this.charsCountObj=i;this.killObjectCache.push(i);this.addTextNodeToCharsCount(this.charsCountObj)},addTextNodeToCharsCount:function t(e){var i=this.add.text(70,0,this.charsRemaining,{font:"50px Helvetica Neue",fontWeight:100,fill:"#fff",stroke:"#70bbcd",align:"center"});this.charsCountText=i;i.anchor.setTo(.5,.5);i.scale.x=1;i.scale.y=1;e.addChild(i)},createClouds:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var a=this.game.height/3;var r=this.game.height/6;var s=this.game.width/i;for(var o=0;o<i;o++){var l=this.cloudsLayer.create(e?-250:n.default.getRandomInt(1,i+1)*s,a+.25*n.default.getRandomOfList([-4,-3,-2,-1,0,1,2,3,4])*r,this.getCloudAlias());l.anchor.setTo(.5);l=this.randomizeCloud(l);this.clouds.push(l)}},randomizeCloud:function t(e){e.alpha=n.default.getRandomOfList([1,.8,.9]);e.scale.setTo(n.default.getRandomOfList([1,1.1,.8,1,1.25]));e._speed=n.default.getRandomOfList([.1,.08,.12,.1]);return e},createLayers:function t(){this.cloudsLayer=this.game.add.group();this.balloonStringsLayer=this.game.add.group();this.balloonsLayer=this.game.add.group();this.ninjaLayer=this.game.add.group();this.potBackLayer=this.game.add.group();this.littleMonsterLayer=this.game.add.group();this.potFrontLayer=this.game.add.group()},createBalloons:function t(){this.createStrings();var e=this.game.width/2;var i=this.game.height/2;var a=-120;var r=0;var s=75;this.balloon1=this.balloonsLayer.create(e+r-s,i+a,"balloon1");this.balloon2=this.balloonsLayer.create(e+r+s,i+a,"balloon2");this.balloon3=this.balloonsLayer.create(e+r,i+a-50,"balloon3");this.balloon1.anchor.setTo(.5);this.balloon2.anchor.setTo(.5);this.balloon3.anchor.setTo(.5);this.balloons.push(this.balloon3);this.balloons.push(this.balloon2);this.balloons.push(this.balloon1);this.killObjectCache.push(this.balloon1);this.killObjectCache.push(this.balloon2);this.killObjectCache.push(this.balloon3)},createStrings:function t(){var e=this.game.height;var i=this.game.width/2;var a=e/2;var r=8;var s=55;var n=80;var o=20;if(e>1e3){o=50}else if(e>800){o=40}else if(e>600){o=30}this.string1=this.balloonStringsLayer.create(i-s,a-n,"string");this.string2=this.balloonStringsLayer.create(i+s,a-n,"string");this.string3=this.balloonStringsLayer.create(i,a-n-50,"string");this.string1.scale.setTo(1.25,o);this.string1.anchor.setTo(0);this.string1.alpha=.5;this.string1.angle=-r;this.string2.scale.setTo(1.25,o);this.string2.anchor.setTo(0);this.string2.alpha=.5;this.string2.angle=r;this.string3.scale.setTo(1.25,o);this.string3.anchor.setTo(0);this.string3.alpha=.5;this.string3.angle=0;this.strings.push(this.string3);this.strings.push(this.string2);this.strings.push(this.string1);this.killObjectCache.push(this.string1);this.killObjectCache.push(this.string2);this.killObjectCache.push(this.string3)},burstBalloon:function t(){var e=this.balloons.pop();var i=this.strings.pop();if(e){e.destroy();this.runBalloonPopEffect(e)}if(i){i.destroy()}if(this.balloons.length===0){this.gameState.lost=true;this.core.end_lesson();this.showGameOver()}else{}},createLifeIcons:function t(){var e=this.game.height-60;if(y.default.isIOS){e-=50}for(var i=0;i<w.GIVEN_LIVES;i++){var a=this.add.sprite(this.game.width-((i+1)*34+20)-60,e,"ninja-life");a.scale.setTo(.8);a.angle=20;a.fixedToCamera=true;this.lifeIcons.push(a);this.killObjectCache.push(a)}},createLifeIconEffect:function t(){var e={lifespan:500,image:"colors",blendMode:"ADD",frame:["blue","green","red","white","yellow"],scale:{min:.2,max:.3},vx:{min:-2,max:2},vy:{min:-2,max:2},alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("basic",e);this.emitter=this.manager.createEmitter(d.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},hideLifeIcons:function t(){for(var e in this.lifeIcons){if(this.lifeIcons[e]){this.lifeIcons[e].kill()}}for(var i in this.lostLifeIcons){if(this.lostLifeIcons[i]){this.lostLifeIcons[i].kill()}}},takeLife:function t(){this.camera.shake(.001,100,true,d.default.Camera.SHAKE_BOTH,true);this.playSound("impact2");var e=this.lifeIcons.pop();e.tint=0;e.alpha=.3;this.lostLifeIcons.push(e);this.emitter.emit("basic",e.position.x+10,e.position.y+25,{total:20})},createNinja:function t(){var e=this;this.ninjaDefaultPosition={x:this.game.width/2+15,y:this.game.height-115};this.ninja=this.ninjaLayer.create(this.ninjaDefaultPosition.x,this.ninjaDefaultPosition.y,"ninja-hit");this.ninja.anchor.setTo(.5,1);this.killObjectCache.push(this.ninja);var i=this.ninja.animations.add("ninja-default",d.default.Animation.generateFrameNames("default/",1,1,".png",2),30,true);var a=this.ninja.animations;var r=[a.add("ninja-hit-1",d.default.Animation.generateFrameNames("pos1/",1,4,".png",2),30,true),a.add("ninja-hit-2",d.default.Animation.generateFrameNames("pos2/",1,7,".png",2),30,true),a.add("ninja-hit-3",d.default.Animation.generateFrameNames("pos3/",1,7,".png",2),30,true),a.add("ninja-hit-4",d.default.Animation.generateFrameNames("pos4/",1,8,".png",2),30,true),a.add("ninja-hit-5",d.default.Animation.generateFrameNames("pos5/",1,8,".png",2),30,true)];r.forEach(function(t){t.onStart.add(e.hitStartTriggers,e);t.onComplete.add(e.returnToDefaultPosition,e)})},createPots:function t(){var e=this.game.width/2;var i=this.cache.getImage("pot-shadows").width;var a=70;var r=112;var s=this.potBackLayer.create(e+15,this.game.height-65,"pot-shadows");s.anchor.setTo(.5,1);this.killObjectCache.push(s);for(var n=1,o=-2;n<=5;n++,o++){var l=this.potFrontLayer.create(e-o*r,this.game.height-a,"pot"+(n%4+1));l.anchor.setTo(.5,1);var h=this.potBackLayer.create(e-o*r,this.game.height-a-112,"pot-top");h.anchor.setTo(.5,1);this.killObjectCache.push(l);this.killObjectCache.push(h)}},createLittleMonsters:function t(){var e=this;var i=this.game.width/2;var a=this.game.height-80;this.monsterLeft=this.littleMonsterLayer.create(i-100,a,"monster-sling");this.monsterLeft.frame=8;this.monsterLeft.anchor.setTo(.4,1);this.monsterLeft.alpha=0;this.monsterLeft._which="left";var r=this.monsterLeft.animations.add("monster-sling-left",d.default.Animation.generateFrameNames("side/",1,11,".png",2),30,true);this.killObjectCache.push(this.monsterLeft);r.onComplete.add(function(){var t=e.createStone();t.alpha=1;e.animateProjectile(t)});this.monsterCenter=this.littleMonsterLayer.create(i,a,"monster-sling");this.monsterCenter.frame=0;this.monsterCenter.anchor.setTo(.5,1);this.monsterCenter.alpha=0;this.monsterCenter._which="center";var s=this.monsterCenter.animations.add("monster-sling-center",d.default.Animation.generateFrameNames("front/",1,8,".png",2),30,true);this.killObjectCache.push(this.monsterCenter);s.onComplete.add(function(){var t=e.createStone();t.alpha=1;e.animateProjectile(t)});this.monsterRight=this.littleMonsterLayer.create(i+100,a,"monster-sling");this.monsterRight.frame=8;this.monsterRight.anchor.setTo(.4,1);this.monsterRight.scale.setTo(-1,1);this.monsterRight.alpha=0;this.monsterRight._which="right";var n=this.monsterRight.animations.add("monster-sling-right",d.default.Animation.generateFrameNames("side/",1,11,".png",2),30,true);this.killObjectCache.push(this.monsterRight);n.onComplete.add(function(){var t=e.createStone();t.alpha=1;e.animateProjectile(t)})},animateProjectile:function t(e){var i=this;if(!this.gameState.lost){this.add.tween(e).to({x:[e.position.x,(0,g.default)(this.balloons).position.x],y:[e.position.y,(0,g.default)(this.balloons).position.y]},200,d.default.Easing.Cubic.Out,true,0).onComplete.add(function(){i.burstBalloon();i.takeLife();e.destroy()})}},createFlag:function t(){var e=this.flag=this.add.sprite(this.game.width-56,this.game.height-357,"flag");e.anchor.setTo(.5);e.frame=0;e.scale.setTo(.75);e.animations.add("flap");e.animations.play("flap",10,true,false)},createBirds:function t(){this.add.sprite(35,this.game.height-180,"baby-bird-1");this.add.sprite(80,this.game.height-160,"baby-bird-2");var e=this.bigBird=this.add.sprite(110,this.game.height-235,"bird");e.anchor.setTo(.5);e.frame=0;e.scale.setTo(-1,1);e.animations.add("flap")},createLeaves:function t(){var e=this.game.width/2;this.leaf1=this.add.sprite(e-273,this.game.height-142,"leaf1");this.leaf1.anchor.setTo(1,1);this.killObjectCache.push(this.leaf1);this.leaf2=this.add.sprite(e-164,this.game.height-98,"leaf2");this.leaf2.anchor.setTo(1,1);this.killObjectCache.push(this.leaf2);this.leaf3=this.add.sprite(e-65,this.game.height-150,"leaf3");this.leaf3.anchor.setTo(0,0);this.killObjectCache.push(this.leaf3);this.leaf4=this.add.sprite(e+163,this.game.height-106,"leaf4");this.leaf4.anchor.setTo(0,1);this.killObjectCache.push(this.leaf4)},createStone:function t(){var e=this.currentPosition;if(this.currentStone){this.currentStone.destroy()}var i=0;switch(e){case 1:case 2:i=20;break;case 3:i=0;break;case 4:case 5:i=-20;break}var a=this.spots[e-1];var r=this.game.width/2+a.centerOffset.x+i;var s=this.game.height+a.centerOffset.y-115;var n=this.add.sprite(r,s,"stone");n.scale.setTo(.5);n.alpha=0;this.currentStone=n;return n},getCloudAlias:function t(){return n.default.getRandomOfList(["cloud1","cloud2","cloud3"])},runPreEndingScreenTasks:function t(){if(this.showVirtualKeyboard){n.default.GameUtil.unmountVirtualKeyboard.call(this)}var e=true;var i=false;var a=undefined;try{for(var r=this.fadeObjectCache[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var o=s.value;this.add.tween(o).to({alpha:.5},500,d.default.Easing.Linear.None,true,0,0)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}var l=true;var h=false;var c=undefined;try{for(var u=this.killObjectCache[Symbol.iterator](),f;!(l=(f=u.next()).done);l=true){var m=f.value;m.destroy()}}catch(t){h=true;c=t}finally{try{if(!l&&u.return){u.return()}}finally{if(h){throw c}}}for(var p in this.clouds){var g=this.clouds[p];this.add.tween(g).to({alpha:.2},500,d.default.Easing.Linear.None,true,0,0)}for(var S in this.currentLetters){var y=this.currentLetters[S];if(y&&y.destroy){y.destroy()}}},showYouWin:function t(){this.runPreEndingScreenTasks();n.default.GameUtil.createGameWinningScreen.call(this)},showGameOver:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.runPreEndingScreenTasks();this.spacebar=this.game.input.keyboard.addKey(d.default.Keyboard.SPACEBAR);this.spacebar.onDown.add(function(){this.restartGame()},this);n.default.GameUtil.createGameLosingScreen.call(this,e)},submitScores:function t(e){var i=this;if(w.DEMO_MODE){return}api.postTypingResults(this.end_stats,function(t){if(e){_.default.goto_url(t)}else{n.default.GameUtil.createGiveUpButton.call(i,t)}})},restartGame:function t(){_.default.refresh()},playSound:function t(e){if(w.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects[e].play()}}};function E(t){var e={width:w.STANDARD_DIMENSIONS.x,height:w.STANDARD_DIMENSIONS.y};if(w.FULL_SCREEN){e=n.default.getWindowDimensions();(0,u.default)(".game-normal").removeClass("game-normal").addClass("game-fullscreen")}var i=new d.default.Game(e.width,e.height,d.default.CANVAS,"game",null,false,true);i.state.add("Game.BootState",w.BootState);i.state.add("Game.PreloadState",w.PreloadState);i.state.add("Game.FallBackPreloadState",w.FallBackPreloadState);i.state.add("Game.MainState",w.MainState);i.state.start("Game.BootState",true,false,t);_.default.events.on("unload",function(){i.load.hasLoaded=true;i.load.reset(true,true);i.state.destroy();i.destroy()})}e.default=n.default.wrapGameWithHeader(E)},995:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(299);var r=L(a);var s=i(959);var n=L(s);var o=i(955);var l=L(o);var h=i(300);var d=L(h);var c=i(956);var u=L(c);var f=i(8);var m=L(f);var p=i(31);var g=L(p);var S=i(55);var y=L(S);var v=i(953);var b=L(v);var P=i(946);var x=L(P);var _=i(147);var T=L(_);var C=i(12);var w=L(C);var E=i(298);var O=i(27);var M=L(O);var A=i(21);var D=L(A);function L(t){return t&&t.__esModule?t:{default:t}}var N=null;var B={STANDARD_DIMENSIONS:{x:1024,y:768},DEV_MODE:false,DEMO_MODE:false,FULL_SCREEN:true,ASSETS:{CDN_CUSTOM:STATIC_URL+"exp/floating_bubbles/",NON_CDN_CUSTOM:l.default.getStaticUrl()+"exp/floating_bubbles/"},BG_EXTEND:10,SHAKE_CAMERA_FX:true,PLAY_SFX:true,USE_BLUR:false,BUBBLE_FX:true,DISPLAY_SCORE:false,DIFFICULTY_LEVEL:"normal",GIVEN_LIVES:5,TOTAL_LANES:12,failedPreloads:[]};B.BootState=function(){};B.BootState.prototype={init:function t(e){N=(0,M.default)(profile.language);this.env=e;this.scale.scaleMode=u.default.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;B.DEMO_MODE=this.env.demo||false},preload:function t(){this.load.crossOrigin=l.default.getCrossOrigin();this.load.image("preloadBar",l.default.GameUtil.ASSETS.CDN_SHARED+"img/progress.png")},create:function t(){this.game.stage.backgroundColor="#2f86bc";this.state.start("Game.PreloadState",true,false,this.env)}};B.PreloadState=function(){};B.PreloadState.prototype={init:function t(e){l.default.GameUtil.init(this);this.env=e},updateLoader:function t(){this.loadingText.text=N.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},preload:function t(){this.preloadBar=this.add.sprite(this.game.world.centerX-this.cache.getImage("preloadBar").width/2,this.game.world.centerY,"preloadBar");this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,N.t("Loading Game (0 %)"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){this.updateLoader()}.bind(this));this.load.onFileError.add(function(t,e){B.failedPreloads.push({key:t,file:e})}.bind(this));this.load.setPreloadSprite(this.preloadBar);l.default.GameUtil.loadSharedAssets.call(this);this.load.image("bg",B.ASSETS.CDN_CUSTOM+"img/sky-gradient.png");this.load.image("main-cloud",B.ASSETS.CDN_CUSTOM+"img/main-cloud.png");this.load.image("fog",B.ASSETS.CDN_CUSTOM+"img/fog.png");this.load.image("cloud1",B.ASSETS.CDN_CUSTOM+"img/cloud_01.png");this.load.image("cloud2",B.ASSETS.CDN_CUSTOM+"img/cloud_02.png");this.load.image("cloud3",B.ASSETS.CDN_CUSTOM+"img/cloud_03.png");this.load.image("monster-glasses",B.ASSETS.CDN_CUSTOM+"img/monster-glasses.png");this.load.image("monster-hair",B.ASSETS.CDN_CUSTOM+"img/monster-hair.png");this.load.atlasJSONHash("little-monster",B.ASSETS.CDN_CUSTOM+"img/floating-monster.png",B.ASSETS.NON_CDN_CUSTOM+"img/floating-monster.json");this.load.image("ninja-bottom",B.ASSETS.CDN_CUSTOM+"img/ninja-bottom.png");this.load.atlasJSONHash("ninja-head",B.ASSETS.CDN_CUSTOM+"img/ninja-dart-head.png",B.ASSETS.NON_CDN_CUSTOM+"img/ninja-dart-head.json");this.load.atlasJSONHash("ninja-body",B.ASSETS.CDN_CUSTOM+"img/ninja-dart-body.png",B.ASSETS.NON_CDN_CUSTOM+"img/ninja-dart-body.json");this.load.spritesheet("bubble",B.ASSETS.CDN_CUSTOM+"img/bubble.png",112,112,1);this.load.image("stone",B.ASSETS.CDN_CUSTOM+"img/stone.png");this.load.image("ninja-life",B.ASSETS.CDN_CUSTOM+"img/ninja-life-small.png");this.load.atlas("colors",B.ASSETS.CDN_CUSTOM+"img/colorsSD.png",B.ASSETS.NON_CDN_CUSTOM+"img/colorsSD.json");this.load.atlas("bubble-fragments",B.ASSETS.CDN_CUSTOM+"img/bubble-fragments.png",B.ASSETS.NON_CDN_CUSTOM+"img/bubble-fragments.json");if(B.USE_BLUR){this.load.script("filterX",B.ASSETS.CDN_CUSTOM+"filters/BlurX.js");this.load.script("filterY",B.ASSETS.CDN_CUSTOM+"filters/BlurY.js")}if(B.PLAY_SFX&&profile.keyboard_sfx){this.load.audio("pop",B.ASSETS.CDN_CUSTOM+"audio/pop.mp3")}},create:function t(){if(!(0,g.default)(B.failedPreloads)){this.state.start("Game.FallBackPreloadState",true,false,this.env,B)}else{this.state.start("Game.MainState",true,false,this.env)}}};B.FallBackPreloadState=o.FallBackPreloadState;B.MainState=function(){this.manager=null;this.ninja=null;this.cloudSpeed=.5;this.bg=null;this.bubbles=[];this.dummyBubbles=[];this.tempBubbles=[];this.fadeObjectCache=[];this.killObjectCache=[];this.lanes=null;this.lifeIcons=[];this.lostLifeIcons=[];this.rateOfDummyBubbles=1/30;this.difficultyParams=null;this.cloudDefaultPosition=null;this.currentlySelectedBubble=null;this.bubbleTextTypedColor="rgba(255, 255, 255, 0.2)";this.bubbleTextDefaultColor="rgba(255, 255, 255, 1)";this.gameState={started:false,lost:false};this.clouds=[];this.cloudSpeedRatio=2;if(B.DEV_MODE){window.game=this}this.soundEffects={pop:null,softPop:null};this.viewOnlyMode=profile.is_basic&&window.is_tp};B.MainState.prototype={init:function t(e){l.default.GameUtil.init(this);this.env=e;this.initGameDifficulty(e);var i=this.core=new r.default({lesson_id:e.id,text:e.typing.text,on_error:"block",max_secs:e.typing.max_secs,deletable:false,i18n:N});var a=this.coreWords=new n.default(i);i.events.on("end",function(t){t.game_lost=this.gameState.lost;this.end_stats=t;if(!this.gameState.lost){this.youWin()}}.bind(this));a.events.on("change",function(t){var e=true;var i=false;var a=undefined;try{for(var r=t.matches[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;var o=this.findBubbleByWordObj(n);this.runBubblePopEffect(o.sprite);this.updateBubbleText(o)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}if(t.focus){this.currentlySelectedBubble=this.findBubbleByWordObj(t.focus).sprite}var l=true;var h=false;var d=undefined;try{for(var c=t.rejected_words[Symbol.iterator](),u;!(l=(u=c.next()).done);l=true){var f=u.value;var m=this.findBubbleByWordObj(f);this.updateBubbleText(m)}}catch(t){h=true;d=t}finally{try{if(!l&&c.return){c.return()}}finally{if(h){throw d}}}}.bind(this));a.events.on("word_complete",function(t){var e=this.findBubbleByWordObj(t.word);this.killBubbleText(e);if(e){this.popBubble(e);this.generateBubble()}}.bind(this));this.cloudDefaultPosition={x:-5,y:this.game.height/2+150};if(!this.viewOnlyMode){this.core.attach_capture()}D.default.events.on("unload",function(){this.core.detach_capture()}.bind(this));this.spacebar=this.game.input.keyboard.addKey(u.default.Keyboard.SPACEBAR);this.spacebar.onDown.add(function(){if(this.gameState.lost){this.restartGame()}else if(!this.gameState.started){this.startGame()}},this);if(B.PLAY_SFX&&profile.keyboard_sfx){this.soundfx=new d.default.SoundFX(this.core,D.default.root,!profile.keyboard_sfx)}},preload:function t(){},findBubbleByWordObj:function t(e){return(0,y.default)(this.bubbles,function(t){return t.word_obj==e})},setupBlurFilter:function t(){var e=this.blur={x:this.add.filter("BlurX"),y:this.add.filter("BlurY")};e.x.blur=20;e.y.blur=20},create:function t(){if(this.viewOnlyMode){(0,E.LaunchStudentPlansModal)(null,D.default.next_lesson,"floating_bubbles")}if(B.DEV_MODE){this.time.advancedTiming=true}this.manager=this.game.plugins.add(u.default.ParticleStorm);this.createLayers();if(B.USE_BLUR){this.setupBlurFilter()}this.bg=this.add.tileSprite(-B.BG_EXTEND,-B.BG_EXTEND,this.game.width+B.BG_EXTEND,this.game.height+B.BG_EXTEND,"bg");this.bg.scale.setTo(1,Math.ceil(this.game.height/this.cache.getImage("bg").height));this.bg.fixedToCamera=true;this.mainCloud=this.add.sprite(this.cloudDefaultPosition.x,this.cloudDefaultPosition.y,"main-cloud");this.mainCloud.anchor.setTo(0,.5);this.killObjectCache.push(this.mainCloud);var e=this.fog=this.add.tileSprite(0,this.game.height-this.cache.getImage("fog").height-100,this.game.width,this.cache.getImage("fog").height,"fog");e.alpha=1;e.scale.setTo(3,2);e.anchor.setTo(0);this.ninjaBottom=this.add.sprite(200,-30,"ninja-bottom");this.ninjaBottom.anchor.setTo(0,0);this.ninjaBottom.scale.setTo(1);this.killObjectCache.push(this.ninjaBottom);this.ninjaBody=this.add.sprite(40,-35,"ninja-body");this.killObjectCache.push(this.ninjaBody);this.ninjaBody.animations.add("ninja-body-blow",u.default.Animation.generateFrameNames("body_",1,16,".png",2),30,true);this.ninjaHead=this.add.sprite(50,-25,"ninja-head");this.killObjectCache.push(this.ninjaHead);this.ninjaHead.anchor.setTo(.15,.76);this.ninjaHead.scale.setTo(1);this.ninjaHead.angle=0;var i=this.ninjaHead.animations.add("ninja-head-blow",u.default.Animation.generateFrameNames("head_",1,16,".png",2),30,true);i.onComplete.add(function(){}.bind(this));this.mainCloud.addChild(this.ninjaBottom);this.ninjaBottom.addChild(this.ninjaBody);this.ninjaBottom.addChild(this.ninjaHead);l.default.GameUtil.createStartingText.call(this,N.t("Type words as they float up\nHit SPACE to begin"));if(B.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects.pop=this.game.add.audio("pop");if(B.BUBBLE_FX){}}this.createClouds(false,4);this.createLine();this.createLifeIcons();this.createLifeIconEffect();this.createBubblePopEffect();if(B.BUBBLE_FX){this.createSoftBubblePopEffect()}l.default.GameUtil.createWPMCountObj.call(this,90,this.game.height-130);core.events.on("stats_update",function(t){if(t.wpm>250){return}if(this.wpmText){this.wpmText.text=t.wpm}}.bind(this))},update:function t(){this.fog.tilePosition.x-=.5*this.cloudSpeed;if(!this.gameState.lost){this.drawLine();this.updateNinjaHead();if(this.bubbles.length>0){this.updateBubbles()}}if(this.gameState.started){if((0,b.default)(0,1,true)<this.rateOfDummyBubbles){this.generateDummyBubble()}}if(this.dummyBubbles.length>0){this.updateDummyBubbles()}this.updateClouds()},updateClouds:function t(){for(var e in this.clouds){var i=this.clouds[e];if(i&&i.position){if(i.position.x<-270){i.position.x=this.game.width+250;i=this.randomizeCloud(i)}else{i.position.x-=i._speed*this.cloudSpeedRatio}}}},render:function t(){if(B.DEV_MODE&&!this.gameState.lost){var e="#0f0";var i={x:50,y:50,yInc:20};this.game.debug.text("FPS: "+this.time.fps,i.x,i.y+=i.yInc,e);this.game.debug.text("Clouds: "+this.clouds.length,i.x,i.y+=i.yInc,e);this.game.debug.text("Bub: "+this.bubbles.length,i.x,i.y+=i.yInc,e);this.game.debug.text("DBub: "+this.dummyBubbles.length,i.x,i.y+=i.yInc,e);this.game.debug.text("Sec: "+Math.round(this.game.time.totalElapsedSeconds()*10)/10,i.x,i.y+=i.yInc,e)}},initGameDifficulty:function t(e){var i=e.typing.goal_wpm;if(i<10){B.DIFFICULTY_LEVEL="supereasy"}else if(i<20){B.DIFFICULTY_LEVEL="easy"}else if(i<30){B.DIFFICULTY_LEVEL="normal"}else if(i<40){B.DIFFICULTY_LEVEL="hard"}else if(i<50){B.DIFFICULTY_LEVEL="difficult"}else{B.DIFFICULTY_LEVEL="insane"}},getCurrentDifficulty:function t(){if(this.difficultyParams){return this.difficultyParams}var e=null;switch(B.DIFFICULTY_LEVEL){case"supereasy":e=1;break;case"easy":e=1.5;break;case"normal":default:e=2;break;case"hard":e=3;break;case"difficult":e=4;break;case"insane":e=5;break}this.difficultyParams={floatSpeed:e,goalWpm:this.env.typing.goal_wpm,level:B.DIFFICULTY_LEVEL};return this.difficultyParams},startGame:function t(){l.default.GameUtil.hideStartingText.call(this);this.add.tween(this.mainCloud).to({y:[this.mainCloud.y-100]},2500,u.default.Easing.Quadratic.InOut,true,0).onComplete.add(function(){this.add.tween(this.mainCloud).to({y:[this.mainCloud.y-10,this.mainCloud.y]},3e3,u.default.Easing.Cubic.InOut,true,0,-1)}.bind(this));this.gameState.started=true;(0,x.default)(this.generateBubble.bind(this),100);(0,x.default)(this.generateBubble.bind(this),300)},laneIndex:0,getFreeLane:function t(){var e=[1,4,12,9,2,5,11,8,3,6,10,7];return e[this.laneIndex++%e.length]},getCloudAlias:function t(){return l.default.getRandomOfList(["cloud1","cloud2","cloud3"])},createClouds:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var a=this.game.height/3;var r=this.game.height/6;var s=this.game.width/i;for(var n=0;n<i;n++){var o=this.cloudsLayer.create(e?this.game.width+250:l.default.getRandomInt(1,i+1)*s,a+.25*l.default.getRandomOfList([-4,-3,-2,-1,0,1,2,3,4])*r,this.getCloudAlias());o.anchor.setTo(.5);o=this.randomizeCloud(o);this.clouds.push(o);if(B.USE_BLUR){o.filters=[this.blur.x,this.blur.y]}}},randomizeCloud:function t(e){e.alpha=l.default.getRandomOfList([1,.8,.9]);e.scale.setTo(l.default.getRandomOfList([1.6,1.2,1.4,1.3,1]));e._speed=l.default.getRandomOfList([.1,.08,.12,.1]);return e},createLayers:function t(){this.cloudsLayer=this.game.add.group()},generateBubble:function t(){var e=this.coreWords.activate_and_pull_word();if(!e){return}var i=B.TOTAL_LANES;var a=(this.game.width-this.game.width/2)/i;var r=this.add.sprite(0,0,"little-monster");r.anchor.setTo(.5);r.scale.setTo(.5);if((0,b.default)()){var s=this.add.sprite(0,-40,"monster-glasses");s.anchor.setTo(.5);r.addChild(s)}if((0,b.default)()){var n=this.add.sprite(-2,-55,"monster-hair");n.anchor.setTo(.5);r.addChild(n)}if((0,b.default)()){r.animations.add("little-monster-anim-a",u.default.Animation.generateFrameNames("a/mon-A-00",1,30,".png",2),30,true);r.animations.play("little-monster-anim-a",(0,b.default)(10,15),true,false)}else{r.animations.add("little-monster-anim-b",u.default.Animation.generateFrameNames("b/mon-B-00",31,60,".png",2),30,true);r.animations.play("little-monster-anim-b",(0,b.default)(10,15),true,false)}var o=this.getFreeLane();var h=this.add.tileSprite(Math.round(this.game.width/2+o*a-100),this.game.height+this.cache.getImage("bubble").height,this.cache.getImage("bubble").width,this.cache.getImage("bubble").height,"bubble");this.killObjectCache.push(h);h.anchor.setTo(.5,.5);h._rateOfRise=this.getCurrentDifficulty().floatSpeed*(0,b.default)(.9,1);var d=l.default.getRandomOfList([[4,5,0,-4,-5,0],[-4,-5,0,4,5,0],[8,10,0,-8,-10,0],[-8,-10,0,8,10,0]]);this.add.tween(r).to({angle:d},6e3,u.default.Easing.Linear.None,true,0,true);var c=this.createBubbleText(this.getWordTextFromWordObject(e));h.addChild(r);h.addChild(c);this.bubbles.push({sprite:h,word_obj:e})},createBubbleText:function t(e){var i=this.add.text(0,-70,e,{font:"30px monospace",fill:this.bubbleTextDefaultColor,align:"center"});i.anchor.setTo(.5,.5);i.scale.x=1;i.scale.y=1;return i},getWordTextFromWordObject:function t(e){return e.map(function(t){return t.chr}).join("")},generateDummyBubble:function t(){var e=100;var i=this.game.width/e;var a=this.add.tileSprite(Math.round(l.default.getRandomInt(1,e)*i-100),this.game.height+10,this.cache.getImage("bubble").width,this.cache.getImage("bubble").height,"bubble");a.anchor.setTo(.5,.5);a.scale.setTo((0,b.default)(.2,.5));a.alpha=(0,b.default)(.3,.6);a._rateOfRise=(0,b.default)(.5,1)*2;a._life=(0,b.default)(.3,.9)*this.game.height;this.dummyBubbles.push(a)},popBubble:function t(e){this.createProjectile(e.sprite);(0,T.default)(this.bubbles,function(t){return t===e})},createBubblePopEffect:function t(){var e={lifespan:400,image:"bubble-fragments",blendMode:"NORMAL",frame:["piece01","piece02","piece03","piece04","piece05"],scale:{min:.12,max:.16},vx:{min:-15,max:15},vy:{min:-5,max:15},alpha:{value:.3,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("bubble-pop",e);this.emitter=this.manager.createEmitter(u.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},createSoftBubblePopEffect:function t(){var e={lifespan:400,image:"bubble-fragments",blendMode:"NORMAL",frame:["piece01","piece02","piece03","piece04","piece05"],scale:{min:.05,max:.08},vx:{min:-15,max:15},vy:{min:-5,max:15},alpha:{value:.3,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("soft-bubble-pop",e);this.emitter=this.manager.createEmitter(u.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},runBubblePopEffect:function t(e){this.emitter.emit("bubble-pop",e.position.x,e.position.y,{total:20})},runSoftBubblePopEffect:function t(e){this.emitter.emit("soft-bubble-pop",e.position.x,e.position.y,{total:20})},createProjectile:function t(e){var i=this.getDartPoint();var a=this.add.sprite(i.x,i.y,"stone");this.tempBubbles.push(e);a.anchor.setTo(.5);a.scale.setTo(.5);a.alpha=0;this.ninjaHead.animations.stop("ninja-head-blow");this.ninjaHead.animations.play("ninja-head-blow",60,false);this.ninjaBody.animations.stop("ninja-body-blow");this.ninjaBody.animations.play("ninja-body-blow",60,false);this.currentlySelectedBubble=null;(0,x.default)(function(){a.alpha=1;this.add.tween(a).to({x:[i.x,e.x],y:[i.y,e.y]},100,u.default.Easing.Quadratic.Out,true,0).onComplete.add(function(){a.destroy();this.playSound("pop");this.add.tween(e).to({alpha:.2},150,u.default.Easing.Linear.None,true);this.add.tween(e.scale).to({x:1.5,y:1.5},75,u.default.Easing.Linear.None,true).onComplete.add(function(){this.runBubblePopEffect(e);e.destroy();this.camera.shake(.002,100,true,u.default.Camera.SHAKE_BOTH,true)}.bind(this))}.bind(this))}.bind(this),170)},createLifeIcons:function t(){var e=this.game.height-80;if(w.default.isIOS){e-=50}for(var i=0;i<B.GIVEN_LIVES;i++){var a=this.add.sprite((i+1)*34+20,e,"ninja-life");a.scale.setTo(.8);a.angle=20;a.fixedToCamera=true;this.lifeIcons.push(a);this.killObjectCache.push(a)}},createLifeIconEffect:function t(){var e={lifespan:500,image:"colors",blendMode:"ADD",frame:["blue","green","red","white","yellow"],scale:{min:.2,max:.3},vx:{min:-2,max:2},vy:{min:-2,max:2},alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("basic",e);this.emitter=this.manager.createEmitter(u.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},hideLifeIcons:function t(){for(var e in this.lifeIcons){if(this.lifeIcons[e]){this.lifeIcons[e].kill()}}for(var i in this.lostLifeIcons){if(this.lostLifeIcons[i]){this.lostLifeIcons[i].kill()}}},killBubbleText:function t(e){e.sprite.children[1].destroy()},updateBubbleText:function t(e){var i=e.word_obj;var a=e.sprite.children[1];a.destroy();var r=this.getWordTextFromWordObject(i);var s=this.createBubbleText(r);if(i[0].temp_valid){var n=0;while(n++<i.length){if(!i[n].temp_valid){break}}s.addColor(this.bubbleTextTypedColor,0);s.addColor(this.bubbleTextDefaultColor,n)}e.sprite.addChild(s)},youWin:function t(){this.runPreEndingScreenTasks();l.default.GameUtil.createGameWinningScreen.call(this)},youLose:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.runPreEndingScreenTasks();l.default.GameUtil.createGameLosingScreen.call(this,e)},runPreEndingScreenTasks:function t(){var e=true;var i=false;var a=undefined;try{for(var r=this.fadeObjectCache[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;this.add.tween(n).to({alpha:.5},500,u.default.Easing.Linear.None,true,0,0)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}var o=true;var l=false;var h=undefined;try{for(var d=this.killObjectCache[Symbol.iterator](),c;!(o=(c=d.next()).done);o=true){var f=c.value;f.destroy()}}catch(t){l=true;h=t}finally{try{if(!o&&d.return){d.return()}}finally{if(l){throw h}}}this.bmd.clear()},createLine:function t(){var e=this.game.add.bitmapData(this.game.width,this.game.height);var i="rgba(255, 255, 255, 0.3)";e.ctx.beginPath();e.ctx.lineWidth=2;e.ctx.strokeStyle=i;e.ctx.stroke();this.game.add.sprite(0,0,e);this.bmd=e},updateNinjaHead:function t(){if(this.currentlySelectedBubble){this.ninjaHead.angle=this.calculateNinjaHeadTurnAngle()}},calculateNinjaHeadTurnAngle:function t(){var e=this.currentlySelectedBubble;var i=0;if(e){var a=new u.default.Point(this.mainCloud.x+250,this.mainCloud.y-55);var r=new u.default.Point(e.x,e.y);i=u.default.Point.angle(a,r)*180/Math.PI+180}return i},drawLine:function t(){var e=this.bmd;if(!this.currentlySelectedBubble){e.clear();return}var i=this.currentlySelectedBubble;var a=this.getDartPoint();if(i){e.clear();e.ctx.beginPath();e.ctx.moveTo(a.x,a.y);e.ctx.lineTo(i.x,i.y-10);e.ctx.setLineDash([2,5]);e.ctx.stroke();e.ctx.closePath();e.render()}},getNinjaHeadPoint:function t(){return{x:this.mainCloud.x+250,y:this.mainCloud.y-55}},getDartPoint:function t(){var e=this.getNinjaHeadPoint();var i=this.getDefaultDartPoint();return u.default.Point.rotate(i,e.x,e.y,this.calculateNinjaHeadTurnAngle(),true)},getDefaultDartPoint:function t(){return new u.default.Point(this.mainCloud.x+250+135,this.mainCloud.y-55-12)},updateBubbles:function t(){var e=this;var i=[];var a=this.game.height/2;for(var r=0;r<this.bubbles.length;r++){var s=this.bubbles[r];var n=s.sprite;n.y-=n._rateOfRise;var o=this.cache.getImage("bubble").height;if(n.y<-o/2){i.push(s)}}var l=true;var h=false;var d=undefined;try{var c=function t(){var i=f.value;e.coreWords.word_no_longer_visible(i.word_obj);if(i.sprite==e.currentlySelectedBubble){e.currentlySelectedBubble=null}i.sprite.destroy();(0,T.default)(e.bubbles,function(t){return t===i});e.bubbleOut();e.generateBubble()};for(var u=i[Symbol.iterator](),f;!(l=(f=u.next()).done);l=true){c()}}catch(t){h=true;d=t}finally{try{if(!l&&u.return){u.return()}}finally{if(h){throw d}}}var m=true;var p=false;var g=undefined;try{for(var S=this.tempBubbles[Symbol.iterator](),y;!(m=(y=S.next()).done);m=true){var v=y.value;v.y-=v._rateOfRise}}catch(t){p=true;g=t}finally{try{if(!m&&S.return){S.return()}}finally{if(p){throw g}}}},bubbleOut:function t(){this.takeLife();if(this.lifeIcons.length==0){this.gameState.lost=true;this.core.end_lesson();this.youLose(true)}},takeLife:function t(){this.camera.shake(.001,100,true,u.default.Camera.SHAKE_BOTH,true);this.camera.flash(42990,75);this.playSound("pop");var e=this.lifeIcons.pop();e.tint=0;e.alpha=.3;this.lostLifeIcons.push(e);this.emitter.emit("basic",e.position.x+10,e.position.y+25,{total:20})},updateDummyBubbles:function t(){var e=this;var i=function t(i){var a=e.dummyBubbles[i];a.y-=a._rateOfRise;if(a.y<a._life){if(B.BUBBLE_FX){e.runSoftBubblePopEffect(a)}a.destroy();(0,T.default)(e.dummyBubbles,function(t){return t===a})}};for(var a=0;a<this.dummyBubbles.length;a++){i(a)}},submitScores:function t(e){if(B.DEMO_MODE){return}api.postTypingResults(this.end_stats,function(t){if(e){D.default.goto_url(t)}else{l.default.GameUtil.createGiveUpButton.call(this,t)}}.bind(this))},restartGame:function t(){D.default.refresh()},playSound:function t(e,i){if(B.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects[e].play()}}};function j(t,e){var i={width:B.STANDARD_DIMENSIONS.x,height:B.STANDARD_DIMENSIONS.y};if(B.FULL_SCREEN){i=l.default.getWindowDimensions();(0,m.default)(".game-normal").removeClass("game-normal").addClass("game-fullscreen")}var a=new u.default.Game(i.width,i.height,u.default.CANVAS,"game",null,false,true);a.state.add("Game.BootState",B.BootState);a.state.add("Game.PreloadState",B.PreloadState);a.state.add("Game.FallBackPreloadState",B.FallBackPreloadState);a.state.add("Game.MainState",B.MainState);a.state.start("Game.BootState",true,false,t,e);D.default.events.on("unload",function(){a.load.hasLoaded=true;a.load.reset(true,true);a.state.destroy();a.destroy()})}e.default=l.default.wrapGameWithHeader(j)},996:function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var a=i(299);var r=A(a);var s=i(959);var n=A(s);var o=i(955);var l=A(o);var h=i(300);var d=A(h);var c=i(956);var u=A(c);var f=i(8);var m=A(f);var p=i(31);var g=A(p);var S=i(147);var y=A(S);var v=i(55);var b=A(v);var P=i(946);var x=A(P);var _=i(12);var T=A(_);var C=i(298);var w=i(27);var E=A(w);var O=i(21);var M=A(O);function A(t){return t&&t.__esModule?t:{default:t}}var D=null;var L={STANDARD_DIMENSIONS:{x:1024,y:768},DEV_MODE:false,DEMO_MODE:false,FULL_SCREEN:true,ASSETS:{CDN_CUSTOM:STATIC_URL+"exp/apple_thieves/",NON_CDN_CUSTOM:l.default.getStaticUrl()+"exp/apple_thieves/"},BG_EXTEND:10,SHAKE_CAMERA_FX:true,PLAY_SFX:true,USE_BLUR:false,BUBBLE_FX:true,DISPLAY_SCORE:false,DIFFICULTY_LEVEL:"normal",GIVEN_LIVES:5,failedPreloads:[]};L.BootState=function(){};L.BootState.prototype={init:function t(e){D=(0,E.default)(profile.language);this.env=e;this.scale.scaleMode=u.default.ScaleManager.SHOW_ALL;this.scale.pageAlignHorizontally=true;this.scale.pageAlignVertically=true;L.DEMO_MODE=this.env.demo||false},preload:function t(){this.load.crossOrigin=l.default.getCrossOrigin();this.load.image("preloadBar",l.default.GameUtil.ASSETS.CDN_SHARED+"img/progress.png")},create:function t(){this.game.stage.backgroundColor="#2f86bc";this.state.start("Game.PreloadState",true,false,this.env)}};L.PreloadState=function(){};L.PreloadState.prototype={init:function t(e){l.default.GameUtil.init(this);this.env=e},updateLoader:function t(){this.loadingText.text=D.t("Loading Game ({{ percent }} %)",{percent:this.load.progress})},preload:function t(){this.preloadBar=this.add.sprite(this.game.world.centerX-this.cache.getImage("preloadBar").width/2,this.game.world.centerY,"preloadBar");this.loadingText=this.game.add.text(this.game.world.centerX-170,this.game.world.centerY-60,D.t("Loading Game (0 %)"),{font:"40px Helvetica Neue",fontWeight:100,fill:"#eee",align:"center"});this.load.onFileComplete.add(function(){this.updateLoader()}.bind(this));this.load.onFileError.add(function(t,e){L.failedPreloads.push({key:t,file:e})}.bind(this));this.load.setPreloadSprite(this.preloadBar);l.default.GameUtil.loadSharedAssets.call(this);this.load.image("bg",L.ASSETS.CDN_CUSTOM+"img/sky-gradient.png");this.load.image("bg-mountain",L.ASSETS.CDN_CUSTOM+"img/bg-mountain.png");this.load.image("cloud1",L.ASSETS.CDN_CUSTOM+"img/cloud_01.png");this.load.image("cloud2",L.ASSETS.CDN_CUSTOM+"img/cloud_02.png");this.load.image("cloud3",L.ASSETS.CDN_CUSTOM+"img/cloud_03.png");this.load.image("ground-left",L.ASSETS.CDN_CUSTOM+"img/ground-left.png");this.load.image("apple-buckets",L.ASSETS.CDN_CUSTOM+"img/apple-buckets.png");this.load.image("ground-right",L.ASSETS.CDN_CUSTOM+"img/ground-right.png");this.load.image("ground-gradient",L.ASSETS.CDN_CUSTOM+"img/ground-gradient.png");this.load.image("ground-grass",L.ASSETS.CDN_CUSTOM+"img/ground-grass.png");this.load.image("bush-large",L.ASSETS.CDN_CUSTOM+"img/bush-large.png");this.load.image("bush-small",L.ASSETS.CDN_CUSTOM+"img/bush-small.png");this.load.atlasJSONHash("ninja",L.ASSETS.CDN_CUSTOM+"img/ninja.png",L.ASSETS.NON_CDN_CUSTOM+"img/ninja.json");this.load.atlasJSONHash("monster",L.ASSETS.CDN_CUSTOM+"img/monster.png",L.ASSETS.NON_CDN_CUSTOM+"img/monster.json");this.load.image("monster-back-01",L.ASSETS.CDN_CUSTOM+"img/monster-back-01.png");this.load.image("monster-back-02",L.ASSETS.CDN_CUSTOM+"img/monster-back-02.png");this.load.atlas("apple-fragments",L.ASSETS.CDN_CUSTOM+"img/apple-fragments.png",L.ASSETS.NON_CDN_CUSTOM+"img/apple-fragments.json");this.load.image("ninja-life",L.ASSETS.CDN_CUSTOM+"img/ninja-life-small.png");this.load.image("apple",L.ASSETS.CDN_CUSTOM+"img/apple.png");this.load.atlas("colors",L.ASSETS.CDN_CUSTOM+"img/colorsSD.png",L.ASSETS.NON_CDN_CUSTOM+"img/colorsSD.json");if(L.PLAY_SFX&&profile.keyboard_sfx){this.load.audio("pop",L.ASSETS.CDN_CUSTOM+"audio/pop.mp3")}},create:function t(){if(!(0,g.default)(L.failedPreloads)){this.state.start("Game.FallBackPreloadState",true,false,this.env,L)}else{this.state.start("Game.MainState",true,false,this.env)}}};L.FallBackPreloadState=o.FallBackPreloadState;L.MainState=function(){this.manager=null;this.ninja=null;this.bg=null;this.clouds=[];this.cloudSpeedRatio=1;this.difficultyParams=null;this.fadeObjectCache=[];this.killObjectCache=[];this.lifeIcons=[];this.lostLifeIcons=[];this.monsters=[];this.ejectedMonsters=[];this.currentlySelectedTarget=null;this.targetTextDefaultColor="rgba(65, 65, 65, 1)";this.targetTextTypedColor="rgba(255, 255, 255, 0.3)";this.targetTextActiveColor="rgba(255, 255, 255, 1)";this.eatingSpots=[{x:90,y:15},{x:40,y:20},{x:-10,y:15},{x:-60,y:25}];this.gameState={started:false,lost:false};if(L.DEV_MODE){window.game=this}this.soundEffects={pop:null,softPop:null};this.viewOnlyMode=profile.is_basic&&window.is_tp};L.MainState.prototype={init:function t(e){l.default.GameUtil.init(this);this.env=e;this.initGameDifficulty(e);var i=this.core=new r.default({lesson_id:e.id,text:e.typing.text,on_error:"block",max_secs:e.typing.max_secs,deletable:false,i18n:D});var a=this.coreWords=new n.default(i);i.events.on("end",function(t){t.game_lost=this.gameState.lost;this.end_stats=t;if(!this.gameState.lost){this.youWin()}}.bind(this));a.events.on("change",function(t){var e=true;var i=false;var a=undefined;try{for(var r=t.matches[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;var o=this.findMonsterByWordObj(n);this.updateMonsterText(o)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}if(t.focus){this.currentlySelectedTarget=this.findMonsterByWordObj(t.focus).sprite}var l=true;var h=false;var d=undefined;try{for(var c=t.rejected_words[Symbol.iterator](),u;!(l=(u=c.next()).done);l=true){var f=u.value;var m=this.findMonsterByWordObj(f);this.updateMonsterText(m)}}catch(t){h=true;d=t}finally{try{if(!l&&c.return){c.return()}}finally{if(h){throw d}}}}.bind(this));a.events.on("word_complete",function(t){var e=this.findMonsterByWordObj(t.word);this.killMonsterText(e);if(e){this.killMonster(e);this.createLittleMonster()}}.bind(this));if(!this.viewOnlyMode){this.core.attach_capture()}M.default.events.on("unload",function(){this.core.detach_capture()}.bind(this));this.spacebar=this.game.input.keyboard.addKey(u.default.Keyboard.SPACEBAR);this.spacebar.onDown.add(function(){if(this.gameState.lost){this.restartGame()}else if(!this.gameState.started){this.startGame()}},this);if(L.PLAY_SFX&&profile.keyboard_sfx){this.soundfx=new d.default.SoundFX(this.core,M.default.root,!profile.keyboard_sfx)}},preload:function t(){},create:function t(){if(this.viewOnlyMode){(0,C.LaunchStudentPlansModal)(null,M.default.next_lesson,"apple_thieves")}if(L.DEV_MODE){this.time.advancedTiming=true}var e=this.cache.getImage("ground-gradient").height;var i=this.cache.getImage("apple-buckets").height;var a=this.cache.getImage("bg").height;this.manager=this.game.plugins.add(u.default.ParticleStorm);this.createBackgroundElements();this.createLayers();this.createClouds(false,4);this.createGroundElements();this.createNinja();this.appleBucket=this.appleBucketLayer.create(290,this.game.height-e+110,"apple-buckets");this.killObjectCache.push(this.appleBucket);this.appleBucket.anchor.setTo(.5);this.createLifeIcons();this.createLifeIconEffect();this.createAppleSmashEffect();l.default.GameUtil.createStartingText.call(this,D.t("Type words as they appear\nHit SPACE to begin"));if(L.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects.pop=this.game.add.audio("pop")}l.default.GameUtil.createWPMCountObj.call(this,90,this.game.height-130);core.events.on("stats_update",function(t){if(t.wpm>250){return}if(this.wpmText){this.wpmText.text=t.wpm}}.bind(this));this.drawLine()},update:function t(){var e=true;var i=false;var a=undefined;try{for(var r=this.monsters[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;this.updateMonster(n)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}this.updateClouds()},initGameDifficulty:function t(e){var i=e.typing.goal_wpm;if(i<10){L.DIFFICULTY_LEVEL="supereasy"}else if(i<20){L.DIFFICULTY_LEVEL="easy"}else if(i<30){L.DIFFICULTY_LEVEL="normal"}else if(i<40){L.DIFFICULTY_LEVEL="hard"}else if(i<50){L.DIFFICULTY_LEVEL="difficult"}else{L.DIFFICULTY_LEVEL="insane"}},getCurrentDifficulty:function t(){if(this.difficultyParams){return this.difficultyParams}var e=null;switch(L.DIFFICULTY_LEVEL){case"supereasy":e=7e3;break;case"easy":e=6e3;break;case"normal":default:e=5e3;break;case"hard":e=4e3;break;case"difficult":e=3e3;break;case"insane":e=3e3;break}this.difficultyParams={walkSpeed:e,goalWpm:this.env.typing.goal_wpm,level:L.DIFFICULTY_LEVEL};return this.difficultyParams},updateMonster:function t(e){if(!this.gameState.lost&&e.canKill&&this.getDistance(e.sprite)<=100){e.canKill=false;this.ejectMonster(e);this.takeLife();if(this.lifeIcons.length==0){this.gameState.lost=true;this.core.end_lesson();this.youLose(true)}else{this.createLittleMonster();this.game.tweens.remove(e.sprite._tweens.travelPathTween);this.removeMonsterText(e);var i=this.pickEatingSpot();this.add.tween(e.sprite).to({x:this.appleBucket.position.x+i.x,y:this.appleBucket.position.y+i.y},2e3,u.default.Easing.Linear.None,true,0,0).onComplete.add(function(t){t.animations.stop("monster-walk");this.replaceEjectedMonster(t)}.bind(this))}}},pickEatingSpot:function t(){return!(0,g.default)(this.eatingSpots)?this.eatingSpots.pop():{x:0,y:0}},ejectMonster:function t(e){this.coreWords.word_no_longer_visible(e.word_obj);(0,y.default)(this.monsters,function(t){return t===e});this.ejectedMonsters.push(e)},replaceEjectedMonster:function t(e){var i=this.add.sprite(e.position.x,e.position.y+40,l.default.getRandomOfList(["monster-back-01","monster-back-02"]));this.killObjectCache.push(i);i.anchor.setTo(.5,1);i.scale.setTo(.75);this.add.tween(i.scale).to({x:[.75,.8,.75,.78,.75],y:[.75,.7,.75,.72,.75]},700,u.default.Easing.Linear.None,true,0,-1);e.destroy()},render:function t(){if(L.DEV_MODE&&!this.gameState.lost){var e="#0f0";var i={x:50,y:50,yInc:20};this.game.debug.text("FPS: "+this.time.fps,i.x,i.y+=i.yInc,e);this.game.debug.text("Sec: "+Math.round(this.game.time.totalElapsedSeconds()*10)/10,i.x,i.y+=i.yInc,e);this.game.debug.text("Monster: "+this.monsters.length,i.x,i.y+=i.yInc,e)}},findMonsterByWordObj:function t(e){return(0,b.default)(this.monsters,function(t){return t.word_obj==e})},updateMonsterText:function t(e){var i=e.word_obj;var a=e.sprite.children[0];a.destroy();var r=this.getWordTextFromWordObject(i);var s=this.createMonsterText(r);if(i[0].temp_valid){var n=0;while(n++<i.length){if(!i[n].temp_valid){break}}s.addColor(this.targetTextTypedColor,0);s.addColor(this.targetTextActiveColor,n)}e.sprite.addChild(s)},removeMonsterText:function t(e){var i=e.sprite.children[0];i.destroy()},findBubbleByWordObj:function t(e){return(0,b.default)(this.bubbles,function(t){return t.word_obj==e})},killMonsterText:function t(e){e.sprite.children[0].destroy()},killMonster:function t(e){this.createProjectile(e.sprite);(0,y.default)(this.monsters,function(t){return t===e})},createProjectile:function t(e){var e=e;this.ninja.animations.stop("ninja-throw");this.ninja.animations.play("ninja-throw",100,false);this.currentlySelectedTarget=null;(0,x.default)(function(){var t=new u.default.Point(300,this.game.height-400);var i=this.add.sprite(t.x,t.y,"apple");this.killObjectCache.push(i);i.anchor.setTo(.5);i.scale.setTo(1);var a={x:(e.x+t.x)/2,y:(e.y+t.y)/2-100};this.add.tween(i).to({x:[t.x,a.x,e.x],y:[t.y,a.y,e.y]},200*this.getDistanceCoefficient(e),u.default.Easing.Linear.None,true).interpolation(function(t,e){return u.default.Math.bezierInterpolation(t,e)}).onComplete.add(function(){i.destroy();this.playSound("pop");this.runAppleSmashEffect(e);this.game.tweens.remove(e._tweens.travelPathTween);e.animations.stop("monster-walk");e.position.x+=150;e.animations.play("monster-hit",45,false);this.camera.shake(.002,100,true,u.default.Camera.SHAKE_BOTH,true)}.bind(this))}.bind(this),150)},getDistance:function t(e){return Math.abs(e.position.x-this.ninja.position.x)},getDistanceCoefficient:function t(e){return this.getDistance(e)/800},createAppleSmashEffect:function t(){var e={lifespan:400,image:"apple-fragments",blendMode:"NORMAL",frame:["piece01","piece02","piece03","piece04","piece05"],scale:{min:.5,max:.6},vx:{min:-10,max:10},vy:{min:-10,max:10},alpha:{value:.7,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("apple-smash",e);this.emitter=this.manager.createEmitter(u.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},runAppleSmashEffect:function t(e){this.emitter.emit("apple-smash",e.position.x,e.position.y,{total:20})},updateClouds:function t(){var e=this.game.width+270;for(var i in this.clouds){var a=this.clouds[i];if(a&&a.position){if(a.position.x>e){a.position.x=-270;a=this.randomizeCloud(a)}else{a.position.x+=a._speed*this.cloudSpeedRatio}}}},startGame:function t(){l.default.GameUtil.hideStartingText.call(this);this.gameState.started=true;(0,x.default)(this.createLittleMonster.bind(this),100);(0,x.default)(this.createLittleMonster.bind(this),500)},createLayers:function t(){this.cloudsLayer=this.game.add.group();this.groundLayer=this.game.add.group();this.ninjaLayer=this.game.add.group();this.appleBucketLayer=this.game.add.group();this.littleMonsterLayer=this.game.add.group();this.foreGroundLayer=this.game.add.group()},createBackgroundElements:function t(){var e=this.cache.getImage("ground-gradient").height;var i=this.cache.getImage("bg").height;var a=this.cache.getImage("bg-mountain").height;var r=(this.game.height-e)/i;this.bg=this.add.tileSprite(0,0,this.game.width,this.game.height,"bg");this.bg.scale.setTo(1,Math.max(r,.5));this.bg.fixedToCamera=true;this.add.tileSprite(300,this.game.height-a-e,this.game.width,a,"bg-mountain")},createClouds:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var a=this.cache.getImage("ground-gradient").height;var r=this.cache.getImage("bg-mountain").height;var s=this.game.height-r-a;var n=s/2;var o=s/6;var h=this.game.width/i;for(var d=0;d<i;d++){var c=this.cloudsLayer.create(e?-250:l.default.getRandomInt(1,i+1)*h,n+.25*l.default.getRandomOfList([-4,-3,-2,-1,0,1,2,3,4])*o,this.getCloudAlias());c.anchor.setTo(.5);c=this.randomizeCloud(c);this.clouds.push(c)}},randomizeCloud:function t(e){e.alpha=l.default.getRandomOfList([1,.8,.9]);e.scale.setTo(l.default.getRandomOfList([1.1,1.2]));e._speed=l.default.getRandomOfList([.1,.08,.12,.1]);return e},getCloudAlias:function t(){return l.default.getRandomOfList(["cloud1","cloud2","cloud3"])},createGroundElements:function t(){var e=this.cache.getImage("ground-gradient").height;var i=this.cache.getImage("ground-left").height;var a=this.cache.getImage("ground-right").height;var r=this.cache.getImage("ground-right").width;var s=this.add.tileSprite(0,this.game.height-e,this.game.width,e,"ground-gradient");this.groundLayer.add(s);this.groundLayer.create(-40,this.game.height-e-i+130,"ground-left");this.groundLayer.create(this.game.width-r,this.game.height-e-a+110,"ground-right");this.groundLayer.create(0,this.game.height-150,"ground-grass");this.foreGroundLayer.create(this.game.width-this.cache.getImage("bush-large").width+130,this.game.height-this.cache.getImage("bush-large").height,"bush-large");this.groundLayer.create(30,this.game.height-230,"bush-small")},createNinja:function t(){this.ninja=this.ninjaLayer.create(330,this.game.height-355,"ninja");this.killObjectCache.push(this.ninja);this.ninja.anchor.setTo(.5);this.ninja.scale.setTo(1.2);this.ninja.alpha=1;var e=this.ninja.animations.add("ninja-throw",u.default.Animation.generateFrameNames("",1,33,".png",2),30,true)},walkIndex:0,getWalkPathMidPoint:function t(){var e=[-150,100,0,-100,150];return e[this.walkIndex++%e.length]},createLittleMonster:function t(){if(this.gameState.lost){return}var e=this.coreWords.activate_and_pull_word();if(!e){return}var i=this.game.height-200;var a=this.littleMonsterLayer.create(this.game.width+100,i,"monster");a._tweens={};a.anchor.setTo(.5);var r=a.animations.add("monster-walk",u.default.Animation.generateFrameNames("walk/",1,33,".png",2),30,true);var s={x:(a.x+this.appleBucket.position.x)/2,y:(a.y+this.appleBucket.position.y)/2+this.getWalkPathMidPoint()};a._tweens.travelPathTween=this.add.tween(a).to({x:[s.x,this.appleBucket.position.x+50],y:[s.y,this.appleBucket.position.y+100]},this.getCurrentDifficulty().walkSpeed,u.default.Easing.Linear.None,true).interpolation(function(t,e){return u.default.Math.bezierInterpolation(t,e)});this.killObjectCache.push(a);var n=a.animations.add("monster-hit",u.default.Animation.generateFrameNames("hit/",3,29,".png",2),30,true);n.onComplete.add(function(t){t.kill()}.bind(this));var o=this.createMonsterText(this.getWordTextFromWordObject(e));a.addChild(o);this.monsters.push({canKill:true,sprite:a,word_obj:e});a.animations.play("monster-walk",30,true)},createMonsterText:function t(e){var i=this.add.text(0,-55,e,{font:"25px monospace",fill:this.targetTextDefaultColor,align:"center"});i.anchor.setTo(.5,.5);i.scale.x=1;i.scale.y=1;return i},getWordTextFromWordObject:function t(e){return e.map(function(t){return t.chr}).join("")},createLifeIcons:function t(){var e=this.game.height-80;if(T.default.isIOS){e-=50}for(var i=0;i<L.GIVEN_LIVES;i++){var a=this.add.sprite((i+1)*34+20,e,"ninja-life");a.scale.setTo(.8);a.angle=20;a.fixedToCamera=true;this.lifeIcons.push(a);this.killObjectCache.push(a)}},createLifeIconEffect:function t(){var e={lifespan:500,image:"colors",blendMode:"ADD",frame:["blue","green","red","white","yellow"],scale:{min:.2,max:.3},vx:{min:-2,max:2},vy:{min:-2,max:2},alpha:{value:1,control:[{x:0,y:1},{x:.5,y:.9},{x:1,y:0}]}};this.manager.addData("basic",e);this.emitter=this.manager.createEmitter(u.default.ParticleStorm.SPRITE_BATCH);this.emitter.addToWorld()},hideLifeIcons:function t(){for(var e in this.lifeIcons){if(this.lifeIcons[e]){this.lifeIcons[e].kill()}}for(var i in this.lostLifeIcons){if(this.lostLifeIcons[i]){this.lostLifeIcons[i].kill()}}},takeLife:function t(){this.camera.shake(.001,100,true,u.default.Camera.SHAKE_BOTH,true);this.playSound("pop");var e=this.lifeIcons.pop();e.tint=0;e.alpha=.3;this.lostLifeIcons.push(e);this.emitter.emit("basic",e.position.x+10,e.position.y+25,{total:20})},youWin:function t(){this.runPreEndingScreenTasks();l.default.GameUtil.createGameWinningScreen.call(this)},youLose:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.runPreEndingScreenTasks();l.default.GameUtil.createGameLosingScreen.call(this,e)},runPreEndingScreenTasks:function t(){var e=true;var i=false;var a=undefined;try{for(var r=this.fadeObjectCache[Symbol.iterator](),s;!(e=(s=r.next()).done);e=true){var n=s.value;this.add.tween(n).to({alpha:.5},500,u.default.Easing.Linear.None,true,0,0)}}catch(t){i=true;a=t}finally{try{if(!e&&r.return){r.return()}}finally{if(i){throw a}}}var o=true;var l=false;var h=undefined;try{for(var d=this.killObjectCache[Symbol.iterator](),c;!(o=(c=d.next()).done);o=true){var f=c.value;f.destroy()}}catch(t){l=true;h=t}finally{try{if(!o&&d.return){d.return()}}finally{if(l){throw h}}}},getNinjaHeadPoint:function t(){return{x:this.ninjaHeadOffset.x,y:this.ninjaHeadOffset.y}},submitScores:function t(e){if(L.DEMO_MODE){return}api.postTypingResults(this.end_stats,function(t){if(e){M.default.goto_url(t)}else{l.default.GameUtil.createGiveUpButton.call(this,t)}}.bind(this))},restartGame:function t(){M.default.refresh()},playSound:function t(e,i){if(L.PLAY_SFX&&profile.keyboard_sfx){this.soundEffects[e].play()}},drawLine:function t(){var e=this.game.add.bitmapData(this.game.width,this.game.height);var i="rgba(255, 255, 255, 0.3)";e.ctx.beginPath();e.ctx.lineWidth=2;e.ctx.strokeStyle=i;e.ctx.stroke();this.game.add.sprite(0,0,e);e.clear();e.ctx.beginPath();e.ctx.moveTo(430,this.game.height);e.ctx.lineTo(430,this.game.height-230);e.ctx.setLineDash([5,5]);e.ctx.stroke();e.ctx.closePath();e.render()}};function N(t){var e={width:L.STANDARD_DIMENSIONS.x,height:L.STANDARD_DIMENSIONS.y};if(L.FULL_SCREEN){e=l.default.getWindowDimensions();(0,m.default)(".game-normal").removeClass("game-normal").addClass("game-fullscreen")}var i=new u.default.Game(e.width,e.height,u.default.CANVAS,"game",null,false,true);i.state.add("Game.BootState",L.BootState);i.state.add("Game.PreloadState",L.PreloadState);i.state.add("Game.FallBackPreloadState",L.FallBackPreloadState);i.state.add("Game.MainState",L.MainState);i.state.start("Game.BootState",true,false,t);M.default.events.on("unload",function(){i.load.hasLoaded=true;i.load.reset(true,true);i.state.destroy();i.destroy()})}e.default=l.default.wrapGameWithHeader(N)}}]);
//# sourceMappingURL=games.b1a2a76b73.min.js.map